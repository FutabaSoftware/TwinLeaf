---
title: iCAD SX標準部品登録方法
date: 2025-08-28 14:51
---

# iCAD SX標準部品登録方法

### user  

C:\ICADSX\PDS\sys\PARTS_SPEC\USR1を社内フォルダとして使いたい

### assistant  

いい感じに置換までは動いてます！  
コンソールに出ている日本語の「文字化け」は **PowerShell の表示エンコード**が原因なので心配いりません（ファイル自体はSJISで保存できています）。後で直し方も書きます。

ただし、**インデックス `チーズ.csv` の SS_RN → SS_LN / DS_RN → DS_LN 置換 or 追記**が入っていない様子なので、そこを“確実に”整える修正スクリプトを出します。

---

## ① インデックスを安全に更新（既存→変更／無ければ追記）

下をそのままコピペで実行してください。  
（SJISで読み書き、ヘッダ行を自動検出して**列名位置に合わせて**編集します）

```powershell
# === USR1\チーズ\チーズ.csv を安全更新：SS_RN→SS_LN / DS_RN→DS_LN、LowNeck化＆必要なら追記 ===
$enc = [Text.Encoding]::GetEncoding(932)
$idx = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv'

if(!(Test-Path $idx)){ throw "インデックスが見つかりません：$idx" }

# 1) 全行読み込み（SJIS）
$lines = [IO.File]::ReadAllLines($idx, $enc)

# 2) ヘッダ行を検出（10行目以降でカンマ3個以上の行を最初に採用）
$hdrLine = -1
for($i=9; $i -lt $lines.Count; $i++){
  if((($lines[$i] -split ',').Count) -ge 3){ $hdrLine = $i; break }
}
if($hdrLine -lt 0){ throw "ヘッダ行が見つかりません。" }

# 3) 列位置を決定（規格番号 / 部品名称 / 材質 / CSVファイル名）
$hdr = $lines[$hdrLine].Split(',')
function Find-Col($names){
  foreach($n in $names){
    $pos = [Array]::IndexOf($hdr,$n)
    if($pos -ge 0){ return $pos }
  }
  return -1
}
$colCode = Find-Col @('規格番号','規格No','Code')
$colName = Find-Col @('部品名称','部品名','名称')
$colMat  = Find-Col @('材質','Material')
$colCsv  = Find-Col @('CSVファイル名','仕様ファイル名','寸法表CSV','CSV','ファイル名')

if(($colCode,$colName,$colCsv) -contains -1){
  throw "必要列（規格番号/部品名称/CSVファイル名）の位置が特定できません。ヘッダ：$($hdr -join ',')"
}

# 4) データ部をオブジェクト化
$rows = @()
for($i=$hdrLine+1; $i -lt $lines.Count; $i++){
  if([string]::IsNullOrWhiteSpace($lines[$i])){ continue }
  $cells = $lines[$i].Split(',')
  # 末尾の空列も保持
  if($cells.Count -lt $hdr.Count){ $cells = $cells + (',' * ($hdr.Count - $cells.Count)) }
  $rows += ,@($cells)
}

# 5) 変換ルール
function SetOrAdd([string]$code, [string]$name, [string]$mat, [string]$csvName){
  $found = $false
  foreach($r in $rows){
    if($r[$colCode] -replace '"','' -eq $code){
      $r[$colName] = '"' + $name + '"'
      if($colMat -ge 0){ $r[$colMat] = '"' + $mat + '"' }
      $r[$colCsv]  = '"' + $csvName + '"'
      $found = $true
      break
    }
  }
  if(-not $found){
    $new = New-Object string[] ($hdr.Count)
    for($k=0;$k -lt $hdr.Count;$k++){ $new[$k] = '' }
    $new[$colCode] = '"' + $code + '"'
    $new[$colName] = '"' + $name + '"'
    if($colMat -ge 0){ $new[$colMat] = '"' + $mat + '"' }
    $new[$colCsv]  = '"' + $csvName + '"'
    $rows += ,$new
  }
}

# 5-1) 旧コードがあれば置換（SS_RN→SS_LN、DS_RN→DS_LN、名称/CSV内のローネック→LowNeck）
foreach($r in $rows){
  $r[$colName] = $r[$colName] -replace 'ローネック','LowNeck'
  $r[$colCsv]  = $r[$colCsv]  -replace 'ローネック','LowNeck'
  if($r[$colCode] -match 'SS_RN'){ $r[$colCode] = '"SS_LN"' }
  if($r[$colCode] -match 'DS_RN'){ $r[$colCode] = '"DS_LN"' }
}

# 5-2) SS / SS_LN / DS_LN を“必ず”持つように整える（無ければ追加）
SetOrAdd 'SS'    '一方ショートチーズ'           'SUS304' 'チーズ_一方ショートチーズ.csv'
SetOrAdd 'SS_LN' '一方SLowNeckチーズ'           'SUS304' 'チーズ_一方ショート×LowNeckチーズ.csv'
SetOrAdd 'DS_LN' '両方SLowNeckチーズ'           'SUS304' 'チーズ_両方ショート×LowNeckチーズ.csv'

# 6) 保存（元ファイルをバックアップしてから SJIS+CRLF で書き出し）
$bak = "$idx.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
Copy-Item $idx $bak -Force
$nl = "`r`n"
$out = New-Object System.Collections.Generic.List[string]
# 予約行＋ヘッダを復元
for($i=0;$i -le $hdrLine;$i++){ $out.Add($lines[$i]) }
# データ部を書き直し
foreach($r in $rows){ $out.Add(($r -join ',')) }
[IO.File]::WriteAllText($idx, ($out -join $nl) + $nl, $enc)

"更新OK → $idx`nバックアップ → $bak"
```

> これで **SS / SS_LN / DS_LN** の3レコードが必ず備わり、**名称/CSVファイル名の LowNeck 化**も揃います。

---

## ② 文字化けして見えるのは「表示」の問題（中身はOK）

日本語が `Select-String` で崩れて見えるのは、**コンソールの出力コードページ**が SJIS と合ってないためです。  
表示だけ直すなら、どちらか一つを実行：

**A. SJIS（CP932）で表示**
```powershell
$OutputEncoding = [Console]::OutputEncoding = [Text.Encoding]::GetEncoding(932)
```

**B. UTF-8に揃えて出力（表示用）**
```powershell
chcp 65001 > $null
$OutputEncoding = [Console]::OutputEncoding = [Text.Encoding]::UTF8
```

---

## ③ 最終チェック（ASCIIだけ拾うので化けません）
```powershell
# LowNeck 表記の存在（ASCIIなので化けない）
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\*.csv' -Pattern 'LowNeck' | Select-Object -First 10

# SS_LN / DS_LN の存在
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Pattern 'SS_LN','DS_LN'
```

---

必要なら、**CSVの1〜15行だけ抜き出してこのチャットに貼る**ためのコマンドも用意できます。  
うまく整ったら iCAD を再起動して、**規格参照 → USR1 → チーズ**から呼び出しテストへ行きましょう。

### user  

：「TOSTE のチーズ.csv を流用して USR1にコピーが最良？

### assistant  

いい流れ 👍  
ここから「実際に USR1 に登録できる部品データ」を作るステップを整理するね。  

---

## 部品データ生成の流れ（絶対ルール準拠）

1. **対象フォルダを決める**
   - 今回は `C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\`
   - ここに **寸法表CSV**（3種類）と **インデックスCSV** を置く

2. **寸法表CSVを作る**
   - 各5行入り（例：一方ショート、片側ローネック、両側ローネック）
   - 構造はマニュアル準拠：  
     ```
     1〜5行：システム予約
     6〜9行：ユーザ行
     10行目：呼び径Ａ,呼び径Ｂ,利用者部品のモデル名
     11行目以降：5行のデータ
     ```
   - モデル名列には「一方ショートチーズ_1S-1S」など、実際の部品呼び出し名を書く

3. **インデックスCSVを作る**
   - `USR1\チーズ\チーズ.csv`  
   - 規格番号（14文字以内）、材質、寸法表CSV名を紐づける
   - これで iCAD の「規格参照」から呼べるようになる

4. **配置テスト**
   - iCAD 再起動 → 部品配置 → 規格参照 → USR1 を選択 → 部品呼び出しができるか確認

---

## あなたにお願いしたい情報（元データ）
スムーズに作るために、次のどれを流用するか決めたい：

- ✅ **既存の TOSTE\チーズ系 CSV**（さっき manifest に入っていたやつ）をベースにしたい？  
  例：`チーズ_T-8.csv` の構造をコピーして USR1 用に編集  
- ✅ それとも **あなたが持っている Excel データ（部品表）** をそのまま流用したい？  

→ どちらをベースにするかによって、こちらで「そのまま変換するスクリプト」を用意できる。  

---

👉 まずはどっちで進めたい？  
（例：「TOSTE のチーズ.csv を流用して USR1 にコピー」 or 「自分のExcel表をベースに新規生成」）

### user  

できるだけ元のCSVに則ったデータが欲しい

### user  

ICAD SXのフォルダ構造をchatgptに教えたいんだけどどうしたら効率的にフォルダ階層抽出して教えれる？

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # 置換後の3コードが入っているか
PS C:\Users\h.futada> Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Pattern 'SS_LN','DS_LN','SS'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # LowNeck が各CSVに入っているか
PS C:\Users\h.futada> Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\*.csv' -Pattern 'LowNeck' | Select-Object -First 10

C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv:1:1,�`�[�Y,�n�ڗp�`�[�Y(LowNeck)_1.0S,TOSTE,USER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:1:1,�`�[�Y,����V���[�g�~LowNeck�`�[�Y,U
SER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:11:"1S","1.5S","����V���[�g�~LowNeck�`�
[�Y_1S-1.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:12:"1.5S","2S","����V���[�g�~LowNeck�`�
[�Y_1.5S-2S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:13:"2S","2.5S","����V���[�g�~LowNeck�`�
[�Y_2S-2.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:14:"2.5S","3S","����V���[�g�~LowNeck�`�
[�Y_2.5S-3S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:15:"3S","3S","����V���[�g�~LowNeck�`�[�
Y_3S-3S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:1:1,�`�[�Y,�����V���[�g�~LowNeck�`�[�Y,
USER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:11:"1S","1.5S","�����V���[�g�~LowNeck�`
�[�Y_1S-1.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:12:"1.5S","2S","�����V���[�g�~LowNeck�`
�[�Y_1.5S-2S"


PS C:\Users\h.futada>

### assistant  

なるほど 👍  
では最終ルールをこうします：  

- **部品名称（日本語表示用）** → 「ローネック」  
- **規格番号（略称コード）** → `SS_LN` / `DS_LN`（LNで統一）  

---

## PowerShell 修正版
以下を実行してください。  
これで「名称はローネック」「略称コードは LN」で揃えます。

```powershell
# === USR1\チーズ：部品名称→ローネック / 規格番号→LN に統一 ===
$enc = [Text.Encoding]::GetEncoding(932)
$dir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$idx = Join-Path $dir 'チーズ.csv'

# 1) 寸法表ファイル名を LowNeck → ローネック に戻す
$renames = @(
  @{ Old='チーズ_一方ショート×LowNeckチーズ.csv'; New='チーズ_一方ショート×ローネックチーズ.csv' },
  @{ Old='チーズ_両方ショート×LowNeckチーズ.csv'; New='チーズ_両方ショート×ローネックチーズ.csv' }
)
foreach($r in $renames){
  $oldP = Join-Path $dir $r.Old
  $newP = Join-Path $dir $r.New
  if(Test-Path $oldP){
    if(Test-Path $newP){ Remove-Item $newP -Force }
    Rename-Item $oldP $r.New -Force
    Write-Host "リネーム: $($r.Old) → $($r.New)"
  }
}

# 2) 寸法表CSV内の表記置換（LowNeck → ローネック）
$specFiles = Get-ChildItem $dir -Filter 'チーズ_*.csv' | Where-Object { $_.Name -match 'ローネック|LowNeck' }
foreach($f in $specFiles){
  $bak = "$($f.FullName).bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
  Copy-Item $f.FullName $bak
  $lines = [IO.File]::ReadAllLines($f.FullName,$enc) -replace 'LowNeck','ローネック'
  [IO.File]::WriteAllLines($f.FullName,$lines,$enc)
  Write-Host "寸法表修正: $($f.Name)"
}

# 3) インデックスCSV修正
if(Test-Path $idx){
  $bak = "$idx.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
  Copy-Item $idx $bak
  $lines = [IO.File]::ReadAllLines($idx,$enc)

  for($i=0;$i -lt $lines.Count;$i++){
    # 部品名称はローネック
    $lines[$i] = $lines[$i] -replace 'LowNeck','ローネック'
    # 規格番号は LN に統一
    $lines[$i] = $lines[$i] -replace 'SS_RN','SS_LN'
    $lines[$i] = $lines[$i] -replace 'DS_RN','DS_LN'
  }

  [IO.File]::WriteAllLines($idx,$lines,$enc)
  Write-Host "インデックス修正完了: $idx"
}
```

---

## 実行後の確認
- `チーズ.csv` に  
  - 部品名称 = 「一方ショート×ローネックチーズ」  
  - 規格番号 = `SS` / `SS_LN` / `DS_LN`  
- 寸法表 CSV も全部「ローネック」表記に戻っている  

---

👉 これで「名称はローネック」「略称コードは LN」に揃います。  
すぐ実行しますか？

### assistant  

なるほど 👍  
「英語の省略形だと直感的にわかりづらい」ということね。  
iCAD の **14文字制限** を守りつつ、**日本語ベースで誰が見ても継手形状が想像できる名称** に整理してみる。  

---

## 命名ルール（日本語＋短縮）
- 「チーズ」は必ず残す（形状が直感的に分かるように）  
- 一方ショート → `片Sチーズ`  
- 両方ショート → `両Sチーズ`  
- ローネック → `RN`（最短で分かる略号）  
- ローアーム → `RA`  

---

## 提案する部品名称（14文字以内）

| 元の名称                      | 推奨名称（14文字以内） | 文字数 |
|-------------------------------|------------------------|--------|
| 一方ショートチーズ             | 片Sチーズ              | 6      |
| 一方ショート×ローネックチーズ | 片S RNチーズ           | 9      |
| 両方ショート×ローネックチーズ | 両S RNチーズ           | 9      |
| ローアームチーズ（もし追加）   | RAチーズ               | 6      |

👉 「片S」「両S」は日本人設計者ならすぐイメージできるし、  
👉 「RN」「RA」は略号ながら業界で定着していて14文字以内に収まる。  

---

## PowerShell生成版（日本語名バージョン）

```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
片Sチーズ,USR010,SUS304,15A,1S,38,0
片Sチーズ,USR010,SUS304,2S,2S,55,0
片Sチーズ,USR010,SUS304,2.5S,2.5S,62,0
片Sチーズ,USR010,SUS304,3S,3S,68,0
片S RNチーズ,USR011,SUS304,1S,1.5S,38,35
片S RNチーズ,USR011,SUS304,1.5S,2S,48,45
片S RNチーズ,USR011,SUS304,2S,2.5S,55,50
片S RNチーズ,USR011,SUS304,2.5S,3S,62,57
片S RNチーズ,USR011,SUS304,3S,3S,68,63
両S RNチーズ,USR012,SUS304,1S,1.5S,35,38
両S RNチーズ,USR012,SUS304,1.5S,2S,45,48
両S RNチーズ,USR012,SUS304,2S,2.5S,50,55
両S RNチーズ,USR012,SUS304,2.5S,3S,57,62
両S RNチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "$env:USERPROFILE\Downloads\チーズ標準部品ひな形.csv"
```

---

👉 この命名なら **日本語で分かりやすく、14文字制限もクリア** できる。  

質問：この「片S」「両S」の略で社内でも統一して大丈夫？  
（もし「片ショート」「両ショート」としたいなら文字数調整もできるよ）

### assistant  

あ、なるほど！😅  
そのエラーは **先頭が「| Export-Csv …」だけになってて、前段のコマンドが抜けてる**のが原因です。  
パイプ（`|`）の前には必ず `Get-ChildItem …` などが必要です。

---

## 正しい一式（コピペ用）
```powershell
$root = 'C:\iCADSX\PDS\SYS\PARTS_SPEC'

Get-ChildItem $root -Recurse -Force |
  Where-Object { $_.PSIsContainer -or $_.Extension -match '\.csv$' } |
  Select-Object @{N='Type';E={if ($_.PSIsContainer){'Dir'}else{'File'}}},
                @{N='RelativePath';E={$_.FullName.Substring($root.Length+1)}},
                @{N='Depth';E={($_.FullName -split '\\').Count - ($root -split '\\').Count}},
                @{N='SizeKB';E={ if ($_.PSIsContainer){$null}else{ [math]::Round($_.Length/1KB,1) } }},
                LastWriteTime |
  Export-Csv "$env:USERPROFILE\Downloads\icad_manifest.csv" -NoTypeInformation -Encoding UTF8
```

---

## 実行後にできるもの
- `Downloads\icad_manifest.csv`  
- 中身は  
  ```
  Type,RelativePath,Depth,SizeKB,LastWriteTime
  Dir,自社規格,1,,2025/08/28 12:34:56
  File,自社規格\チーズ\チーズ.csv,3,12.5,2025/08/20 10:15:00
  …
  ```
  みたいな一覧になる。

---

👉 この CSV をアップしてくれれば、僕が **正しい場所とファイル** を特定して、編集すべきインデックスや寸法表CSVを案内できるよ。  
やってみる？

### user  

実際に部品データを生成していきたい。どうすればいい？また流用に必要な元のエクセルデータとか必要であれば渡すから言って。

### assistant  

そう 👍  
Windows の **PowerShell** で実行するのが一番効率的だよ。  

理由は：  
- iCAD SX のライブラリはかなり階層が深いから、エクスプローラで手作業コピーは非効率  
- PowerShell なら **階層を一括でテキスト/CSV/JSON** に出せる  
- そのまま出力したファイルをこのチャットにアップしてくれれば、僕がフォルダ構造を読み取って「どのCSVに手を入れるか」を正確に案内できる  

---

## 実行手順（例：CSVマニフェスト）
1. PowerShell を開く  
2. 次のコードをコピペして Enter  
   ```powershell
   $root = 'C:\iCADSX\PDS\SYS\PARTS_SPEC'
   Get-ChildItem $root -Recurse -Force |
     Where-Object { $_.PSIsContainer -or $_.Extension -match '\.csv$' } |
     Select-Object @{N='Type';E={if ($_.PSIsContainer){'Dir'}else{'File'}}},
                   @{N='RelativePath';E={$_.FullName.Substring($root.Length+1)}},
                   @{N='Depth';E={($_.FullName -split '\\').Count - ($root -split '\\').Count}},
                   @{N='SizeKB';E={ if ($_.PSIsContainer){$null}else{ [math]::Round($_.Length/1KB,1) } }},
                   LastWriteTime
   | Export-Csv "$env:USERPROFILE\Downloads\icad_manifest.csv" -NoTypeInformation -Encoding UTF8
   ```
3. `ダウンロード` フォルダに **icad_manifest.csv** ができる  
4. それをこのチャットにアップロードしてくれればOK  

---

👉 まずはこの CSV 抽出で全体像を共有してみる？

### user  

こっちのマニュアルかも

### user  

PowerShellワンライナーで一発保存

### user  

元々の名前に極力近い名称で

### assistant  

iCAD SX (V8L4) で標準部品を登録する方法をまとめるね。  
「標準部品」として登録すると、ライブラリから呼び出せるようになるので再利用が楽になる。

---

## 標準部品の登録手順

1. **部品を作成**
   - 3Dモデル、または2Dシンボルを通常通り作成する。  
   - 位置・属性（部品名、部品番号、材料など）をきちんと入力しておく。

2. **基準点の設定**
   - 挿入時の基準点を決める必要がある。  
   - 「基準点設定」コマンドで部品の原点や取付位置となる点を指定しておく。

3. **標準部品登録コマンド**
   - [ツール] → [標準部品] → [標準部品登録] を選択。  
   - 登録する部品を選択し、名前を入力する。  
   - 分類フォルダ（例：バルブ／継手／器具 など）を指定して整理しておく。

4. **属性の設定**
   - 部品属性（部品名、型番、規格、サイズなど）を入力。  
   - 登録時にExcel連携用の項目やBOM出力用のキーも設定可能。

5. **保存**
   - 登録した部品は、iCADの「標準部品ライブラリ」に保存される。  
   - 以後、[標準部品配置] コマンドから呼び出して配置できる。

---

## 注意点

- **登録先のパス**  
  通常はプロジェクトフォルダ内や共通ライブラリフォルダに保存される。社内で共通利用する場合は、ネットワーク共有フォルダに置くと良い。
  
- **バージョン管理**  
  V8L4で登録した標準部品はV8L3環境でそのまま使えない場合がある。必要なら「保存形式をV8L3に変換」してから登録する。

- **2Dと3Dの両対応**  
  標準部品は2Dシンボルだけ、または3Dモデルだけでも登録可能。両方作ってリンクしておくと製作図への展開が楽。

---

👉 質問だけど、あなたがやりたいのは **配管継手やバルブみたいな汎用部品を標準化しておきたい**のか、  
それとも **自作したカスタム部品を社内ライブラリに登録して再利用したい**のか、どっち？  

それによって具体的な登録方法（特に属性と保存先の扱い）が変わるよ。

### assistant  

```
iCAD SX 標準部品 登録（ちょうど良い要約）

1) フォルダを用意
   …\PDS\SYS\PARTS_SPEC\(自社規格名)\チーズ\
   ※ JIS-SYS/JPI-SYS 直下には置かない

2) CSV（部品寸法表）を作る【最小ルールだけ】
   ・1〜9行目：そのまま残す（システム／ユーザ行）
   ・10行目：見出し「呼び径Ａ,呼び径Ｂ,利用者部品のモデル名」
   ・11行目以降：今回は各CSVに“5行だけ”入れる（5形状）
     例）1S,1.5S,一方ショート×ローネックチーズ_1S-1.5S
   ・文字コード：Shift-JIS（CP932）／改行：CRLF／カンマ区切り
   ・呼び径は基本「大→小」。複数値は x 連結を使う

3) CSVは3つに分けて作る（各5行）
   ・チーズ_一方ショートチーズ.csv（同径）
   ・チーズ_一方ショート×ローネックチーズ.csv（異径）
   ・チーズ_両方ショート×ローネックチーズ.csv（異径）

4) インデックスCSVを追記
   同フォルダの「チーズ.csv」に、上の3CSVそれぞれを指す行を追加
   （最低限：規格番号〈14文字以内〉／部品名称／材質／CSVファイル名）

5) 反映と確認
   iCADを再起動 → 部品配置 → 規格参照で規格・部品・呼び径を選んで配置できるか確認

6) つまずいたらここを見る
   ・A10が「呼び径Ａ」になっているか（ヘッダ位置）
   ・保存場所が PARTS_SPEC\(自社規格)\チーズ\ か（JIS-SYS は×）
   ・CSVが Shift-JIS＋CRLF か、空行やタブ混在がないか
   ・データは各CSV5行にまとまっているか／モデル名の綴りが一致しているか
```

### assistant  

了解 ✅  
では方針を整理すると：  

- **インデックス `チーズ.csv`**  
  - 部品名称 → 日本語「ローネック」  
  - 規格番号 → `SS_RN` / `DS_RN`  
  - 材質 / CSVファイル名 → 現状維持  

- **寸法表CSV（3ファイル）**  
  - 「利用者部品のモデル名」列やタイトル行 → 日本語「ローネック」  
  - ファイル名はそのまま（`…ローネック…csv` に戻す）  

---

## PowerShell 修正スクリプト
```powershell
# === USR1\チーズ：LowNeck → ローネック（部品名称・モデル名）に戻す ===
$enc = [Text.Encoding]::GetEncoding(932)
$dir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$idx = Join-Path $dir 'チーズ.csv'

# 1) 寸法表ファイル名を LowNeck → ローネック に戻す
$renames = @(
  @{ Old='チーズ_一方ショート×LowNeckチーズ.csv'; New='チーズ_一方ショート×ローネックチーズ.csv' },
  @{ Old='チーズ_両方ショート×LowNeckチーズ.csv'; New='チーズ_両方ショート×ローネックチーズ.csv' }
)
foreach($r in $renames){
  $oldP = Join-Path $dir $r.Old
  $newP = Join-Path $dir $r.New
  if(Test-Path $oldP){
    if(Test-Path $newP){ Remove-Item $newP -Force }
    Rename-Item $oldP $r.New -Force
    Write-Host "リネーム: $($r.Old) → $($r.New)"
  }
}

# 2) 寸法表CSV内の表記置換（LowNeck → ローネック）
$specFiles = Get-ChildItem $dir -Filter 'チーズ_*.csv' | Where-Object { $_.Name -match 'ローネック|LowNeck' }
foreach($f in $specFiles){
  $bak = "$($f.FullName).bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
  Copy-Item $f.FullName $bak
  $lines = [IO.File]::ReadAllLines($f.FullName,$enc) -replace 'LowNeck','ローネック'
  [IO.File]::WriteAllLines($f.FullName,$lines,$enc)
  Write-Host "寸法表修正: $($f.Name)"
}

# 3) インデックスCSV修正
if(Test-Path $idx){
  $bak = "$idx.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
  Copy-Item $idx $bak
  $lines = [IO.File]::ReadAllLines($idx,$enc)

  for($i=0;$i -lt $lines.Count;$i++){
    # 部品名称だけローネックに戻す
    $lines[$i] = $lines[$i] -replace 'LowNeck','ローネック'
  }

  # 規格番号は SS_RN / DS_RN に統一
  for($i=0;$i -lt $lines.Count;$i++){
    $lines[$i] = $lines[$i] -replace 'SS_LN','SS_RN'
    $lines[$i] = $lines[$i] -replace 'DS_LN','DS_RN'
  }

  [IO.File]::WriteAllLines($idx,$lines,$enc)
  Write-Host "インデックス修正完了: $idx"
}
```

---

## 実行後チェック
1. `C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\` に  
   - `チーズ_一方ショート×ローネックチーズ.csv`  
   - `チーズ_両方ショート×ローネックチーズ.csv`  
   が戻っている  
2. それぞれの CSV を開くと、モデル名やタイトルが **ローネック** 表記  
3. `チーズ.csv` を開くと：  
   - 部品名称が「ローネック」  
   - 規格番号が `SS` / `SS_RN` / `DS_RN`  

---

👉 これで「名称は日本語ローネック」「略称コードは RN」統一になります。  
やりますか？

### user  

今までの会話から最良の方法でお願い

### assistant  

OK！本体の置換は走ってます。出たエラーは**ログ出力部分の `-f` 文字列整形**が原因です（PowerShellの書式化と `AppendLine()` の相性）。  
ログだけ**安全な補正**に差し替えて再実行してください。

## 1) ログ出力だけ修正（再実行用パッチ）
```powershell
# ---- ここだけコピペしてEnter（前スクリプトの後でOK）----
$dir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$log = Join-Path $dir 'インデックス追記_ログ.txt'

# 直前の結果を推測（存在しない場合は空でOK）
if (-not (Get-Variable -Name renamed -ErrorAction SilentlyContinue)) { $renamed = @() }
if (-not (Get-Variable -Name specResults -ErrorAction SilentlyContinue)) { $specResults = @() }
if (-not (Get-Variable -Name idxReplaced -ErrorAction SilentlyContinue)) { $idxReplaced = $false }

$sb = New-Object System.Text.StringBuilder
$null = $sb.AppendLine("=== LowNeck 一括置換ログ ===")
$null = $sb.AppendLine("日時: $(Get-Date)")
$null = $sb.AppendLine("対象フォルダ: $dir")
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[ファイル名のリネーム]")
foreach($r in $renamed){
  $status = if($r.Done){'OK'}else{'無し'}
  $null = $sb.AppendLine(" - $($r.Old) -> $($r.New) : $status")
}
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[寸法表CSV 置換結果（ローネック→LowNeck）]")
foreach($r in $specResults){
  $status = if($r.Replaced){'OK'}else{'未処理／未発見'}
  $null = $sb.AppendLine(" - $($r.File) : $status")
}
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[インデックス置換]")
$null = $sb.AppendLine(" - チーズ.csv : " + (if($idxReplaced){'OK'}else{'未処理／未発見'}))

[IO.File]::WriteAllText($log, $sb.ToString(), [System.Text.Encoding]::GetEncoding(932))
Write-Host "ログ更新: $log"
# ---- ここまで ----
```

## 2) 変更結果のクイック確認
```powershell
# ファイル名が変わっているか
Get-ChildItem 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ' -Filter '*LowNeck*'

# 寸法表CSV 内部の表記が LowNeck になっているか
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\*.csv' -Pattern 'LowNeck' | Select-Object -First 10

# インデックスに SS_LN / DS_LN が入っているか
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Pattern 'SS_LN','DS_LN','LowNeck'
```

## 3) うまくいっていれば…
- フォルダ内に  
  - `チーズ_一方ショート×LowNeckチーズ.csv`  
  - `チーズ_両方ショート×LowNeckチーズ.csv`  
  が存在（元名は自動で差し替え／.bak付きバックアップ作成済み）
- 各CSVの**10行目ヘッダはそのまま**、モデル名などの本文が **LowNeck** 表記  
- インデックス `チーズ.csv` に **SS_LN / DS_LN** と **…LowNeck….csv** が反映

問題なければ iCAD を再起動して **規格参照 → USR1 → チーズ** から呼び出し確認へ。  
もし「ここも LowNeck にしてほしい」箇所があれば（例：モデル名の英語表記規則、他部品群など）、その範囲を教えてくれれば同じ方式で**追加一括置換**を用意するよ。

### assistant  

```
iCAD SX 標準部品 登録（超ざっくり）

1) 置き場所を作る
   …\PDS\SYS\PARTS_SPEC\（自社規格名）\（部品種類：例 チーズ） を用意
   ※ JIS-SYS/JPI-SYS直下には置かない

2) 部品寸法表CSVを作る（縦持ち）
   ・1〜5行目：システム予約（そのまま）
   ・6〜9行目：ユーザ行（自由に可）
   ・10行目：見出し「呼び径Ａ,呼び径Ｂ,利用者部品のモデル名」
   ・11行目以降：呼び径の組み合わせごとに1行、最後の列にモデル名
   （改行＝CRLF、文字コード＝Shift-JIS が無難）

3) 呼び径の書き方
   ・大きい方→小さい方の順
   ・複数値は「x」で連結（例：300Ax250A）
   ・余分な空白や全角記号の混在は避ける

4) インデックスCSVを更新
   同じ規格フォルダのインデックス（例：チーズ.csv）に、
   いま作った寸法表CSVの行を追記（規格番号・材質なども合わせて記入）

5) iCADで使う
   iCAD再起動 → 部品配置 → 規格参照から規格/部品/呼び径を選んで配置
   （必要ならBOM/Excel出力テンプレも合わせて設定）

メモ：
・規格番号は14文字以内／同一規格×同一部品種類あたり最大640件
・SYS系フォルダは編集しない
```

このまま社内Wikiや手順書にコピペして使ってOKです。

### assistant  

いい質問 👍  

これはぼくが「規格番号（14文字以内で好きに決めてOK）」の欄に仮で入れた**社内識別コード**です。  

- **SS** = *Single Short*（＝一方ショートチーズ）  
- **SS_RN** = *Single Short + RoNeck*（＝一方ショート×ローネックチーズ）  
- **DS_RN** = *Double Short + RoNeck*（＝両方ショート×ローネックチーズ）  

---

## 規格番号について
- iCADのマニュアルでは「規格番号」は**14文字以内／任意の英数字**でOK  
- ここでいう **SS / SS_RN / DS_RN** はあくまで「わかりやすい略号」として提案しただけ  
- 実際には会社ルールに合わせて、例えば  
  - `U001` / `U002` / `U003` といった**番号体系**  
  - `C-SS` / `C-SSRN` / `C-DSRN` のような**記号体系**  
  など自由に決めて良い  

---

👉 つまり、「SS / SS_RN / DS_RN」はあくまで仮。  
運用に合わせて、例えば **製造部が分かる番号体系**に置き換えるべきです。  

---

質問：  
この「規格番号」は **社内で番号ルールをもう持ってる？**  
それともこちらで「シンプルな連番案（U001〜）」を提案して埋めちゃった方がやりやすい？

### user  

配管継手やバルブみたいな汎用部品を標準化しておきたい。社外品の規格チーズをローネックチーズ、ローアームチーズ、配管径別の組み合わせで、合計15種類を社内標準の部品として、モデル登録したい。

### user  

部品名称は14文字以内じゃないと、ICADで呼び出せないらしい。わかりやすい最良の名前でお願い

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-2eWiMeCsfTwQQxjYYYih51; size_bytes=47981; width=629; height=743; fovea=; metadata=}

これ

### assistant  

いいね！目的が「階層を“構造として”僕に共有する」なら、PowerShellで一発抽出→そのままファイルを貼るのが最速です。用途別に3パターン用意したよ（どれか1つでOK）。

---

## ① 最短：見やすいツリー（人間が読む）
```
# ルートだけ書き換えて実行
$root = 'C:\iCADSX\PDS\SYS\PARTS_SPEC'
tree $root /F /A > "$env:USERPROFILE\Downloads\icad_tree.txt"
```
- 文字だけの“木”が `icad_tree.txt` に出ます。
- 手早く全体像を把握したいとき向け。

---

## ② 推奨：CSVマニフェスト（僕に渡すならこれが一番）
```
$root = 'C:\iCADSX\PDS\SYS\PARTS_SPEC'
Get-ChildItem $root -Recurse -Force |
  Where-Object { $_.PSIsContainer -or $_.Extension -match '\.csv$' } |
  Select-Object @{N='Type';E={if ($_.PSIsContainer){'Dir'}else{'File'}}},
                @{N='RelativePath';E={$_.FullName.Substring($root.Length+1)}},
                @{N='Depth';E={($_.FullName -split '\\').Count - ($root -split '\\').Count}},
                @{N='SizeKB';E={ if ($_.PSIsContainer){$null}else{ [math]::Round($_.Length/1KB,1) } }},
                LastWriteTime
| Export-Csv "$env:USERPROFILE\Downloads\icad_manifest.csv" -NoTypeInformation -Encoding UTF8
```
- 階層・相対パス・サイズ・更新日が入った一覧（=後でフィルタしやすい）。
- `icad_manifest.csv` をここにアップしてくれれば、必要なCSV位置をピンポイントで案内できる。

### ※不要な巨大フォルダを除外したいとき（例：WORK/TEMP/BACKUP）
```
$exclude = 'WORK|TEMP|BACKUP'
Get-ChildItem $root -Recurse -Force |
  Where-Object { $_.FullName -notmatch "\\($exclude)(\\|$)" } | ...（以下同じ）
```

---

## ③ 詳細：JSONツリー（機械可読／深さ制限つき）
```
$root = 'C:\iCADSX\PDS\SYS\PARTS_SPEC'
function Get-Tree($path,$maxDepth=5){
  $node = [ordered]@{ name = (Split-Path $path -Leaf); type='dir'; children=@() }
  if($maxDepth -le 0){ return $node }
  Get-ChildItem $path -Directory | ForEach-Object {
    if($_.Name -notmatch '^(WORK|TEMP|BACKUP)$'){
      $node.children += Get-Tree $_.FullName ($maxDepth-1)
    }
  }
  Get-ChildItem $path -File -Include *.csv | ForEach-Object {
    $node.children += @{ name=$_.Name; type='file'; rel=$_.FullName.Substring($root.Length+1); size=$_.Length; mtime=$_.LastWriteTime }
  }
  $node
}
(Get-Tree $root 5) | ConvertTo-Json -Depth 100 |
  Set-Content "$env:USERPROFILE\Downloads\icad_tree.json" -Encoding UTF8
```
- フォルダ→children配列のJSON。後で目的のCSVを自動抽出しやすい。

---

### アップロードのコツ
- まずは②の `icad_manifest.csv` をアップ → ぼくが必要箇所だけ掘り下げる形が一番効率的。
- ルートは目的に合わせて変更：  
  `…\PARTS_SPEC`（ライブラリ全体） / `…\PARTS_SPEC\（自社規格名）\チーズ`（今回の部品だけ）

必要なら「特定拡張子だけ」「深さNまで」「日付で絞る」などのフィルタ付きワンライナーもすぐ出すよ。

### user  

LowNeckが正しいので、全部自動修正したい

### tool  

The file contents provided above are truncated/partial snippets. The complete content for these files IS accessible via querying.

If the user asks a question related to these files, and the provided snippets do not clearly answer it, you **MUST** use the `file_search` tool to search the full document contents before responding.

## How to invoke the file_search tool
If the user's query isn't sufficiently answered by the provided snippets, parsed text, or images, you should invoke `file_search.msearch`.
To search the full content of the available files, you **must** send one message with recipient `to=file_search.msearch` in the analysis channel. Your message should be structured exactly as follows:
```
{
  'queries': ['Example query 1', 'Example query 2']  // List of up to five queries to search for.
}
```

Carefully balance the number of `file_search` calls and the quality of your response with the latency incurred by `file_search` calls.

Important guidelines for query formatting:
- Your message must be a valid JSON object. Do not include any extraneous text, backticks, markdown formatting, or comments beyond what is shown.
- The `queries` field must be a list of strings.
- One of the queries **MUST** exactly match the user's original question, but stripped of any extraneous details, and with ambiguous references clearly resolved using context from the conversation. It **MUST** be a complete sentence.
- Even if you suspect the user meant something else, one query **MUST** still be their original question.

## How to handle results from file_search
The file search tool will respond with the relevant search results from the full files. After you receive these results:
- Carefully evaluate each result to determine its relevance and quality.
- Use the high-quality and relevant results to inform your answer to the user's question.
- When possible, reuse information from prior file_search results and avoid repeating identical queries.

## Tool usage instructions and ordering
When the user asks a question, carefully consider whether the provided snippets sufficiently answer the query, whether you need to invoke `file_search.msearch`, or another available tool (such as `web`, if available) should be used instead.

Tool-ordering Guidelines:
1. For queries related to uploaded files, if snippets are insufficient, strongly prefer invoking `file_search.msearch` over other tools.
    - Avoid using `web.run`, `python` analysis, or any other tools until you have either:
        - Confirmed with high confidence the answer is not in the files, or
        - Have high confidence `file_search_tool` queries are not sufficient to answer the query.
2. Avoid usage of `web_search/web.run` for queries related to uploaded files
    - Carefully consider whether the user's query is better answered by web search results rather than available snippets or results from `file_search_tool`.
    - Unless the user's query is clearly unrelated to the uploaded files, prefer using `file_search.msearch`. You can always follow up with a web search if necessary for a more complete response.
3. Avoid using `python` unless necessary or requested by user.
    - If the user's query is answerable from the parsed text and images from the uploaded files, or from `file_search_tool`, do not invoke `python`.

Always keep this instruction in mind for the rest of the conversation, as the user may reference these files or ask related questions later on.

### user  

ダウンロードフォルダに上のCSVを生成したい。

### user  

パワーシェルで実行でいいの？

### assistant  

了解。**右の元CSVと同じ“縦持ち＋モデル名を最後列”**の構造に直した版を、ダウンロードフォルダへ一発生成できる PowerShell を出す。  
（先頭1〜9行のシステム行も元の書式で入れてある）

```powershell
# === iCAD配管部品CSV（チーズ系）を縦持ち構造で3ファイル生成 ===
$DL = "$env:USERPROFILE\Downloads"

# 呼び径→外径(mm)  ※必要に応じて調整
$OD = @{ '1S'='25.4mm'; '1.5S'='38.1mm'; '2S'='50.8mm'; '2.5S'='63.5mm'; '3S'='76.3mm' }

function New-Head([string]$title){
@"
1,チーズ,$title,USER_PART
2,システム行,１〜５行目はシステムリザーブです
3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください
4,システム行,システムリザーブ
5,システム行,システムリザーブ
6,ユーザ行,６〜９行目は利用者開放領域です
7,ユーザ行,御自由に御利用下さい
8,ユーザ行
9,ユーザ行
"@
}

# ---------- 1) 一方ショートチーズ（単寸法を内部規格に委ねるタイプ）
# 右の既存CSVに合わせ、列は「呼び径A, O.D.(mm), 利用者部品のモデル名」
$rows_SS = @(
  @{A='1S'  }
  @{A='2S'  }
  @{A='2.5S'}
  @{A='3S'  }
)
$csv1  = New-Head '一方ショートチーズ'
$csv1 += "呼び径A,O.D.(mm),利用者部品のモデル名`n"
foreach($r in $rows_SS){
  $csv1 += "{0},{1},{2}`n" -f $r.A, $OD[$r.A], ("一方ショートチーズ_{0}" -f $r.A)
}
$path1 = Join-Path $DL 'チーズ_一方ショートチーズ.csv'
$csv1 | Out-File -Encoding UTF8 $path1

# ---------- 2) 一方ショート×ローネックチーズ（L1,L2あり）
# 列は「呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),利用者部品のモデル名」
$rows_SSRN = @(
  @{A='1S'  ; B='1.5S'; L1=38; L2=35}
  @{A='1.5S'; B='2S'  ; L1=48; L2=45}
  @{A='2S'  ; B='2.5S'; L1=55; L2=50}
  @{A='2.5S'; B='3S'  ; L1=62; L2=57}
  @{A='3S'  ; B='3S'  ; L1=68; L2=63}
)
$csv2  = New-Head '一方ショート×ローネックチーズ'
$csv2 += "呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),利用者部品のモデル名`n"
foreach($r in $rows_SSRN){
  $csv2 += "{0},{1},{2},{3},{4},{5},{6}`n" -f $r.A, $r.B, $OD[$r.A], $OD[$r.B], $r.L1, $r.L2, ("一方Sローネックチーズ_{0}-{1}" -f $r.A,$r.B)
}
$path2 = Join-Path $DL 'チーズ_一方ショート×ローネックチーズ.csv'
$csv2 | Out-File -Encoding UTF8 $path2

# ---------- 3) 両方ショート×ローネックチーズ（L1,L2,L3あり）
# 列は「呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),L3(mm),利用者部品のモデル名」
$rows_DSRN = @(
  @{A='1S'  ; B='1.5S'; L1=35; L2=38; L3=35}
  @{A='1.5S'; B='2S'  ; L1=45; L2=48; L3=45}
  @{A='2S'  ; B='2.5S'; L1=50; L2=55; L3=50}
  @{A='2.5S'; B='3S'  ; L1=57; L2=62; L3=57}
  @{A='3S'  ; B='3S'  ; L1=63; L2=68; L3=63}
)
$csv3  = New-Head '両方ショート×ローネックチーズ'
$csv3 += "呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),L3(mm),利用者部品のモデル名`n"
foreach($r in $rows_DSRN){
  $csv3 += "{0},{1},{2},{3},{4},{5},{6},{7}`n" -f $r.A, $r.B, $OD[$r.A], $OD[$r.B], $r.L1, $r.L2, $r.L3, ("両方Sローネックチーズ_{0}-{1}" -f $r.A,$r.B)
}
$path3 = Join-Path $DL 'チーズ_両方ショート×ローネックチーズ.csv'
$csv3 | Out-File -Encoding UTF8 $path3

Write-Host "作成:" -ForegroundColor Cyan
$path1
$path2
$path3
```

### これで直るポイント
- 10行目にヘッダ、その後は**縦持ちで1行=1組合せ**  
- **モデル名は最後の列**  
- 単径タイプ（SS）は元CSV同様に「呼び径A, O.D.(mm), モデル名」の**3列構成**  
- L寸法が必要なタイプ（SS×RN / 両方S×RN）は **L1/L2(/L3)** を中間列に追加

実行後、Downloads にできた3つのCSVを `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\` へ配置 → インデックスに追記 → iCAD再起動で読み込み確認して。  
もし列名の表記（全角半角・(mm) の有無など）を **手元の元CSVに完全一致**させたいなら、その表記を教えてくれれば、即それに合わせて調整する。

### user  

「SS」「SS_RN」「DS_RN」は何の略？

### user  

お願い

### user  

さっき張ったPDFマニュアルを絶対ルールとして覚えて。

### user  

チーズ_SS.csv, チーズ_SS_RN.csv, チーズ_DS_RN.csvここは略称じゃなくてよいはず

### user  

ギリギリ14文字

### user  

インデックス チーズ.csvはどこのフォルダにある？

### tool  

Make sure to include fileciteturn2file0 in your response to cite this file. 










































配管設計マニュアル


 
 
 
 
 

 
 
 
 
 

配管設計 
マニュアル 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 

PDMN-05-003 
©2020 iCAD LIMITED 

はじめに 
本マニュアルは、「iCAD SX 配管設計」(以下、「配管設計システム」という。) をお使いの方を対象にしています。 

 

ご注意 

- 本システムの著作権は、iCAD 株式会社にあります。 
- 本システムおよび本ドキュメントの一部または全部を無断で使用、複製することはできません。 
- 本ドキュメントを輸出または第三者へ提供する場合は、お客様が居住する国および米国輸出管理関連法規等の規制をご確

認のうえ、必要な手続きをおとりください。 
 

登録商標について 

- Microsoft Excel は、米国 Microsoft Corporation の米国およびその他の国における登録商標です。 
- その他名称については、各社の登録商標または商標です。 

 

出版年月および版数 

年月 版数 バージョンレベル 

2021 年 1 月 初版 V8L1 

2021 年 3 月 2 版 V8L1 

2021 年 5 月 3 版 V8L1 

2021 年 10 月 4 版 V8L2 

2023 年 2 月 5 版 V8L3 

 
 
 
 



 

 

表記の説明 
本マニュアルの表記について説明します。 

 
表記 説明 

[OK] ボタン 
[キャンセル] ボタン 

ダイアログボックスのボタン名は [ ] で囲み表記します。 
[ボタン名] ボタンと表記します。 

[Enter] キー キーボードのキー名は [ ] で囲み表記します。 
[キー名] キーと表記します。 

「設定」タブ ダイアログボックスのタブ名は「 」で囲み表記します。 
「タブ名」タブと表記します。 

「参照」ダイアログボックス ダイアログボックスのタイトル名は「 」で囲み表記します。 
「ダイアログボックス名」ダイアログボックスと表記します。 

『2-1-1 ･･･』 本書内の他の項目への参照は『 』で囲み表記します。 

[動作環境設定] コマンド名は [ ] で囲み表記します。 

 [製図]－[製図文字] ･･･ アイコンメニューは  で表記します。 

 <T>[製図] <C>[注記] ･･･ コマンドメニューは  で表記します。 

<T>[製図] トップメニューのコマンドは <T>[ ] で囲み表記します。 

<C>[注記] コマンドメニューのコマンドは <C>[ ] で囲み表記します。 

<D>[作成] 詳細メニューのコマンドは <D>[ ] で囲み表記します。 

[GO] マウスを右クリックします。 

 
知っておくべき重要な内容を示します。 

 
注意すべき内容を示します。 

 
補足説明を示します。 

 
 



 

 

目次 

第 1 章 配管設計を始める前に ·············································································· 1 
1-1. 配管設計システムについて ................................................................................................................ 1 

1-1-1 概要 ............................................................................................................................................ 1 
1-1-2 フォルダ構成 ............................................................................................................................ 2 
1-1-3 配管部品種別 ............................................................................................................................ 3 

1-2. 留意事項 ................................................................................................................................................ 3 
1-2-1 システム提供ファイルに関する注意 .................................................................................... 3 
1-2-2 制限事項 .................................................................................................................................... 3 
1-2-3 拡張パーツ属性 ........................................................................................................................ 4 
1-2-4 サンプルファイル .................................................................................................................... 8 

第 2 章 配管ルール ····························································································· 9 
2-1. 配管ルール概要 .................................................................................................................................... 9 
2-2. 「配管ルール設定ツール」の起動設定 .......................................................................................... 10 
2-3. 配管ルールの読み込み ...................................................................................................................... 12 
2-4. 配管ルールの操作 .............................................................................................................................. 13 

2-4-1 「配管ルール」の編集 .......................................................................................................... 13 
2-4-2 規格チェック .......................................................................................................................... 15 
2-4-3 「配管ルール」の作成 .......................................................................................................... 17 
2-4-4 「配管ルール」の行追加と行削除について ...................................................................... 18 

2-5. 「ルール」の管理 .............................................................................................................................. 19 
2-5-1 ファイル構成 .......................................................................................................................... 19 
2-5-2 「ルールグループ」「ルール」の変更 ................................................................................ 19 

2-6. 「締結部品」のルール設定 .............................................................................................................. 20 
2-7. 補足情報設定表 .................................................................................................................................. 21 

第 3 章 配管部品登録 ························································································· 22 
3-1. 配管部品登録について ...................................................................................................................... 22 

3-1-1 配管部品ライブラリ .............................................................................................................. 22 
3-1-2 登録の流れ .............................................................................................................................. 23 
3-1-3 配管部品登録の留意事項 ...................................................................................................... 24 

3-2. 部品登録体系の決定 .......................................................................................................................... 25 
3-3. 配管部品属性の設定(「利用者部品登録」ダイアログボックス) ................................................ 26 

3-3-1 「利用者部品登録」ダイアログボックスと「部品登録用情報テーブル」................... 27 
3-3-2 「部品登録用情報テーブル」の編集方法 .......................................................................... 32 
3-3-3 「利用者部品登録」ダイアログボックスの設定手順 ...................................................... 33 
3-3-4 属性設定時に表示されるメッセージ .................................................................................. 34 

3-4. 「部品中心線」と基準点 .................................................................................................................. 36 
3-4-1 作成規則(部品共通) ............................................................................................................... 36 
3-4-2 作成規則(部品別) ................................................................................................................... 37 
3-4-3 「部品中心線」の作成と基準点の位置設定 ...................................................................... 40 

3-5. パイプ部品の登録 .............................................................................................................................. 41 
3-5-1 パイプの登録 .......................................................................................................................... 41 
3-5-2 ミリ呼び径パイプの登録 ...................................................................................................... 44 

3-6. 配管部品登録 ...................................................................................................................................... 46 
3-6-1 呼び径ごとの配管部品登録 .................................................................................................. 46 
3-6-2 パラメトリック部品の配管部品登録 .................................................................................. 50 

3-7. その他のユーザー部品登録 .............................................................................................................. 55 
3-7-1 その他部品の登録(2 軸 2 接続点) ........................................................................................ 55 
3-7-2 「金具部品」の登録 .............................................................................................................. 59 
3-7-3 分岐品の登録 .......................................................................................................................... 62 



 

 

3-7-4 「締結部品」の登録 .............................................................................................................. 65 
3-8. 登録済み配管部品の編集 .................................................................................................................. 67 

3-8-1 配管部品情報の再設定 .......................................................................................................... 67 
3-8-2 「部品中心軸」の再設定 ...................................................................................................... 68 

3-9. 「部品種類」の分類定義 .................................................................................................................. 69 

第 4 章 シンボル登録 ························································································· 72 
4-1. 配管シンボル登録について .............................................................................................................. 72 

4-1-1 配管シンボル .......................................................................................................................... 72 
4-1-2 ファイル構成 .......................................................................................................................... 72 
4-1-3 シンボル登録の流れ .............................................................................................................. 72 
4-1-4 スケーリング値と面間距離 .................................................................................................. 73 

4-2. シンボルの登録 .................................................................................................................................. 74 
4-2-1 シンボルの作成(ユーザーシンボル).................................................................................... 74 

4-3. 「部品寸法表ファイル」の登録 ...................................................................................................... 76 
4-3-1 シンボル登録の規則 .............................................................................................................. 76 
4-3-2 「部品寸法表ファイル」の設定 .......................................................................................... 77 

4-4. 配管部品のシンボル例 ...................................................................................................................... 78 

第 5 章 部品仕様ファイル ··················································································· 79 
5-1. 部品仕様ファイルについて .............................................................................................................. 79 

5-1-1 ファイル構成 .......................................................................................................................... 80 
5-1-2 登録できる部品種類 .............................................................................................................. 80 
5-1-3 注意事項 .................................................................................................................................. 80 

5-2. 部品寸法表インデックスファイル .................................................................................................. 81 
5-2-1 ファイルの内容 ...................................................................................................................... 81 
5-2-2 拡張情報 .................................................................................................................................. 82 

5-3. 部品寸法表ファイル .......................................................................................................................... 82 
5-3-1 ファイルの内容 ...................................................................................................................... 83 
5-3-2 設定方法 .................................................................................................................................. 83 

5-4. 管一品図の寸法幅設定(FCLEN 設定) .............................................................................................. 86 
5-4-1 「部品寸法表ファイル」の寸法設定 .................................................................................. 86 

5-5. 「補助配置基準点」設定(STDLEN 設定) ....................................................................................... 89 
5-5-1 「部品寸法表ファイル」への補助配置基準点設定 .......................................................... 89 

第 6 章 論理図シンボル登録 ················································································ 91 
6-1. 論理図シンボルについて .................................................................................................................. 91 

6-1-1 論理図シンボルとは .............................................................................................................. 91 
6-1-2 論理図シンボル属性点の種類 .............................................................................................. 92 
6-1-3 論理図シンボル登録の流れ .................................................................................................. 92 

6-2. 論理図シンボル形状作成 .................................................................................................................. 93 
6-2-1 論理図シンボル形状の新規作成 .......................................................................................... 93 
6-2-2 DXF ファイルの配管論理図データを変換して作成 ......................................................... 95 

6-3. 論理図シンボルの登録 ...................................................................................................................... 98 
6-4. 論理図シンボルの編集 .................................................................................................................... 101 
6-5. 論理図の環境設定 ............................................................................................................................ 105 

6-5-1 論理図の共通設定 ................................................................................................................ 105 
6-5-2 部品種類定義ファイル設定 ................................................................................................ 106 

第 7 章 旧バージョンからのバージョンアップ ····················································· 107 
7-1. 「規格名称」の「部品登録用情報テーブル」修正 .................................................................... 107 
7-2. 配管部品ライブラリコンバータ .................................................................................................... 108 

7-2-1 配管部品ライブラリコンバーターの実行 ........................................................................ 108 



 

 

付録 A 部品登録用情報テーブル ········································································ 110 

付録 B 部品形状の作成方法 ·············································································· 113 



第 1 章 配管設計を始める前に 
 

1 

第1章 配管設計を始める前に 

1-1. 配管設計システムについて 

1-1-1 概要 
「配管設計システム」は、機械装置から大規模な機械プラントまでの配管設計を、3 次元空間上で行うソフトウェアです。 
JIS 規格と JPI 規格に準拠した配管部品のほか、ユーザー独自の規格で部品を登録して配管設計に利用できます。 

 

配管部品ライブラリ 

配管設計システム 

配管設計システム 

配管部品管理 パラメトリック部品 

CSV 
配管部品 

JIS規格部品 

ユーザー部品 

部品寸法表ファイル 

Excel 

部品寸法表 
インデックスファイル 

配置 

配管ルール 

～40A⇒SW 
50A～⇒BW 

例）エルボ 

Excel 

配管設計 

溶接番号風船作成 

溶接情報作成 

管一品図作成 

配管シンボルファイル 



第 1 章 配管設計を始める前に 
 

2 

1-1-2 フォルダ構成 

 
  

iCAD SX インストールフォルダ 

PDS 

ETC 

SYS 

Welding Information.xlt 
配管ルール設定.xls 

PARTS_SPEC 

JIS-SYS 

BRANCH 

B2301(Ｉ形)径違い 

B2301(Ⅰ形)径違い@3DPARAM.csv 

B2301(Ⅰ形)径違い@3DPARAM.icd 

T_0_sym.icd 

ティー.csv 

ティー_B2301_径違い.csv 

JPI-SYS 

SYS_STAND_CONNECT.csv 

SYS_STAND_FACE.csv 

SYS_STAND_MATERIAL.csv 

SYS_STAND_PRESSURE.csv 

SYS_STAND_SCHEDULE.csv 

SYS_STAND_TBL.csv 

SYS_STAND_TYPE.csv 

RULE 

DEFAULT 

DEFAULT_rule.csv 

SYS_HOSE_RULE.csv 

CAP ･
･
･  

TEE 

B2301(Ｉ形)同径 ･
･
･  

･
･
･  

･
･
･  

ティー_B2301_同径.csv 

T_1_sym.icd 

･
･
･  

溶接情報表(配管用) テンプレート 

配管ルール設定ツール 

配管部品ライブラリ 

標準提供の配管部品(JIS 規格準拠) 

標準提供の配管部品(JPI 規格準拠) 

接続形式 

フェイス 

材質(記号) 

呼び圧力 

スケジュール 

規格名称 

タイプ 

パラメトリック部品フォルダ 

パラメトリック部品パターンファイル 

パラメトリック部品ファイル 

配管シンボルファイル 

部品仕様ファイル 部品寸法表インデックスファイル 

部品寸法表ファイル 

部品登録用情報テーブル 

ルールグループ 

ルールファイル 

ホース品番定義ファイル 

･
･
･  

配管ルール 

『第 5 章 部品仕様ファイル』参照 

『3-6-2 パラメトリック部品の配管部品登録』参照 

『第 2 章 配管ルール』参照 

『3-3. 配管部品属性の設定 

(「利用者部品登録」ダイアログボックス)』 

参照 



第 1 章 配管設計を始める前に 
 

3 

1-1-3 配管部品種別 
配管設計システムでは、配管部品を以下のように分類しています。 

分類 配管部品の種類 
パイプ パイプ 

配管標準部品 継手 分岐品、キャップ、エルボ、フランジ、ガスケット、レデューサ、ソケット、ティー、 
ユニオン、X 型、Y 型 

バルブ リフト逆止弁、玉形弁、仕切弁、スイング逆止弁 
締結品 ボルト、ナット、ワッシャ 

その他部品 継手 ニップル、フルカップリング 

パイプ／配管標準部品／締結品 以外で登録されたユーザ部品 

1-2. 留意事項 

1-2-1 システム提供ファイルに関する注意 
"iCAD SX インストールフォルダ¥PDS¥SYS¥PARTS_SPEC" フォルダ配下のファイルは、レベルアップインストールや修正プ

ログラムをインストールすると上書きされます。 
配管部品や「部品登録用情報テーブル」を登録する場合は、以下の点に注意してください。 

 

JIS-SYS、JPI-SYS 

"JIS-SYS"、"JPI-SYS" フォルダは、システムが提供している配管部品ライブラリです。 
 "JIS-SYS"、"JPI-SYS" フォルダに、配管部品の登録や編集はしないでください。 
 パイプ以外の配管部品は流用できません。 

 

部品登録用情報テーブル 

"iCAD SX インストールフォルダ¥PDS¥SYS¥PARTS_SPEC" フォルダ配下のファイル名の先頭に"SYS_" が付くファイルは、シ

ステムが用意している「部品登録用情報テーブル」です。 
 ファイル名の先頭に"SYS_" が付く「部品登録用情報テーブル」は、編集しないでください。 
「部品登録用情報テーブル」を編集する場合は、『3-3-2 「部品登録用情報テーブル」の編集方法』を参照してくださ

い。 

1-2-2 制限事項 
配管設計システムには、以下の制限事項があります。 
 配管設計システムの図面に配置されている配管部品は、パーツ解除しないでください。 
 同一規格内の 1 つの部品種類で登録できる配管部品の数は最大 640 個です。 
それ以上の数の配管部品を登録する場合は、規格を分けてください。 

 配管部品ライブラリに登録できる部品の要素数は、中心軸やホース用金具の口元点を含めて、1 ファイルにつき最大 100
個です。 

 管一品図の対象の部品および作成できる寸法は、それぞれ最大 1000 個です。 
以下のメッセージが表示されて管一品図が作成できない場合は、系統を分けてください。 

MSG07573 対象となる部品が 1000 個を超えるため、系統を分けて実行してください。 

 

MSG07574 作成する寸法線が 1000 個を超えるため、系統を分けて実行してください。 

 
上記以外の文字数などの制限事項は、各項目を確認してください。 

 
  



第 1 章 配管設計を始める前に 
 

4 

1-2-3 拡張パーツ属性 
配管部品に拡張パーツ属性が設定されている場合、配管設計の操作によってパーツ属性の保持状態が変わります。 

 補足 
拡張パーツ属性には「拡張パーツ情報」と「拡張構成情報」があります。詳細は、『ユーザーズガイド』を参照してくださ

い。 

部品の新規作成 

 
 

パイプの分割、部品の挿入 

 

パイプ 
系統-01 

 

 

パイプ：拡張パーツ情報も拡張構成情報も付加されません。 
パイプ 

パイプ以外の配管部品 

部品 

 

ライブラリの

パーツ情報 

系統-01 

部 品：部品ライブラリの拡張パーツ情報だけが付加されます。 

系統-01 
パイプ 

系統-01 
パイプ[2] 

パイプ パーツ情報_A 

構成情報_A パーツ情報_A 

構成情報_A 

パイプ 
パーツ情報_A 

構成情報_A 

パイプ：拡張パーツ情報と拡張構成情報を引き継ぎます。 

パイプ 

 [配管]－[経路作成]－ (配管作成する) 

  <T>[配管設計] <C>[配管作成] 

<D>[経路点指定]／[ワイヤ⇒配管] 

 [配管]－[経路作成]－ (部品を配置する) 

  <T>[配管設計] <C>[部品配置]  

<D>[部品選択] [配置] 

 [配管]－[配管編集]－ (管切断する) 

  <T>[配管設計] <C>[配管編集] <D>[管切断] 



第 1 章 配管設計を始める前に 
 

5 

 
 

パイプの統合、部品の削除 

 

系統-01 
パイプ 

系統-01 
パイプ[2] 

パイプ パーツ情報_A 

構成情報_A  

 

パイプ 
 

 

部品 

 

ライブラリの

パーツ情報 

パイプ：拡張パーツ情報と拡張構成情報は引き継ぎません。 
部 品：部品ライブラリの拡張パーツ情報だけが付加されます。 

パイプ パイプ以外の配管部品 

パイプ パイプ以外の配管部品 

* 曲げ管⇒エルボに変更する場合 

系統-01 
パイプ 
 

 

系統-01 
パイプ[2] 

パイプ 
パーツ情報_A 

構成情報_A 

パイプ 
パーツ情報_B 

構成情報_B 

部品 
パーツ情報_C 

構成情報_C 

パイプ：拡張パーツ情報と拡張構成情報は引き継ぎません。 

パイプ 

* エルボ⇒曲げ管に変更する場合 

 [配管]－[経路作成]－ (部品を配置する) 

  <T>[配管設計] <C>[部品配置] 

<D>[部品選択] [挿入] 

 [配管]－[仕様変更] 
－ (エルボ⇔曲げ管を変換する) 

  <T>[配管設計] <C>[仕様変更] 
<D>[エルボ⇔曲げ管] 

 [配管]－[仕様変更] 
－ (エルボ⇔曲げ管を変換する) 

  <T>[配管設計] <C>[仕様変更] 
<D>[エルボ⇔曲げ管] 



第 1 章 配管設計を始める前に 
 

6 

 
 

系統の分割 

 
 

系統-01 
パイプ 
パーツ情報_A 

構成情報_A 

系統-01 
パイプ[2] 

パイプ 
パーツ情報_A 

構成情報_A 

パイプ 
パーツ情報_B 

構成情報_B 

※ [管一本化] では、先に選択したパイプの情報になります。 
※ [部品削除] では、どちらか片方のパイプの情報になります。 

部品 
パーツ情報_C 

構成情報_C 

パイプ：拡張パーツ情報と拡張構成情報を引き継ぎます。 

パイプ 

パイプ 

系統-01(系統-01-001) 

パイプ 
 

 

系統-01 
パイプ[2] 

パイプ 
パーツ情報_A 

構成情報_A 

パイプ 
パーツ情報_B 

構成情報_B 

系統-01(系統-01-002) 
パイプ 
 

 

部品 
パーツ情報_C 

構成情報_C 

部品 
パーツ情報_C 

構成情報_C 

パイプ：拡張パーツ情報と拡張構成情報は引き継ぎません。 
部 品：拡張パーツ情報と拡張構成情報を引き継ぎます。 

系統-01 
系統-01 

系統-01-001 

系統-01 

系統-01 

系統-01-002 

パイプ パイプ以外の配管部品 

パイプ パイプ以外の配管部品 

 [配管]－[配管編集]－ (管一本化する) 

  <T>[配管設計] <C>[配管編集] <D>[管一本化] 

 [配管]－[部品移動削除]－ (配管部品を削除する) 

  <T>[配管設計] <C>[部品削除] 

 [配管]－[配管編集]－ (系統分割する) 

  <T>[配管設計] <C>[配管編集] <D>[系統分割] 

 [配管]－[配管編集]－ (ピース分解する) 

  <T>[配管設計] <C>[配管編集] <D>[ピース分解] 



第 1 章 配管設計を始める前に 
 

7 

系統の統合 

 

仕様の変更 

 

 

系統-01 
パイプ[2] 

パイプ 
パーツ情報_A 

構成情報_A 

パイプ 
パーツ情報_B 

構成情報_B 

部品 
パーツ情報_C 

構成情報_C 

系統-01 
パイプ 

系統-02 
パイプ 

部品 
パーツ情報_C 

構成情報_C 

パーツ情報_A 

構成情報_A 

パーツ情報_B 

構成情報_B 

パイプ：拡張パーツ情報と拡張構成情報を引き継ぎます。 
部 品：拡張パーツ情報と拡張構成情報を引き継ぎます。 

系統-02 

系統-01 系統-01 

パイプ パイプ以外の配管部品 

系統-01 
パイプ 

系統-01 

パーツ情報_A 

構成情報_A 

パイプ 

パイプ 
 

構成情報_A 

パイプ以外の配管部品 

G3456 G3452 
系統-01 

部品 
系統-01 

パーツ情報_A 

構成情報_A 

部品 

構成情報_A 

ライブラリの

パーツ情報 

パイプ：拡張構成情報だけ引き継ぎます。 

部 品：拡張構成情報は引き継いで、拡張パーツ情報は 
    ライブラリの情報が付加されます。 

BW SW 

系統-01 

パイプ 

部品 
パーツ情報_B 

構成情報_B 

パーツ情報_A 

構成情報_A 

パイプ：拡張構成情報だけ引き継ぎます。 
部 品：拡張構成情報は引き継いで、拡張パーツ情報は 
    ライブラリの情報が付加されます。 
締結品：拡張構成情報は引き継いで、拡張パーツ情報は 
    ライブラリの情報が付加されます。 

締結品 
パーツ情報_C 

構成情報_C 

系統-01 

パイプ 

部品 

構成情報_B 

 

構成情報_A 

ライブラリの

パーツ情報 

締結品 

構成情報_C 

ライブラリの

パーツ情報 

パイプ パイプ以外の配管部品 締結品 

ルール 1 ルール 2 

 [配管]－[配管編集]－ (系統追加する) 

  <T>[配管設計] <C>[配管編集] <D>[系統追加] 

 [配管]－[仕様変更]－ (部品の仕様変更をする) 

  <T>[配管設計] <C>[仕様変更] <D>[部品] 

  <T>[配管設計] <C>[仕様変更] 
<D>[系統] [ルール変更] 



第 1 章 配管設計を始める前に 
 

8 

 

1-2-4 サンプルファイル 
本マニュアルの『2-3. 配管ルールの読み込み』から『2-4. 配管ルールの操作』までの手順で作成されるルールファイルを、

サンプルファイルとして用意しています。 
 

サンプルファイルを使用する場合は、ルールフォルダ("iCAD SX インストールフォルダ¥PDS¥SYS¥RULE") に"SAMPLE" フォ

ルダを作成し、ファイルをコピーしてください。 

【サンプルファイル】 
  フォルダ：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
  ファイル名：tutorial-sample_rule.csv 

【ルールフォルダ】 
  フォルダ：iCAD SX インストールフォルダ¥PDS¥SYS¥RULE 

 
『2-3. 配管ルールの読み込み』から『2-4. 配管ルールの操作』までの手順に沿って操作する場合は、サンプルファイルのコ

ピーは不要です。 
 
  

系統-01 

パイプ 

部品 
パーツ情報_B 

構成情報_B 

パーツ情報_A 

構成情報_A 

パイプ：拡張構成情報だけ引き継ぎます。 
部 品：拡張構成情報は引き継いで、拡張パーツ情報は 
    ライブラリの情報が付加されます。 

系統-01 

パイプ 

部品 

構成情報_B 

 

構成情報_A 

ライブラリの

パーツ情報 50A 32A 

パイプ パイプ以外の配管部品 

 [配管]－[仕様変更]－ (呼び径変更する) 

  <T>[配管設計] <C>[仕様変更] <D>[呼び径変更] 



第 2 章 配管ルール 
 

9 

第2章 配管ルール 

2-1. 配管ルール概要 
配管ルールとは、配管設計の系統内で利用する部品の仕様をルール化する機能です。 
「配管ルール」を使用すると、以下のことができます。 
 配管部品を配置するときに、配置先のパイプの呼び径に一致する部品の仕様を自動的に選択⇒例 1 
 系統の呼び径を変更すると、系統内の配管部品の仕様を自動的に変更⇒例 2 など 

 

例 1) パイプに部品を配置 

パイプに部品を配置する場合、「配管ルール」を参照して配置先のパイプの呼び径に一致する部品を配置します。 

 

 

例 2) 系統の呼び径を変更 

系統の呼び径を変更する場合、「配管ルール」を参照して変更後の呼び径に一致する部品に変更します。 

 
 

 

配管ルール 

接続形式：BW 

タイプ：丸型 

規格番号：B2312 

接続形式：SCRD 

タイプ：Ｉ形 

規格番号：B2301 

キャップ 
15A～40A 50A～150A 

B2312 B2301 

B2312 

B2301 65Ａ 

40Ａ 

パイプにキャップを配置 

配管部品ライブラリ 

B2312 B2316 

系統の呼び径を 32Ａから 50Ａに変更 

32Ａ 50Ａ 

 
配管ルール 

接続形式：BW  
規格番号：B2312 

接続形式：SW 
規格番号：B2316 

ティー 
15A～40A 50A～80A 

配管部品ライブラリ 

B2312 B2316 



第 2 章 配管ルール 
 

10 

 注意 
「配管ルール設定ツール」は Microsoft Excel (以下、「Excel」という。) がインストールされている環境で使用してくださ

い。 
Excel のバージョンは、『動作環境および入出力データ』をご確認ください。 

2-2. 「配管ルール設定ツール」の起動設定 
iCAD SX から「配管ルール設定ツール」を起動できるように設定します。 

 

1. 「アプリ実行」ダイアログボックスを表示します。 
(1) 以下のコマンドを選択 

 [ツール]－[その他]－ (アプリ実行する) 

 <T>[ツール] <C>[アプリ実行] <D>[実行] 

⇒ 「アプリ実行」ダイアログボックスが表示されます。 
 

2. 「アプリ実行」ダイアログボックスのアプリボタンに「配管ルール設定ツール」を登録します。 

2.1 「登録アプリ設定」ダイアログボックスを表示します。 

(1) [登録アプリ] の空白ボタンを右クリックし、[設定] を選択 

 

⇒ 「登録アプリ設定」ダイアログボックスが表示されます。 
 

2.2 「登録アプリ設定」ダイアログボックスで、アプリボタンのタイトルを入力します。 

(1) [タイトル] を入力 

 
- タイトル：配管ルール *任意 

 右クリック 



第 2 章 配管ルール 
 

11 

 注意 
[タイトル] は、全角 5 文字、半角 10 文字以内です。 

 

2.3 実行ファイルを指定します。 

(1) [参照] ボタンをクリック 

⇒ 「実行ファイルを選択」ダイアログボックスが表示されます。 
 

(2) 「実行ファイルを選択」ダイアログボックスで、ファイルを指定 

 
- 実行ファイルの場所：iCAD SX インストールフォルダ¥PDS¥ETC 
- ファイルの種類：All Files (*.*) 
- ファイル名：配管ルール設定.xls 

(3) [開く] ボタンをクリック 
 

2.4 実行アプリを登録します。 

(1) 「登録アプリ設定」ダイアログボックスで、[実行] ボタンをクリック 
 

⇒ アプリボタンに「配管ルール設定ツール」が登録されます。 

  

① 

② 



第 2 章 配管ルール 
 

12 

2-3. 配管ルールの読み込み 
「配管ルール設定ツール」で既存の配管ルールを読み込みます。 

 
1. 「配管ルール設定ツール」を起動します。 

(1) 以下のコマンドを選択 

 [ツール]－[その他]－ (アプリ実行する) 

 <T>[ツール] <C>[アプリ実行] <D>[実行] 

(2) 「アプリ実行」ダイアログボックスで、「配管ルール」をクリック 

 

⇒ Excel が起動します。 

 補足 
「アプリ実行」ダイアログボックスに「配管ルール設定ツール」を登録する方法は、『2-2.「配管ルール設定ツール」の起動

設定』を参照してください。 

 
2. Excel 起動時にセキュリティ警告が表示された場合は、マクロを有効にします。 

 注意 
「配管ルール設定ツール」は、Excel のマクロを使用しています。マクロが無効になっていると「配管ルール設定ツール」

が動作しません。 

 
3. 「DEFAULT」のルールを読み込みます。 

(1) 「ルールグループ名」と「ルール名」を選択 
- ルールグループ名：DEFAULT 
- ルール名：DEFAULT 

 
 
 
 
 

(2) 「配管ルール設定」メッセージボックスで、[はい] ボタンをクリック 

 

⇒ 「DEFAULT」のルールが読み込まれます。 



第 2 章 配管ルール 
 

13 

2-4. 配管ルールの操作 

2-4-1 「配管ルール」の編集 
読み込んだ「DEFAULT」のルールを元に、配管ルールを編集します。 
ここでは、「エルボ」の径範囲を 2 つに分けて、径範囲ごとの仕様を設定します。 

 
1. 「ルールグループ名」と「ルール名」を入力します。 

ルールグループ名：SAMPLE 
ルール名：tutorial-sample 

 
 
 
 
 
 

 注意 
「ルールグループ名」と「ルール名」は、半角 24 文字以内で入力してください。 
以下の文字は、使用できません。 
  ¥  /  :  *  ?  "  <  >  |  _  

 
2. 「エルボ」の行を追加します。 

(1) [ELBOW] の行番号を右クリックし、[呼び径を下に追加(ICAD 機能)] を選択

 

 

3. 配管部品の[規格] と[径範囲] を入力します。 

 

 行番号を右クリック 



第 2 章 配管ルール 
 

14 

4. [接続形式] を選択します。 

 
 

5. [スケジュール] と[材質] を選択します。 

 
 

6. [エルボタイプ] を選択します。 

 
 

7. [規格番号] を入力します。 

 

 補足 
配管部品ライブラリで該当する部品仕様が、各項目のコンボボックスに表示されます。 
項目に部品仕様を設定すると、ほかの項目に表示される選択肢が絞り込まれます。 
呼び径範囲ごとに利用する配管部品ライブラリの部品が、1 部品に絞り込まれるまで項目を選択してください。 

 補足 
「VALVE」の[タイプ] は必須項目です。[タイプ] ごとに径範囲を詳細設定します。 

 補足 
[REMARK] に設定した内容が、配管部品のパーツコメントに設定されます。 

 注意 
設定する項目は、配管部品の種類や登録内容によって異なります。 
空欄の項目も、コンボボックスを確認し、設定もれがないかチェックしてください。 

 

  

設定もれを確認 



第 2 章 配管ルール 
 

15 

2-4-2 規格チェック 
仕様を設定した配管部品が、配管部品ライブラリに存在するかをチェックします。 

 
1. チェックする配管部品の行のセルを選択します。 

(1) [ELBOW] の行のセルを選択 

 
 

2. 設定した内容をチェックします。 
(1) [規格チェック] ボタンをクリック 

 

⇒ 「チェック結果」メッセージボックスが表示されます。 
 

「チェック結果」について 
 

正常に設定された場合 

設定した仕様に一致する配管部品が、配管部品ライブラリに存在するときに表示されます。 

 
 

該当部品は存在するが、呼び径が一致しない場合 

設定した[径範囲] が、配管部品ライブラリにある配管部品の径範囲と一致しないときに表示されます。 
メッセージボックスに表示された範囲内で[径範囲] を設定してください。 

 



第 2 章 配管ルール 
 

16 

設定内容に一致する部品が存在しない場合 

設定した仕様を満たす配管部品が存在しないときに表示されます。 
設定した仕様を確認してください。 

 
 

ルール設定の範囲外で「規格チェック」を行った場合 

ルール設定の範囲外のセルで「規格チェック」を行ったときに表示されます。 
以下の赤枠内のいずれかのセルを選択してください。 

 
 

 

 注意 
以下のコマンドで「エルボ」を挿入する場合、「ロングエルボ」が優先して挿入されます。 

 [配管]－[経路作成]－ (配管作成する) 
 <T>[配管設計] <C>[配管作成] 

ルールや呼び径を変更した場合は、「エルボ」は変更前の「ロングエルボ/ショートエルボ」を引き継ぎます。 
変更後のルールに定義されている「エルボ」の曲げ半径が、「ロングエルボ/ショートエルボ」のどちらかしか配管部品ライ

ブラリに存在しない場合、存在する方のエルボタイプに変更されます。 



第 2 章 配管ルール 
 

17 

2-4-3 「配管ルール」の作成 
設定した内容をチェックして、「ルールファイル」を作成します。 

 
1. 「ルールグループ名」と「ルール名」を確認します。 

 
 

2. 規格チェックを実行して、「ルールファイル」を作成します。 
(1) [ルールファイル作成] ボタンをクリック 

 

⇒ 「配管ルール設定」メッセージボックスが表示されます。 
 

(2) 「配管ルール設定」メッセージボックスで、[はい] ボタンをクリック 

 

⇒ 「ルールファイル」が以下のフォルダに作成されます。 
保存先：iCAD SX インストールフォルダ¥PDS¥SYS¥RULE¥SAMPLE 
ファイル名：tutorial-sample_rule.csv 

 補足 
「配管ルール設定」メッセージボックスで[はい] を選択して規格チェックを実行した結果、呼び径や部品が配管部品ライ

ブラリの部品に該当しない場合は「チェック結果」メッセージボックスが表示されます。「チェック結果」メッセージボッ

クスが表示された場合も「ルールファイル」は作成されます。 
[いいえ] を選択すると、規格チェックを行わずに「ルールファイル」を作成します。 

 補足 
「ルールファイル」の保存先とファイル名 
  保存先：iCAD SX インストールフォルダ¥PDS¥SYS¥RULE¥(ルールグループ名) 
  ファイル名：(ルール名)_rule.csv 



第 2 章 配管ルール 
 

18 

2-4-4 「配管ルール」の行追加と行削除について 
配管部品の種類および呼び径の追加や削除は、「ICAD 専用機能」を使用します。 

 

呼び径を追加する場合 

追加する行番号で右クリックして、[呼び径を上に追加(ICAD 機能)] または[呼び径を下に追加(ICAD 機能)] を選択 

 
 

呼び径を削除する場合 

削除する行番号で右クリックして、[呼び径削除(ICAD 機能)] を選択 

 
 

その他部品を追加する場合 

追加する行番号で右クリックして、[種類行追加(ICAD 機能)] を選択 

 
 

その他部品を削除する場合 

削除する行番号で右クリックして、[種類行削除(ICAD 機能)] を選択 

 
  



第 2 章 配管ルール 
 

19 

2-5. 「ルール」の管理 
「ルール」の管理方法について説明します。 

2-5-1 ファイル構成 

 

 注意 
「ルールグループ」や「ルール」を変更や削除した場合、配管部品を配置している図面でルールが参照できなくなることが

あります。 

 注意 
"RULE" フォルダ配下の「DEFAULT」のルールグループおよびルールは、編集や削除をしないでください。 

2-5-2 「ルールグループ」「ルール」の変更 
「ルールグループ」や「ルール」を変更するには、エクスプローラーで以下の操作を行います。 

 

「ルールグループ」名を変更する場合 

(1) 「ルールグループ」フォルダ名を変更 
 

「ルールグループ」を削除する場合 

(1) 「ルールグループ」フォルダを削除 
 

「ルール」が属する「ルールグループ」を変更する場合 

(1) 「ルール」ファイルを、変更する「ルールグループ」フォルダに移動 
 

「ルール」名を変更する場合 

(1) 「ルール」ファイル名を変更 
- ルール名：(ルール名)_rule.csv 

 

「ルール」を削除する場合 

(1) 「ルール」ファイルを削除 

 補足 
「ルール」の内容は「配管ルール設定ツール」の起動時に反映されます。「配管ルール設定ツール」を起動中に「ルールグ

ループ」フォルダや「ルール」ファイルを変更した場合は「配管ルール設定ツール」を再起動してください。 

iCAD SX インストールフォルダ 

PDS 
ETC 
SYS 

RULE 
DEFAULT 

DEFAULT_rule.csv 

･
･
･ 

ルールグループ 

ルール (ルールファイル) 

ルールグループ名 

ルール名 



第 2 章 配管ルール 
 

20 

2-6. 「締結部品」のルール設定 
ボルト、ナット、ワッシャーの「締結部品」のルール設定について説明します。 

 

 注意 
「締結部品」は、配管部品ではありません。ルールに従って配置できますが、配置後に配管部品の仕様を変更した場合、

「締結部品」は削除されます。 
 

 

締結品のルール設定 

規格 ： 規格名称を選択します。 
※"iCAD SX インストールフォルダ¥PDS¥SYS¥PARTS_SPEC" 配下の規格フォルダが、コンボボッ

クスに表示されます。 

ねじ ： ねじ切りのタイプを選択します。 
 - M：メートルねじ 
 - UNC：ユニファイねじ 

ボルトタイプ ： ボルトのタイプを選択します。 
 - マシンボルト 
 - スタッドボルト 

部品名 ： ボルト、ナット、ワッシャーの部品名を入力します。 

材質 ： 「材料記号」(システムに登録されている材質) を入力します。 

レイヤ ： 締結品を作成するレイヤ(1～255 の整数値) を入力します。 

出代 ： ボルトに必要な出代の係数を整数値で入力します。 
※実際の出代の長さは、ここで入力した「出代」×「配置するボルトのピッチ」になります。 

個数 ： NUT、WASHER の個数を入力します。 
 - NUT：1～2 
 - WASHER：0～2 

REMARK ： ここで入力した内容が、締結部品のパーツコメントに設定されます。 

 補足 
ボルトのピッチについては、『3-7-4 「締結部品」の登録』を参照してください。 

  

呼び径 50A 呼び径 32A 

締結品 締結品が削除される 呼び径 

変更 



第 2 章 配管ルール 
 

21 

2-7. 補足情報設定表 
配管仕様に応じた試験項目をルールごとに設定できます(最大 20 項目)。 

 

 
 
  

補足情報設定表 



第 3 章 配管部品登録 
 

22 

第3章 配管部品登録 

3-1. 配管部品登録について 
配管設計システムでは、JIS 規格と JPI 規格に準拠した配管部品を配管部品ライブラリに用意しています。 
それ以外の配管部品を使用する場合は、部品形状や仕様、属性などを設定した「利用者部品」として登録します。 

 
ここでは、「利用者部品」を登録する前の事前準備、登録、編集方法を説明します。 

3-1-1 配管部品ライブラリ 
配管部品ライブラリは、以下のフォルダです。 

フォルダ：iCAD SX インストールフォルダ¥PDS¥SYS¥PARTS_SPEC¥(規格名)¥(配管部品の種類) 
 

利用者部品の格納場所 

利用者部品は、配管部品ライブラリ配下に「規格」フォルダを作成して登録してください。 
パラメトリック登録の有無や配管部品の種類によってフォルダ構成が異なります。 
以下は、配管部品ライブラリのフォルダ構成例です。 

 

配管部品ライブラリのフォルダ構成例 

 

 注意 
"JIS-SYS" "JPI-SYS" フォルダは、レベルアップインストールや修正プログラムをインストールすると上書きされますの

で、これらのフォルダに部品を登録しないでください。 

PARTS_SPEC 

JIS-SYS 

U-BOSS 
U-BOSS@3DPARAM.csv 

U-BOSS@3DPARAM.icd 

U-BOSS_symbol.icd 
分岐品.csv 
分岐品_U-BOSS.csv 

JPI-SYS 

BRANCH 

JIS 

部品寸法表インデックスファイル 

部品寸法表ファイル 

パラメトリックパターンファイル 

パラメトリック部品ファイル 

配管シンボルファイル 

「規格」フォルダ(利用者部品) 

パイプ.csv 
パイプ_USR001.csv 

PIPE 
部品寸法表インデックスファイル 

部品寸法表ファイル 

 

EL45_symbol.icd 

EL45.csv 
EL45_U-EL.csv 

EL45 
USR1 

SCT-EL45_50A.icd 利用者部品モデル図面ファイル 

「規格」フォルダ(利用者部品) 

部品寸法表インデックスファイル 

部品寸法表ファイル 

配管シンボルファイル 

パラメトリック登録した配管部品 

パイプ部品 

パラメトリック登録していない配管部品 

配管部品ライブラリ 

JIS 規格準拠 

JPI 規格準拠 

配管部品ライブラリ 



第 3 章 配管部品登録 
 

23 

 補足 
配管設計システムのフォルダやファイルの構成は、『1-1-2 フォルダ構成』を参照してください。 
「部品寸法表インデックスファイル」と「部品寸法表ファイル」の詳細は、『第 5 章 部品仕様ファイル』を参照してくださ

い。 

3-1-2 登録の流れ 
配管部品は、以下の流れに沿って登録します。 

 
 

 

部品仕様ファイルの設定 

「部品寸法表インデックスファイル」と「部品仕様ファイル」に部品仕様を設定します。 

「規格」の作成 

「規格」フォルダを作成して、既存の配管部品仕様ファイルをコピーします。 
※既に規格が存在する場合、フォルダの作成は不要です。 

パイプ部品 

部品形状モデルの作成 

部品形状モデルを作成します。 

配管部品の属性設定 

部品形状モデル(またはパラメトリック部品) に属性を設定して、配管部品として登録します。 

「部品中心線」と基準点位置の設定 

部品形状モデルに「部品中心線」を作成し、基準点の位置を設定します。 

パラメトリック条件の定義 

部品形状モデルに寸法を作成し、パラメトリック条件を設定します。 

「部品寸法表ファイル」に仕様の設定 

「部品寸法表ファイル」に仕様を設定します。 

パラメトリック部品の登録 

パラメトリック条件と「部品中心線」を設定した形状モデルをパラメトリ

ック部品登録します。 

パターンファイルの設定 

パラメトリック部品のパターンファイルを設定します。 

配管部品ライブラリに登録 
パラメトリック部品 呼び径ごとの部品 



第 3 章 配管部品登録 
 

24 

事前準備 

配管部品を登録する前に、以下の準備が必要です。 
 

部品登録体系の決定 

登録する配管部品の以下の体系を決めます。 
 規格名称 
 配管部品種類 
 規格番号 
 タイプ、区分 1、区分 2 

詳細は、『3-2. 部品登録体系の決定』を参照してください。 
 

部品属性項目の選択肢の編集 

部品属性を設定する「利用者部品登録」ダイアログボックス内のプルダウンメニューに表示される選択肢を編集します。 
詳細は、『3-3. 配管部品属性の設定(「利用者部品登録」ダイアログボックス)』を参照してください。 

3-1-3 配管部品登録の留意事項 
配管部品は、以下の内容を留意して登録してください。 

 

配管部品形状モデル 

配管部品に登録する形状モデルは、パーツ化しないでください。 
配管部品に「パーツ付加情報」を設定する場合は、利用者部品登録後に「パーツ付加情報」を設定し、以下のコマンドで保

存します。 

 <T>[ファイル] <C>[上書き保存] 

 

「部品中心線」と基準点位置 

配管部品の種類ごとに「部品中心線」と基準点位置の作成規則があります。 
作成規則の詳細は、『3-4. 「部品中心線」と基準点』を参照してください。 

 

登録時の表示状態 

配管部品は、部品登録時の表示状態で配置されます。 

 
 

配管部品の仕様の登録 

部品仕様ファイルに配管部品の仕様を登録するときは、以下の点に注意してください。 
 「仕様識別子」「規格番号」「部品規格識別子」は、半角英数 14 文字以内で入力してください。 
 「仕様識別子」と「部品規格識別子」は同じ名称にしてください。 
 [材質] は、iCAD SX で登録されている「材料記号」を入力してください。登録されていない材質を使う場合は、事前に

iCAD SX で材質を登録してください。 
[材質] の登録方法は、iCAD SX のヘルプを参照してください。 

 
部品仕様ファイルの詳細は、『第 5 章 部品仕様ファイル』を参照してください。 

 

CG 表示で登録した場合 ワイヤ表示で登録した場合 

部品登録時 部品配置時 部品登録時 部品配置時 



第 3 章 配管部品登録 
 

25 

「利用者部品登録」ダイアログボックス 

配管部品の種類によって、ダイアログボックスに表示される項目が異なります。 
また、プルダウンメニューの選択肢には「部品登録用情報テーブル」に登録されている内容が表示されます。 
詳細は、『3-3. 配管部品属性の設定(「利用者部品登録」ダイアログボックス)』を参照してください。 

 補足 
パラメトリック部品に登録できない形状(ソリッド形状など) は、呼び径ごとの部品形状を作成して配管部品を登録してく

ださい。呼び径ごとの配管部品登録の方法は『3-6-1 呼び径ごとの配管部品登録』を参照してください。 

3-2. 部品登録体系の決定 
配管部品を登録する前に、どのような体系で登録するかを決定してください。 
部品体系の内容は、以下のとおりです。 

 

規格名称 

JIS、JPI、社内規格などの規格名やメーカー名などの名称を利用してください。 
(半角英数 8 文字以内) 

 

配管部品種類 

本システムでは以下の部品種類を用意しています。該当する種類があれば、その種類で登録してください。 

エルボ / ティー / キャップ / レデューサ / フランジ / バルブ / Y 型 / X 型 / ユニオン / ソケット / ガスケット / 
分岐品 / ニップル / フルカップリング 

 
該当する部品種類がない場合は、任意の部品名称で登録できます。 

 

規格番号 

配管部品には多くの種類があり、同じ仕様を持つ部品が複数存在することがあります。 
「規格番号」とは、それらの配管部品を整理するための番号です。 
「規格番号」が明確でない場合は、以下の条件を参考にして決めてください。 

「規格番号」の条件 
- 大まかな分類を表すこと 
- 同じ「規格番号」内に、[種類] [呼び圧] [スケジュール] [接続形式] など、仕様すべてが同じものは存在しないこと 

(JIS、JPI 規格の「規格番号」は、この条件を満たしています) 

 重要 
メーカー品の場合、型式番号が「規格番号」に近い役割を持っていますが、呼び径ごとに型式番号が分かれるなど詳細に区

別されているため、「規格番号」には適していません。 

ただし、型式の一部に「規格番号」に相当する情報が含まれていることがあります。 
 
例) 型式が「HGB11-ES50」の場合 

   

このような場合、「HGB11」を「規格番号」に採用できます。 

 
  

HGB11 ： 部品の大きな分類 
E ： エルボ 
S ： ショート 

50 ： サイズなどの仕様 
 



第 3 章 配管部品登録 
 

26 

タイプ、区分 1、区分 2 の決定 

同じ部品種類で仕様が違う部品は、[タイプ] [区分 1] [区分 2] で区別します。 
[タイプ] [区分 1] [区分 2] は「規格参照」ダイアログボックスに表示されます。 

 
例えば、JIS 規格 B2301 のユニオンは、以下のような体系で分類されています。 

 

 補足 
「バルブ」「ガスケット」「分岐品」の場合、「タイプ」には以下の形状分類を設定します。 
  バルブ：「玉形弁」「ボール弁」など 
  ガスケット：「全面形」「シート」「渦巻き」など 
  分岐品：「ボス」「オーレット」「ハーフカップリング」など 

3-3. 配管部品属性の設定(「利用者部品登録」ダイアログボックス) 
配管部品として登録する場合、「利用者部品登録」ダイアログボックスで属性を設定します。 
「利用者部品登録」ダイアログボックスは、以下のコマンドで表示します。 

 [配管]－[部品登録]－ (配管部品を登録する) 

 <T>[配管設計] <C>[部品登録] <D>[属性設定] 

 

 
 
 
 
 

タイプ 

区分 1 

ユニオン 

C1 形 C2 形 F 形 C 形 F 形 

I 形 II 形 タイプ ： I 形 / II 形 

区分 1 ： C1 形 / C2 形 / F 形 / C 型 



第 3 章 配管部品登録 
 

27 

 注意 
部品形状に属性を設定して配管部品として登録する場合、「部品中心線」と基準点位置の設定が必要です。 
「部品中心線」と基準点位置の詳細は、『3-4. 「部品中心線」と基準点』を参照してください。 

※以下のコマンドを選択して、メッセージが表示された場合は、「部品中心線」と基準点位置を確認してください。 

 [配管]－[部品登録]－ (配管部品を登録する) 
 <T>[配管設計] <C>[部品登録] <D>[属性設定] 

 
 

3-3-1 「利用者部品登録」ダイアログボックスと「部品登録用情報テーブル」 
「利用者部品登録」ダイアログボックス内項目の選択肢が登録されているファイルを「部品登録用情報テーブル」といいま

す。 
「部品登録用情報テーブル」は、"iCAD SX インストールフォルダ¥PDS¥SYS¥PARTS_SPEC" フォルダ配下にあります。 

 
以下は、「利用者部品登録」ダイアログボックス内項目の概要です。 

項目名 内容 使用できる文字数 部品登録用情報テーブル 
種類 配管部品種類を選択/入力 半角 24 文字/全角 12 文字以内 － 

タイプ 部品を分類する場合に入力 半角 16 文字/全角 8 文字以内 STAND_TYPE.csv 

規格名称 利用者部品を登録する規格名称を選択 半角 8 文字/全角 4 文字以内 STAND_TBL.csv 

規格番号 規格番号を選択/入力 半角 14 文字以内 － 

フェイス フェイス種類を選択 半角 8 文字/全角 4 文字以内 STAND_FACE.csv 

呼び圧力 呼び圧力を選択 半角 16 文字/全角 8 文字以内 STAND_PRESSURE.csv 

スケジュール スケジュールを選択 半角 8 文字/全角 4 文字以内 STAND_SCHEDULE.csv 

区分 1 / 区分 2 [タイプ] など以外で区別する場合に入力 半角 16 文字/全角 8 文字以内 － 

材質(記号) 配管部品仕様を識別するための材質を選択 半角 16 文字/全角 8 文字以内 STAND_MATERIAL.csv 

接続形式 接続形式を選択 半角 8 文字/全角 4 文字以内 STAND_CONNECT.csv 

呼び径 配管部品の呼び径を選択/入力 － － 

図面名称(品番) 登録する配管部品の図面名を入力 半角 40 文字/全角 20 文字以内 － 

部品タイトル 登録する配管部品名を入力 半角 40 文字/全角 20 文字以内 － 

形状識別子 形状の識別子を選択 － － 
 

 
 

「利用者部品登録」ダイアログボックス 
例） 

[スケジュール] の

プルダウンメニュー 
「部品登録用情報テーブル」の

内容を参照している項目 



第 3 章 配管部品登録 
 

28 

「利用者部品登録」ダイアログボックス内の[タイプ] [規格名称] [フェイス] [呼び圧力] [スケジュール] [材質(記号)] [接続形式] 
のプルダウンメニューには、あらかじめシステムが用意している「部品登録用情報テーブル」に登録された内容が表示され

ます。 
 

システムが用意している以外の内容を使用する場合は、「部品登録用情報テーブル」で編集できます。 
「部品登録用情報テーブル」の編集方法は、『3-3-2 「部品登録用情報テーブル」の編集方法』を参照してください。 
「利用者部品登録」ダイアログボックスの項目と「部品登録用情報テーブル」各ファイルの詳細は以下のとおりです。 

 

種類 

配管部品の種類を選択/入力します。 
 

本システムで用意している部品種類は以下のとおりです。該当する種類があれば、その種類を選択してください。 

エルボ / ティー / キャップ / レデューサ / フランジ / バルブ / Y 型 / X 型 / ユニオン / ソケット / ガスケット / 
分岐品 / ニップル / フルカップリング 

 
該当する部品種類がない場合は、任意の部品名称を入力できます(半角 24 文字、全角 12 文字以内)。 

 補足 
任意の部品名称で登録した配管部品の種類は、「その他」になります。 

 

タイプ 

部品を[タイプ] で分ける場合に選択/入力します(半角 16 文字、全角 8 文字以内)。 
 

以下は[タイプ] の例です。 

配管部品の種類 タイプ 
エルボ / ティー / キャップ / レデューサ / Y 型 / X 型 / ユニオン / ソケット 「Ⅰ形」「Ⅱ形」など 
バルブ 「玉形弁」「逆止弁」「仕切弁」など 
ガスケット 「リング」「渦巻き型」など 

部品登録用情報テーブル：STAND_TYPE.csv 
 

「利用者部品登録」ダイアログボックスで直接入力して部品登録すると、「STAND_TYPE.csv」ファイルが自動的に作成

されます。 
ファイルが存在しない場合は、「SYS_STAND_TYPE.csv」ファイルをコピーし、ファイル名を「STAND_TYPE.csv」に変

更して編集してください。 
 

規格名称 

利用者部品を登録する[規格名称] を選択します。 

部品登録用情報テーブル：STAND_TBL.csv 
 

「STAND_TBL.csv」ファイルは、以下のコマンドを初回実行したときに自動的に作成されます。 

 [配管]－[経路作成]－ (配管作成する) 

 <T>[配管設計] <C>[配管作成] 

ファイルが存在しない場合は「SYS_STAND_TBL.csv」ファイルをコピーし、ファイル名を「STAND_TBL.csv」に変更し

て編集してください。 
  



第 3 章 配管部品登録 
 

29 

(1) A 列：規格名通し番号(重複しない番号を入力) 
(2) B 列：規格名称(「利用者部品登録」ダイアログボックスの[規格名称] で表示する名称) 

 

 注意 
「規格名
The file is too long and its contents have been truncated.


### assistant  

ナイスです。その PDF（pipe_manual）はまさに “正解のマニュアル” でした。要点だけ掴んで、ズレないCSVを一発で作る手順とスクリプトを出します。

# まず押さえるべき仕様（マニュアル根拠）

- 登録は「部品仕様ファイル（2種）」で決まります  
  1) **部品寸法表インデックス**（規格番号や材質などの一覧）→コレから  
  2) **部品寸法表**（呼び径ごとのモデル名や寸法）→今回のCSVが該当。fileciteturn4file0L8-L18

- CSVの基本構造  
  1行目: 「部品種類, 部品名称,（規格名称 規格番号）」  
  1～5行目: システム予約（編集しない）  
  6～9行目: ユーザ自由欄  
  10行目以降: 仕様データ（**縦持ち**）  
  末尾カラムに**「利用者部品のモデル名」**（図面名 or パラメ部品フォルダ）を置く。列順は入れ替えない。fileciteturn4file2L30-L36 fileciteturn4file2L11-L15 fileciteturn4file3L34-L36

- データ列  
  「呼び径A」「呼び径B」「利用者部品のモデル名」。呼び径は**大きい方を先**、複数ある場合は「x」で連結（例: 300Ax250A）。fileciteturn4file2L56-L64 fileciteturn4file3L1-L6

- 文字数など  
  規格番号は**半角14文字以内**。呼び径 A/B は**最大14文字**。fileciteturn3file0L14-L15 fileciteturn4file2L55-L61

- 登録先フォルダと注意  
  ライブラリは `…\PDS\SYS\PARTS_SPEC\(規格名)\(部品種類)`。**JIS-SYS/JPI-SYS 直下に登録しない**（上書きされるため）。fileciteturn3file4L48-L59 fileciteturn4file4L49-L57

---

# 「ズレない」CSVをDownloadsに一発生成（PowerShell）

Excelで列ズレしやすい原因は、**改行(CRLF)や文字コード**、**カンマのクォート**不足が多いです。下のスクリプトは **CP932(Shift-JIS)**、**CRLF**、**全フィールドを二重引用符で囲む** で出力します。  
（3ファイルとも **縦持ち・モデル名は最後**、各ファイルに**5行のパーツ**が入ります）

> 作られるファイル  
> `チーズ_SS.csv`（一方ショート）／`チーズ_SS_RN.csv`（一方ショート×ローネック）／`チーズ_DS_RN.csv`（両方ショート×ローネック）

```powershell
# --- ここから貼り付け ---
$enc = [System.Text.Encoding]::GetEncoding(932)
$DL = [Environment]::GetFolderPath('UserProfile') + '\Downloads'

function Out-ICADCsv($path, $partName, $rows){
  $w = New-Object System.IO.StreamWriter($path,$false,$enc)
  try{
    # 1～9行（マニュアル準拠）
    $w.WriteLine('チーズ,"{0} USER_PART"',$partName)  # 1行目: 部品種類, 部品名称 規格名称 規格番号
    $w.WriteLine('システム行1～5行目はシステムリザーブです')
    $w.WriteLine('システム行: 既定システムが使用していますので、D / E / F列を使用しないでください')
    $w.WriteLine('システム行: システムリザーブ')
    $w.WriteLine('システム行: システムリザーブ')
    $w.WriteLine('ユーザ行 6～9行目は利用者開放領域です')
    $w.WriteLine('ユーザ行: 自由に御利用下さい')
    $w.WriteLine('ユーザ行')
    $w.WriteLine('ユーザ行')
    # 見出し
    $w.WriteLine('"呼び径Ａ","呼び径Ｂ","利用者部品のモデル名"')
    # データ本体（全フィールドをクォート）
    foreach($r in $rows){ $w.WriteLine('"{0}","{1}","{2}"' -f $r[0],$r[1],$r[2]) }
  } finally { $w.Close() }
}

# 1) 一方ショートチーズ（同径5種）
$rows1 = @(
  @('1S','1S','一方ショートチーズ_1S-1S'),
  @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
  @('2S','2S','一方ショートチーズ_2S-2S'),
  @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
  @('3S','3S','一方ショートチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_SS.csv') '一方ショートチーズ' $rows1

# 2) 一方ショート×ローネック（異径5種）
$rows2 = @(
  @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_SS_RN.csv') '一方ショート×ローネックチーズ' $rows2

# 3) 両方ショート×ローネック（異径5種）
$rows3 = @(
  @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_DS_RN.csv') '両方ショート×ローネックチーズ' $rows3
# --- ここまで ---
```

> これで Downloads に3ファイルが並びます。Excelで開くと  
> 1行目=「チーズ,（部品名 規格番号）」→10行目=見出し→11行目から5本のデータ、という**右の元CSVと同じ“縦持ち＋モデル名が最後”構造**になっています。

---

## 仕上げのチェックポイント

- **列見出しの文字**：「呼び径Ａ」「呼び径Ｂ」「利用者部品のモデル名」—列順を入れ替えないこと。fileciteturn4file3L34-L36  
- **呼び径の並び**：大→小、複数は「x」連結（今回の例は “1S-1.5S”等）。fileciteturn4file2L56-L64  
- **文字数制限**：規格番号 14文字以内。fileciteturn3file0L14-L15  
- **登録場所**：`…\PARTS_SPEC\(自社規格)\チーズ\` に配置。JIS-SYS/JPI-SYSは編集禁止。fileciteturn4file4L49-L57  
- **件数上限**：同一規格・同一部品種類で**最大640個**。超えるなら規格を分割。fileciteturn4file1L33-L37

この形でいけば、iCAD側の「利用者部品登録」→「規格参照」で規格番号を選んだとき、部品仕様ファイルを参照して**自動でモデルを呼び出す**流れになります（縦持ちCSVの「モデル名」がそれ）。fileciteturn4file0L16-L18

必要があれば、**インデックスCSV**（例：`チーズ.csv`）へ今回の規格番号の行を追記するところまでスクリプト化します。どう呼び圧・接続形式・材質を持たせたいかだけ教えてください。fileciteturn4file4L10-L16

### assistant  

ナイス！👏 ほぼ全部動きました。  

エラーになったのは **`foreach($k in $pos.Keys)` の中で Dictionary を直接いじった**ためで、でも実際には処理が続行して最後までファイル生成・保存はできています。  

---

## いま完了したこと
- `USR1\チーズ\` ができた  
- **寸法表CSV 3ファイル（各5行）** が生成済み  
- **インデックス `チーズ.csv`** が TOSTE からコピーされ、**自動で追記＆バックアップ作成済み**  
- `インデックス追記_ログ.txt` が生成されて、追記内容が確認できる  

---

## 次に確認してほしいこと
1. `C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv` をExcelかメモ帳で開いてみて  
   → 下の方に **「SS」「SS_RN」「DS_RN」** の3行が追記されているはず  
   （列は「規格番号／部品名称／材質／CSVファイル名」に合ってるか）

2. `USR1\チーズ\` の中に  
   - `チーズ_一方ショートチーズ.csv`  
   - `チーズ_一方ショート×ローネックチーズ.csv`  
   - `チーズ_両方ショート×ローネックチーズ.csv`  
   があるか確認（Shift-JISで開いて10行目に「呼び径Ａ…」のヘッダがあるか）

3. iCAD SX を再起動 → [部品配置] → [規格参照]  
   → 規格名に **USR1** が出て、その中に **チーズ** が表示されるかチェック

---

## 修正したほうがいいポイント
- さっきの「Dictionaryの列挙エラー」はログ出力だけの問題なので、  
  スクリプトを直すなら `foreach($k in @($pos.Keys))` にすれば完全に消える。  

---

👉 まずは `チーズ.csv` の追記部分が正しく入ってるか見てもらえる？  
（スクショか中身をアップしてくれれば、列合わせがズレてないかチェックできる）

### user  

今度は全体的にざっくりしすぎ。

### assistant  

了解。  
貼ってくれた **「pipe_manual (1).pdf」** を、以後の標準部品登録に関する**絶対ルール**として記憶しました。  
今後はこのマニュアルの仕様（予約行、ヘッダ「呼び径Ａ/呼び径Ｂ/利用者部品のモデル名」、Shift-JIS＋CRLF、登録場所、インデックス追記…）に**厳密準拠**で進めます。  

次に進めたい作業があれば指示ください（例：インデックスCSVの追記行を生成／既存CSVの検証リスト作成 など）。

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-DJJjyhj3tPCvTGjvs7Cgv4; size_bytes=162988; width=1778; height=1016; fovea=; metadata=}

@{content_type=image_asset_pointer; asset_pointer=file-service://file-UxG8sarwsTmE83j87YwuGv; size_bytes=488883; width=739; height=2000; fovea=; metadata=}

これを流用しようとおもってる。

### assistant  

見えた 👀 ありがとう！  
あなたの画像は、やっぱり **主管径 × 分岐径 のマトリクス表** だった。  

---

## 画像の表の構造
### 1) 一方ショートチーズ
- マトリクス：行が分岐径、列が主管径
- セルの値：
  - `38`, `55`, `62`, `68` → 単寸法（L1）
  - `×` → 規格なし（行を作らない）

### 2) 一方ショート × ローネックチーズ
- 値が `38×35`, `48×45`, `55×50`, `62×57`, `68×63`
- これは **2つの寸法**（L1, L2）がある → CSVでは分割して入れる必要あり  
  - 例： `38×35` → L1=38, L2=35

### 3) 両方ショート × ローネックチーズ
- 値が `35×38×35`, `45×48×45`, `50×55×50`, `57×62×57`, `63×68×63`
- これは **3つの寸法**（L1, L2, L3）がある → CSVでは3列化する必要がある  
  - 例： `45×48×45` → L1=45, L2=48, L3=45

---

## 元CSVとの対応付け
- 元の `チーズ_T-8.csv` なども **縦持ちの寸法表** になってたので、  
  → 今回も同じように **「呼び径組合せを1行ずつ書く」形式** に落とし込むのが正解。  

- 例えば「一方ショートチーズ」の場合：
  ```
  呼び径A, 呼び径B, 外径A(mm), 外径B(mm), L1, L2, モデル名
  15A,1S,21.7,21.7,38,0,一方ショートチーズ_15A-1S
  2S,2S,34.0,34.0,55,0,一方ショートチーズ_2S-2S
  ...
  ```

- 「一方ショート×ローネックチーズ」の場合：
  ```
  呼び径A, 呼び径B, 外径A, 外径B, L1, L2, モデル名
  15A,1S,21.7,21.7,38,35,一方Sローネックチーズ_15A-1S
  2.5S,3S,63.5,76.3,62,57,一方Sローネックチーズ_2.5S-3S
  ...
  ```

- 「両方ショート×ローネックチーズ」の場合：
  ```
  呼び径A, 呼び径B, 外径A, 外径B, L1, L2, L3, モデル名
  1S,1.5S,21.7,27.2,35,38,35,両方Sローネックチーズ_1S-1.5S
  2S,2.5S,34.0,42.7,50,55,50,両方Sローネックチーズ_2S-2.5S
  ...
  ```

---

✅ まとめると、あなたの15種類は **「一方ショート＝L1」「一方Sローネック＝L1,L2」「両方Sローネック＝L1,L2,L3」** というパラメータ構造を持っている。  

---

👉 確認したいんだけど、このCSVを **種類ごとに3ファイル（SS, SS_RN, DS_RN）に分ける** 方がいい？  
それとも **1つのCSVに全部まとめて規格番号で区別** する方がいい？

### user  

もう少し日本語で分かりやすい名前がいい

### user  

いったんこれで仮決めで。変更があればまた教える。

### assistant  

いい比較画像ありがとう！  
確かに「右の元CSV（チーズ_D-8_S.csv）」と比べると、**左（新規作ったやつ）のデータ配置がズレている**。  

---

## 違いのポイント

### 元CSV（右）
- 10行目にヘッダ行  
  ```
  呼び径A, 呼び径B, 利用者部品のモデル名
  ```
- 11行目以降にデータ  
  ```
  1.5S, 38.1mm, 溶接ローアームチーズ_1.5S
  1.0S, 25.4mm, 溶接ローアームチーズ_1.0S
  ...
  ```

👉 つまり **「呼び径」と「外径」と「モデル名」** が縦方向に並んでいるだけ。  
外径は数値だけでなく **mm単位を文字列付きで書いている** のも特徴。  

---

### 新規CSV（左）
- データが **横方向に複数列化** している（呼び径・外径・寸法が横に広がっている）  
- モデル名が最後の列に入っている  
- → iCAD標準の形式と違うため、読み込み時にズレが出る  

---

## 修正方針
元CSVと同じように **縦持ち（1行に1レコード）** に揃えるべき。  
- 行構成：  
  ```
  呼び径A, 呼び径B, O.D.A(mm), O.D.B(mm), L1(mm), L2(mm), L3(mm), モデル名
  ```
- 各呼び径組合せごとに **1行にまとめる**  
- モデル名は「一方Sローネックチーズ_1S-1.5S」のように最後の列に置く  

---

## 例：一方ショート×ローネックチーズ
今の「38×35」「48×45」…を縦持ちに直すと：

```
呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),モデル名
1S,1.5S,25.4mm,38.1mm,38,35,一方Sローネックチーズ_1S-1.5S
1.5S,2S,38.1mm,50.8mm,48,45,一方Sローネックチーズ_1.5S-2S
2S,2.5S,50.8mm,63.5mm,55,50,一方Sローネックチーズ_2S-2.5S
2.5S,3S,63.5mm,76.3mm,62,57,一方Sローネックチーズ_2.5S-3S
3S,3S,76.3mm,76.3mm,68,63,一方Sローネックチーズ_3S-3S
```

---

## 提案
いま生成済みの「一方ショート×ローネックチーズ.csv」などを、  
**右の元CSVと同じ構造（縦持ち・モデル名は最後）** に修正し直す PowerShell を書き直す。  

👉 それで良い？  
それとも「元CSVに完全一致（列数・ダミーの空列も含めて）」させるところまでやった方が安心？

### assistant  

了解 👍  
では「元の名前（＝一方ショートチーズ／一方ショート×ローネックチーズ／両方ショート×ローネックチーズ）」に **できるだけ近い形** で、  
かつ **14文字以内** に収める案を作った。  

---

## 命名案（元の名称に極力近い）

| 元の名称                      | 推奨名称（14文字以内） | 文字数 |
|-------------------------------|------------------------|--------|
| 一方ショートチーズ             | 一方Sチーズ           | 7      |
| 一方ショート×ローネックチーズ | 一方Sローネックチーズ | 12     |
| 両方ショート×ローネックチーズ | 両方Sローネックチーズ | 12     |
| ローアームチーズ（もし追加）   | ローアームチーズ      | 8      |

---

### ポイント
- **「ショート」→「S」** に省略して文字数削減  
- 「ローネック」「ローアーム」は省略せず残す（分かりやすさ優先）  
- これで全て **14文字以内に収まる**  

---

## PowerShell生成版（元の名前に近い）

```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
一方Sチーズ,USR010,SUS304,15A,1S,38,0
一方Sチーズ,USR010,SUS304,2S,2S,55,0
一方Sチーズ,USR010,SUS304,2.5S,2.5S,62,0
一方Sチーズ,USR010,SUS304,3S,3S,68,0
一方Sローネックチーズ,USR011,SUS304,1S,1.5S,38,35
一方Sローネックチーズ,USR011,SUS304,1.5S,2S,48,45
一方Sローネックチーズ,USR011,SUS304,2S,2.5S,55,50
一方Sローネックチーズ,USR011,SUS304,2.5S,3S,62,57
一方Sローネックチーズ,USR011,SUS304,3S,3S,68,63
両方Sローネックチーズ,USR012,SUS304,1S,1.5S,35,38
両方Sローネックチーズ,USR012,SUS304,1.5S,2S,45,48
両方Sローネックチーズ,USR012,SUS304,2S,2.5S,50,55
両方Sローネックチーズ,USR012,SUS304,2.5S,3S,57,62
両方Sローネックチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "$env:USERPROFILE\Downloads\チーズ標準部品ひな形.csv"
```

---

👉 これなら「元の名称の雰囲気を維持」しつつ、iCADの14文字制限もクリア。  

質問：この名前で確定してCSV化する？ それとも「ショート」も残して **もう少し長め（ギリギリ14文字）** にするほうが良い？

### assistant  

了解。  
この「絶対ルール（pipe_manual を厳守）」は**このチャットルーム内のみ**で適用します。ほかのチャットや新規会話には影響しません。  
先ほどのグローバル記憶は削除済みです。引き続き、この部屋ではマニュアル準拠で進めます。

### tool  

Model set context updated.

### user  

Excel連携を必ずしたい。

### assistant  

了解。**略称なし**で、日本語のわかりやすいファイル名にして、元CSVの“傾向”（1〜9行のシステム行＋10行目以降に縦持ち寸法表）に沿って **3ファイルをダウンロードフォルダへ一発生成** できる PowerShell を用意した。  
そのまま貼り付けて実行して。

```powershell
# === iCAD標準CSV（チーズ）を3ファイル生成：ダウンロード直行 ===
$DL = "$env:USERPROFILE\Downloads"

# 呼び径→外径(mm)マップ（S規格）
$OD = @{ '1S'=25.4; '1.5S'=38.1; '2S'=50.8; '2.5S'=63.5; '3S'=76.3 }

function New-HeadCsv([string]$title){
@"
1,チーズ,$title,USER_PART
2,システム行,１〜５行目はシステムリザーブです
3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください
4,システム行,システムリザーブ
5,システム行,システムリザーブ
6,ユーザ行,６〜９行目は利用者開放領域です
7,ユーザ行,御自由に御利用下さい
8,ユーザ行
9,ユーザ行
"@
}

# ========== 1) 一方ショートチーズ（L1のみ） ==========
# 表：1S-1S=38 / 2S-2S=55 / 2.5S-2.5S=62 / 3S-3S=68
$rows_SS = @(
    @{A='1S';   B='1S';   L1=38}
    @{A='2S';   B='2S';   L1=55}
    @{A='2.5S'; B='2.5S'; L1=62}
    @{A='3S';   B='3S';   L1=68}
)
$csv_SS = New-HeadCsv '一方ショートチーズ' + "呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),モデル名`n"
foreach($r in $rows_SS){
  $csv_SS += "{0},{1},{2},{3},{4},{5}`n" -f $r.A, $r.B, $OD[$r.A], $OD[$r.B], $r.L1, ("一方ショートチーズ_{0}-{1}" -f $r.A,$r.B)
}
$path_SS = Join-Path $DL 'チーズ_一方ショートチーズ.csv'
$csv_SS | Out-File -Encoding UTF8 $path_SS

# ========== 2) 一方ショート×ローネックチーズ（L1,L2） ==========
# 表：1S-1.5S=38×35 / 1.5S-2S=48×45 / 2S-2.5S=55×50 / 2.5S-3S=62×57 / 3S-3S=68×63
$rows_SSRN = @(
    @{A='1S';   B='1.5S'; L1=38; L2=35}
    @{A='1.5S'; B='2S';   L1=48; L2=45}
    @{A='2S';   B='2.5S'; L1=55; L2=50}
    @{A='2.5S'; B='3S';   L1=62; L2=57}
    @{A='3S';   B='3S';   L1=68; L2=63}
)
$csv_SSRN = New-HeadCsv '一方ショート×ローネックチーズ' + "呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),モデル名`n"
foreach($r in $rows_SSRN){
  $csv_SSRN += "{0},{1},{2},{3},{4},{5},{6}`n" -f $r.A, $r.B, $OD[$r.A], $OD[$r.B], $r.L1, $r.L2, ("一方Sローネックチーズ_{0}-{1}" -f $r.A,$r.B)
}
$path_SSRN = Join-Path $DL 'チーズ_一方ショート×ローネックチーズ.csv'
$csv_SSRN | Out-File -Encoding UTF8 $path_SSRN

# ========== 3) 両方ショート×ローネックチーズ（L1,L2,L3） ==========
# 表：1S-1.5S=35×38×35 / 1.5S-2S=45×48×45 / 2S-2.5S=50×55×50 / 2.5S-3S=57×62×57 / 3S-3S=63×68×63
$rows_DSRN = @(
    @{A='1S';   B='1.5S'; L1=35; L2=38; L3=35}
    @{A='1.5S'; B='2S';   L1=45; L2=48; L3=45}
    @{A='2S';   B='2.5S'; L1=50; L2=55; L3=50}
    @{A='2.5S'; B='3S';   L1=57; L2=62; L3=57}
    @{A='3S';   B='3S';   L1=63; L2=68; L3=63}
)
$csv_DSRN = New-HeadCsv '両方ショート×ローネックチーズ' + "呼び径A,呼び径B,O.D.A(mm),O.D.B(mm),L1(mm),L2(mm),L3(mm),モデル名`n"
foreach($r in $rows_DSRN){
  $csv_DSRN += "{0},{1},{2},{3},{4},{5},{6},{7}`n" -f $r.A, $r.B, $OD[$r.A], $OD[$r.B], $r.L1, $r.L2, $r.L3, ("両方Sローネックチーズ_{0}-{1}" -f $r.A,$r.B)
}
$path_DSRN = Join-Path $DL 'チーズ_両方ショート×ローネックチーズ.csv'
$csv_DSRN | Out-File -Encoding UTF8 $path_DSRN

Write-Host "作成:" -ForegroundColor Cyan
$path_SS
$path_SSRN
$path_DSRN
```

### 生成されるファイル（Downloads）
- `チーズ_一方ショートチーズ.csv`
- `チーズ_一方ショート×ローネックチーズ.csv`
- `チーズ_両方ショート×ローネックチーズ.csv`

### 使い方メモ
1. 上の PowerShell を貼り付けて実行 → 3つのCSVが Downloads に生成。  
2. `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\` にコピー。  
3. インデックス `チーズ.csv` に、この3ファイル分の行を追記（仕様識別子や材質は運用に合わせて）。  
4. iCAD再起動 → 標準部品配置から呼び出して寸法適用を確認。

必要なら、列名やシステム行の文言を**あなたの環境の元CSVに完全一致**へ微調整する版もすぐ出せる。

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # ---- ここだけコピペしてEnter（前スクリプトの後でOK）----
PS C:\Users\h.futada> $dir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
PS C:\Users\h.futada> $log = Join-Path $dir 'インデックス追記_ログ.txt'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 直前の結果を推測（存在しない場合は空でOK）
PS C:\Users\h.futada> if (-not (Get-Variable -Name renamed -ErrorAction SilentlyContinue)) { $renamed = @() }
PS C:\Users\h.futada> if (-not (Get-Variable -Name specResults -ErrorAction SilentlyContinue)) { $specResults = @() }
PS C:\Users\h.futada> if (-not (Get-Variable -Name idxReplaced -ErrorAction SilentlyContinue)) { $idxReplaced = $false }
PS C:\Users\h.futada>
PS C:\Users\h.futada> $sb = New-Object System.Text.StringBuilder
PS C:\Users\h.futada> $null = $sb.AppendLine("=== LowNeck 一括置換ログ ===")
PS C:\Users\h.futada> $null = $sb.AppendLine("日時: $(Get-Date)")
PS C:\Users\h.futada> $null = $sb.AppendLine("対象フォルダ: $dir")
PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[ファイル名のリネーム]")
PS C:\Users\h.futada> foreach($r in $renamed){
>>   $status = if($r.Done){'OK'}else{'無し'}
>>   $null = $sb.AppendLine(" - $($r.Old) -> $($r.New) : $status")
>> }
PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[寸法表CSV 置換結果（ローネック→LowNeck）]")
PS C:\Users\h.futada> foreach($r in $specResults){
>>   $status = if($r.Replaced){'OK'}else{'未処理／未発見'}
>>   $null = $sb.AppendLine(" - $($r.File) : $status")
>> }
PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[インデックス置換]")
PS C:\Users\h.futada> $null = $sb.AppendLine(" - チーズ.csv : " + (if($idxReplaced){'OK'}else{'未処理／未発見'}))
if : 用語 'if' は、コマンドレット、関数、スクリプト ファイル、または操作可能なプログラムの名前として認識されません。名
前が正しく記述されていることを確認し、パスが含まれている場合はそのパスが正しいことを確認してから、再試行してください。
発生場所 行:1 文字:43
+ $null = $sb.AppendLine(" - チーズ.csv : " + (if($idxReplaced){'OK'}else{ ...
+                                           ~~
    + CategoryInfo          : ObjectNotFound: (if:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS C:\Users\h.futada>
PS C:\Users\h.futada> [IO.File]::WriteAllText($log, $sb.ToString(), [System.Text.Encoding]::GetEncoding(932))
PS C:\Users\h.futada> Write-Host "ログ更新: $log"
ログ更新: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\インデックス追記_ログ.txt
PS C:\Users\h.futada> # ---- ここまで ----
PS C:\Users\h.futada>


Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # ファイル名が変わっているか
PS C:\Users\h.futada> Get-ChildItem 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ' -Filter '*LowNeck*'


    ディレクトリ: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        2025/08/28     17:32            632 チーズ_一方ショート×LowNeckチーズ.csv
-a----        2025/08/28     17:23            650 チーズ_一方ショート×LowNeckチーズ.csv.bak_20250828_173252
-a----        2025/08/28     17:32            632 チーズ_両方ショート×LowNeckチーズ.csv
-a----        2025/08/28     17:23            650 チーズ_両方ショート×LowNeckチーズ.csv.bak_20250828_173252


PS C:\Users\h.futada>
PS C:\Users\h.futada> # 寸法表CSV 内部の表記が LowNeck になっているか
PS C:\Users\h.futada> Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\*.csv' -Pattern 'LowNeck' | Select-Object -First 10

C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv:1:1, ` [ Y, n ڗp ` [ Y(LowNeck)_1.0S,TOSTE,USER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:1:1, ` [ Y,    V   [ g ~LowNeck ` [ Y,U
SER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:11:"1S","1.5S","    V   [ g ~LowNeck ` 
[ Y_1S-1.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:12:"1.5S","2S","    V   [ g ~LowNeck ` 
[ Y_1.5S-2S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:13:"2S","2.5S","    V   [ g ~LowNeck ` 
[ Y_2S-2.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:14:"2.5S","3S","    V   [ g ~LowNeck ` 
[ Y_2.5S-3S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×LowNeckチーズ.csv:15:"3S","3S","    V   [ g ~LowNeck ` [ 
Y_3S-3S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:1:1, ` [ Y,     V   [ g ~LowNeck ` [ Y,
USER_PART
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:11:"1S","1.5S","     V   [ g ~LowNeck `
 [ Y_1S-1.5S"
C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×LowNeckチーズ.csv:12:"1.5S","2S","     V   [ g ~LowNeck `
 [ Y_1.5S-2S"


PS C:\Users\h.futada>
PS C:\Users\h.futada> # インデックスに SS_LN / DS_LN が入っているか
PS C:\Users\h.futada> Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Pattern 'SS_LN','DS_LN','LowNeck'

C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv:1:1, ` [ Y, n ڗp ` [ Y(LowNeck)_1.0S,TOSTE,USER_PART


PS C:\Users\h.futada>

### assistant  

了解 👍  
**「iCADで3Dモデルを自動生成させたい」** なら、単純に属性を書くだけではダメで、CSVの寸法項目を **パラメトリック寸法項目** としてきちんと定義する必要がある。  
つまり、iCADがそのCSVを読んで「呼び径ごとに3Dを作れる」ようにしてやる流れになる。  

---

## 最良の手順（チーズ15種類を3D自動生成化）

### ① CSVの雛形を流用
- 既存の `チーズ_T-8.csv` や `チーズ_7MD.csv` を雛形にする。  
- 先頭 5〜6行はシステム用（削除禁止）。  
- 「呼び径」「外径」「肉厚」「長さ」「分岐径」などの寸法パラメータ列が定義されているはず。  

👉 ここで大事なのは **iCADが理解する列名** を使うこと。  
（例：`呼び径A`, `呼び径B`, `L1`, `L2`, `分岐径`, `外径`, `厚さ` など）  

---

### ② 寸法表の書き換え
- 画像にある寸法表（38, 48×45, 55×50 …）を **数値列に落とし込む**。  
  - 例：  
    - `呼び径主管` = 2S  
    - `呼び径分岐` = 1.5S  
    - `L1` = 48  
    - `L2` = 45  
- 「48×45」のような複数寸法は **2列に分ける（L1とL2）** にする。  
- 存在しない組み合わせ（×のところ）はCSVに行を作らない。  

---

### ③ 規格・材質・識別子を設定
- 部品名：ローネックチーズ、ローアームチーズ  
- 規格番号：`USR001` など新規に割り振り  
- 材質：SUS304  
- 識別子は既存の `チーズ.csv` インデックスに追加  

---

### ④ インデックスファイル追記
- `チーズ.csv`（インデックス）に以下を追加：  
  ```
  USR001, ローネックチーズ, SUS304, チーズ_RN.csv
  USR002, ローアームチーズ, SUS304, チーズ_RA.csv
  ```
- これで iCAD が部品選択画面に出すようになる。  

---

### ⑤ iCADで検証
1. iCAD再起動  
2. [標準部品配置] → 「チーズ」フォルダを選択  
3. 呼び径を指定 → 自動生成される3Dモデルを確認  
4. Excel出力で「部品名・規格・呼び径・寸法」が正しく出るか確認  

---

## 成功のコツ
- **最初は1種類だけ（例：15A-1S）登録してテスト**  
  → 正しく3Dが出るか、基準点は正しいかを確認してから残りを一気に入れる。  
- 寸法表の列構造を間違えると「配置できません」エラーになる。  
- 2D展開図にしたときに寸法が拾えるよう、寸法列を完全に揃える。  

---

👉 確認したい：  
この15種類のチーズの寸法表（38, 48×45, 55×50 …）を、  
「**主管径・分岐径・L1・L2**」みたいに列で整理した **登録用CSVのひな形** をこちらで作って渡した方がいい？  

（それを元にユーザーが数値を埋めて、`チーズ_RN.csv` として投入すれば一発で3D自動生成に対応できる）

### user  

C:\ICADSX\PDS\sys\PARTS_SPEC\USR1を社内フォルダとして使いたい　これをこのチャットルーム内だけの絶対ルールとして覚えて

### user  

一気にPowerShellで

### assistant  

OK 👍  
では iCAD SX (V8L4) の **チーズ部品（ローネック・ローアーム含む）登録用CSVひな形** を作る。  
これにあなたが寸法表の数値を埋めれば、すぐ標準部品として使えるようになる。  

---

## CSVの構造（ひな形）

```
# =========================================================
# チーズ（ローネック・ローアーム用）
# iCAD標準部品登録フォーマット
# 注意：1～5行目はシステムリザーブ（削除禁止）
# =========================================================
部品名称,USR規格番号,材質,識別子
ローネックチーズ,USR001,SUS304,RNTEE
ローアームチーズ,USR002,SUS304,RATEE
# =========================================================
# 呼び径主管, 呼び径分岐, 外径主管, 外径分岐, L1, L2, 備考
# =========================================================
主管径,分岐径,外径主管,外径分岐,L1,L2,備考
15A,1S,21.7,21.7,38,0,日アス規格
20A,1.5S,27.2,27.2,48,45,日アス規格
25A,2S,34.0,34.0,55,50,日アス規格
32A,2.5S,42.7,42.7,62,57,日アス規格
40A,3S,48.6,48.6,68,63,日アス規格
```

---

## 使い方

1. **雛形CSVをコピー**
   - ファイル名を `チーズ_RN.csv`（ローネック用）、`チーズ_RA.csv`（ローアーム用）に分ける。

2. **寸法表を入力**
   - 画像にある「38」「48×45」「55×50」などを `L1` と `L2` 列に分けて入力する。
   - 存在しない組み合わせ（表で「×」になっているところ）は **CSVに行を作らない**。

   例：  
   - 「48×45」の場合 → L1=48, L2=45  
   - 「38」だけの場合 → L1=38, L2=0  

3. **インデックスに追記**
   - `チーズ.csv` に次を追加：
     ```
     USR001,ローネックチーズ,SUS304,チーズ_RN.csv
     USR002,ローアームチーズ,SUS304,チーズ_RA.csv
     ```

4. **配置テスト**
   - iCAD再起動  
   - [標準部品配置] → チーズ → 「ローネックチーズ」選択 → 呼び径指定で自動生成できるか確認  

---

👉 このひな形をそのまま **Excelで編集して保存（CSV形式）** すればOK。  

必要ならこちらで **実際に表（15種類ぶんの行）をすべて展開したCSV** を作成して渡そうか？  
（あなたの画像の表を元に、15種類を全部「主管径・分岐径・L1・L2」に落とし込んで完成品にする）

### assistant  

なるほど、それはっきりした 👍  
「ファイルが見つかりません」と出るのは、このチャット環境では **リンクをそのままクリックしても落とせない場合がある** ため。  

回避策は２つあるよ。  

---

## ✅ 方法1：PowerShellで保存（ユーザーに一番おすすめ）
あなたの希望どおり **PowerShellワンライナー形式で .py を保存** できるコードを作る。  
これを貼り付ければ、即座に `チーズ標準部品ひな形.csv` をPCに作成できる。

```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
一方ショートチーズ,USR010,SUS304,15A,1S,38,0
一方ショートチーズ,USR010,SUS304,2S,2S,55,0
一方ショートチーズ,USR010,SUS304,2.5S,2.5S,62,0
一方ショートチーズ,USR010,SUS304,3S,3S,68,0
一方ショート×ローネックチーズ,USR011,SUS304,1S,1.5S,38,35
一方ショート×ローネックチーズ,USR011,SUS304,1.5S,2S,48,45
一方ショート×ローネックチーズ,USR011,SUS304,2S,2.5S,55,50
一方ショート×ローネックチーズ,USR011,SUS304,2.5S,3S,62,57
一方ショート×ローネックチーズ,USR011,SUS304,3S,3S,68,63
両方ショート×ローネックチーズ,USR012,SUS304,1S,1.5S,35,38
両方ショート×ローネックチーズ,USR012,SUS304,1.5S,2S,45,48
両方ショート×ローネックチーズ,USR012,SUS304,2S,2.5S,50,55
両方ショート×ローネックチーズ,USR012,SUS304,2.5S,3S,57,62
両方ショート×ローネックチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "チーズ標準部品ひな形.csv"
```

これを実行すれば、カレントディレクトリに  
`チーズ標準部品ひな形.csv` が作られる。  

---

## ✅ 方法2：ここで再生成 → コピー＆保存
私が中身をそのままテキストで出すので、あなたがメモ帳に貼り付けて `チーズ標準部品ひな形.csv` として保存してもOK。  

---

👉 質問：どっちがやりやすい？  
1. PowerShellワンライナーで一発保存  
2. テキストをコピペ保存  

どちらか選んでもらえれば、その形式で渡すよ。

### assistant  

元CSVを解析した結果、だいたいこんな「傾向」が見えたよ👇  

---

## ① 共通構造
- **1〜5行目** → システムリザーブ（削除禁止）  
- **6〜9行目** → ユーザー自由領域（備考とか）  
- **10行目以降** → 呼び径・外径・モデル名など寸法表データ  

---

## ② 単径チーズ（例：チーズ_T-8.csv, チーズ_7MD.csv）
- 列構造はだいたいこう：
  ```
  呼び径A, O.D.(mm), 部品モデル名, (以降は空欄 or 予備列)
  ```
- 例：  
  ```
  1.5S,38.1mm,ローネックチーズ_1.5S
  2.0S,50.8mm,ローネックチーズ_2.0S
  ```

👉 単径（主管＝分岐同サイズ）のチーズはこちら。  

---

## ③ 異径チーズ（例：チーズ_T-8-9.csv）
- 列構造はこう：
  ```
  呼び径A×呼び径B×呼び径C, O.D.×O.D.×O.D., 部品モデル名
  ```
- 例：  
  ```
  1.5Sx1.5Sx1.0S, 38.1mmx38.1mmx25.4mm, 溶接用チーズ(ローネック)_15A×10A
  ```

👉 異径T字継手や変換付きのチーズは「呼び径を掛け算形式」で書く。  

---

## ④ ローアームチーズ（チーズ_D-8_S.csv）
- 列に「呼び径A, 呼び径B」と分かれていて、外径とモデル名を並べる。  
- 単径チーズよりも「分岐径を別列」で管理している。  

---

## ⑤ インデックス（チーズ.csv）
- ここに「仕様識別子」「規格番号」「材質」などがまとまっていて、  
  具体的な寸法CSV（T-8, D-8_S, 7MD …）を呼び出す仕組みになってる。  

---

## まとめると
- **元々のCSV群は、種類ごとにファイル分割されている**（T-8, D-8_S, 7MD など）  
- それぞれの中で「呼び径ごとの寸法表」を縦持ちデータで並べる  
- **異径**は「呼び径を掛け算形式」で1セルに書くのが基本  

---

👉 つまり今回の15部品も、**元と同じく「種類ごとにCSVを分ける」** のが最良。  
- `チーズ_SS.csv`（一方ショート）  
- `チーズ_SS_RN.csv`（一方ショート×ローネック）  
- `チーズ_DS_RN.csv`（両方ショート×ローネック）  

それぞれに寸法表を縦に並べる。  
（異径があるなら「15Ax10A」みたいに掛け算表記を入れる）  

---

👉 確認したいんだけど、今回の15部品は「主管径・分岐径が異なる異径チーズ」も含まれる？  
それとも「すべて同径／片側だけ異なる」だけ？  

（ここでどっちかをハッキリさせれば、元CSVに完全準拠した正しいフォーマットで作れる）

### assistant  

✅ iCAD用の **チーズ標準部品ひな形（15種類）CSV** を作成しました。  

こちらからダウンロードできます：  
[チーズ標準部品ひな形.csv](sandbox:/mnt/data/チーズ標準部品ひな形.csv)  

表は下のように整理済みです：  

- 部品名称（例：一方ショートチーズ / 一方ショート×ローネックチーズ / 両方ショート×ローネックチーズ）  
- 規格番号（USR010〜012 仮番号）  
- 材質（SUS304）  
- 主管径 / 分岐径  
- L1 / L2（寸法表の「48×45」などを2列化）  

👉 あなたの環境に合わせて **外径列の追加** や **正しいJIS外径寸法** を追記すれば、そのまま iCAD に登録可能です。  

次のステップとして：  
1. `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ` フォルダに配置  
2. インデックス `チーズ.csv` に追記  
3. iCADを再起動 → [標準部品配置] で呼び出しテスト  

---

修正が必要なら（例えば外径・肉厚・材質を追加したいなど）、このCSVを拡張できます。  
👉 外径や厚みも一緒に入れて、**完全なパラメトリック3D生成対応版** にしておこうか？

### assistant  

おっけー、あなたが貼ってくれた画像（15種類まとめ表）を思い出しながら整理すると 👇  

---

## 画像の内容（私が確認した範囲）
- 表形式で **3種類のチーズ系統 × 呼び径の組合せ** が一覧になっていた  
- 種類はこの3つ：  
  1. **一方ショートチーズ**（片側だけショート形状）  
  2. **一方ショート × ローネックチーズ**（主管はショート、分岐がローネック）  
  3. **両方ショート × ローネックチーズ**（主管も分岐もショート＋ローネック）  

- その中に「15種類」の組み合わせが並んでいた  

- 各セルには寸法値が入っていて：  
  - 「38」や「55」みたいに **単一の数値** のもの  
  - 「48×45」「62×57」みたいに **2値セット** のもの  
- 一部の組み合わせは「×」印で「規格なし（部品存在しない）」になってた  

---

## 傾向
- **主管径と分岐径の組合せ表**になっていて、各セルがその組み合わせの寸法を表していた  
- 「単数値」の場合は **L1のみ** の寸法  
- 「2値セット」の場合は **L1とL2の2寸法**  
- 「×」の場合はCSVに行を作らない  

---

## つまり
今回の15部品は  
- 呼び径組合せ（主管×分岐）ごとに1行ずつCSVにする  
- 「48×45」みたいなのは `L1=48, L2=45` に分割  
- 「38」みたいなのは `L1=38, L2=0` として扱う  

---

👉 確認したいんだけど、画像の表って **主管径ごとに横軸・分岐径ごとに縦軸** のマトリクス形式だった？  
それとも **リスト形式で15行** 並んでた？  

（どちらかでCSVへの落とし込み方が変わるので、そこを決めたい）

### assistant  

```
iCAD SX 標準部品 登録（超ざっくり版）

1) 置き場所を作る
   …\PDS\SYS\PARTS_SPEC\(自社規格名)\(部品種類) を用意

2) 部品寸法表CSVを作る
   見出し「呼び径Ａ,呼び径Ｂ,利用者部品のモデル名」＋ その下に必要な行（今回5行）だけ入れる

3) インデックスCSVを更新
   同フォルダのインデックスに、そのCSVを1行追記（規格名/番号と紐づけ）

4) iCADを再起動して確認
   部品配置 → 規格参照から選んで配置できるかチェック

5) だめならここだけ確認
   見出しの語順・列数・行数（余計な空白や全角/半角の混在がないか）
```

### assistant  

完了ナイスです ✅  
いまの実行で、

- 寸法表CSV：`LowNeck` → **「ローネック」** に戻し済み（バックアップ *.bak_日時 あり）
- インデックス `チーズ.csv`：**部品名称=ローネック**、**規格番号= SS / SS_LN / DS_LN** に統一

になっています。

---

## 最終チェック（文字化けしないASCII中心）
```powershell
# 1) インデックスに SS / SS_LN / DS_LN が揃っているか
Get-Content 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Encoding Default |
  Select-String 'SS','SS_LN','DS_LN'

# 2) 寸法表CSVの先頭～15行だけ確認（ヘッダ位置と行数）
gc 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショートチーズ.csv' -Encoding Default | select -First 15
gc 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×ローネックチーズ.csv' -Encoding Default | select -First 15
gc 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×ローネックチーズ.csv' -Encoding Default | select -First 15
```
見たいポイント：
- **10行目**が `呼び径Ａ,呼び径Ｂ,利用者部品のモデル名`
- **11〜15行目**に5行のデータ
- 「利用者部品のモデル名」に **ローネック** が入っている

（※コンソール表示が化ける場合は `-Encoding Default` を必ず付けてください）

---

## iCAD での動作確認
1) iCAD を再起動  
2) 部品配置 → 規格参照 → **USR1 > チーズ**  
3) 規格番号 **SS / SS_LN / DS_LN** が選べ、呼び径5種が出て、配置できるか確認

---

## 追加の微調整が必要なら
- 規格番号の命名（SS/SS_LN/DS_LN）を別ルールにしたい  
- 部品名称の表記ゆれ（「一方ショート**×**ローネックチーズ」等）を統一したい  
- 呼び径のバリエーションを増やしたい（5行→拡張）

→ 文言・ルールを教えてくれれば、同じ方式で**一括修正スクリプト**をすぐ出します。

### tool  

The file contents provided above are truncated/partial snippets. The complete content for these files IS accessible via querying.

If the user asks a question related to these files, and the provided snippets do not clearly answer it, you **MUST** use the `file_search` tool to search the full document contents before responding.

## How to invoke the file_search tool
If the user's query isn't sufficiently answered by the provided snippets, parsed text, or images, you should invoke `file_search.msearch`.
To search the full content of the available files, you **must** send one message with recipient `to=file_search.msearch` in the analysis channel. Your message should be structured exactly as follows:
```
{
  'queries': ['Example query 1', 'Example query 2']  // List of up to five queries to search for.
}
```

Carefully balance the number of `file_search` calls and the quality of your response with the latency incurred by `file_search` calls.

Important guidelines for query formatting:
- Your message must be a valid JSON object. Do not include any extraneous text, backticks, markdown formatting, or comments beyond what is shown.
- The `queries` field must be a list of strings.
- One of the queries **MUST** exactly match the user's original question, but stripped of any extraneous details, and with ambiguous references clearly resolved using context from the conversation. It **MUST** be a complete sentence.
- Even if you suspect the user meant something else, one query **MUST** still be their original question.

## How to handle results from file_search
The file search tool will respond with the relevant search results from the full files. After you receive these results:
- Carefully evaluate each result to determine its relevance and quality.
- Use the high-quality and relevant results to inform your answer to the user's question.
- When possible, reuse information from prior file_search results and avoid repeating identical queries.

## Tool usage instructions and ordering
When the user asks a question, carefully consider whether the provided snippets sufficiently answer the query, whether you need to invoke `file_search.msearch`, or another available tool (such as `web`, if available) should be used instead.

Tool-ordering Guidelines:
1. For queries related to uploaded files, if snippets are insufficient, strongly prefer invoking `file_search.msearch` over other tools.
    - Avoid using `web.run`, `python` analysis, or any other tools until you have either:
        - Confirmed with high confidence the answer is not in the files, or
        - Have high confidence `file_search_tool` queries are not sufficient to answer the query.
2. Avoid usage of `web_search/web.run` for queries related to uploaded files
    - Carefully consider whether the user's query is better answered by web search results rather than available snippets or results from `file_search_tool`.
    - Unless the user's query is clearly unrelated to the uploaded files, prefer using `file_search.msearch`. You can always follow up with a web search if necessary for a more complete response.
3. Avoid using `python` unless necessary or requested by user.
    - If the user's query is answerable from the parsed text and images from the uploaded files, or from `file_search_tool`, do not invoke `python`.

Always keep this instruction in mind for the rest of the conversation, as the user may reference these files or ask related questions later on.

### assistant  

受け取った `icad_manifest.csv` をざっと見たよ。  

---

## 重要なポイント

- フォルダ構造は **`…\PDS\SYS\PARTS_SPEC\TOSTE\チーズ\`** に対象がまとまっている  
- 中にある CSV は：
  - `チーズ.csv`（インデックス／呼び出しの親）  
  - `チーズ_7MD.csv`  
  - `チーズ_D-8_S.csv`  
  - `チーズ_T-8-9.csv`  
  - `チーズ_T-8.csv`  
- 更新日は 2019〜2022 年とやや古い → 既存標準部品の雛形としてそのまま流用可能  

---

## 登録の仕組み（フォルダ視点で簡単に）

1. **`TOSTE\チーズ\チーズ.csv`**  
   → ここがインデックス。規格番号・部品名称・材質などをまとめて、下の詳細CSVを呼ぶ。

2. **`チーズ_7MD.csv` / `チーズ_D-8_S.csv` / …**  
   → 各「部品寸法表」。  
   中身は **10行目にヘッダ「呼び径Ａ, 呼び径Ｂ, 利用者部品のモデル名」**、11行目以降に縦持ちデータ。

3. iCADは **インデックス → 寸法表 → モデルファイル名** の順で部品を引っ張る。

---

## 今回やるべきこと

- 既存の `TOSTE\チーズ` の並びに習って、  
  新しい **3つの寸法表 CSV（各5行入り）** を追加  
  - `チーズ_一方ショートチーズ.csv`  
  - `チーズ_一方ショート×ローネックチーズ.csv`  
  - `チーズ_両方ショート×ローネックチーズ.csv`  

- それを呼べるように **インデックス `チーズ.csv` に行を追記**  
  （規格番号は 14文字以内で新規に割り振る）  

---

👉 これでフォルダ構造の全貌が分かったので、  
次のステップは「インデックス `チーズ.csv` に追記する行フォーマット」を作ることになる。  

質問：インデックスの既存行（`チーズ.csv`）を開いて内容確認してほしい？ それともこちらで推奨フォーマットを仮作成して提示する？

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-84NApkkPJCWB5Q6cMtPgDF; size_bytes=134286; width=1905; height=1003; fovea=; metadata=}

右が元のCSV。データの配置がおかしいから修正して

### user  

ファイルが見つかりません

### assistant  

なるほど 👍 iCAD SX の標準部品呼び出し制限（14文字以内）は重要ポイント。  
そのまま「一方ショート×ローネックチーズ」みたいに長い名前だと確実にアウト。  
**社内で誰が見ても分かる最良の省略形（14文字以内）** を考えてみた。  

---

## 命名ルール（14文字以内）
- 「TEE」を基準語にする（T字管＝チーズ → 英語の Tee で短縮）  
- ショート → `S`  
- ローネック → `RN`  
- ローアーム → `RA`  
- 両方ショート → `DS` (Double Short)  
- 一方ショート → `SS` (Single Short)  

---

## 提案する部品名称（14文字以内）

| 元の名称                      | 推奨名称（14文字以内） | 文字数 |
|-------------------------------|------------------------|--------|
| 一方ショートチーズ             | TEE_SS                 | 6      |
| 一方ショート×ローネックチーズ | TEE_SS_RN              | 9      |
| 両方ショート×ローネックチーズ | TEE_DS_RN              | 9      |
| ローアームチーズ（もし追加）   | TEE_RA                 | 6      |

👉 これなら全て14文字以内。  
👉 社内でも「TEE_SS」「TEE_SS_RN」と見れば意味が直感的に分かる。  

---

## PowerShell生成版（名前修正版）
```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
TEE_SS,USR010,SUS304,15A,1S,38,0
TEE_SS,USR010,SUS304,2S,2S,55,0
TEE_SS,USR010,SUS304,2.5S,2.5S,62,0
TEE_SS,USR010,SUS304,3S,3S,68,0
TEE_SS_RN,USR011,SUS304,1S,1.5S,38,35
TEE_SS_RN,USR011,SUS304,1.5S,2S,48,45
TEE_SS_RN,USR011,SUS304,2S,2.5S,55,50
TEE_SS_RN,USR011,SUS304,2.5S,3S,62,57
TEE_SS_RN,USR011,SUS304,3S,3S,68,63
TEE_DS_RN,USR012,SUS304,1S,1.5S,35,38
TEE_DS_RN,USR012,SUS304,1.5S,2S,45,48
TEE_DS_RN,USR012,SUS304,2S,2.5S,50,55
TEE_DS_RN,USR012,SUS304,2.5S,3S,57,62
TEE_DS_RN,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "$env:USERPROFILE\Downloads\チーズ標準部品ひな形.csv"
```

---

👉 この命名なら iCAD 制限を回避できて、見ても用途が分かりやすい。  

質問：ローアームチーズも一緒に入れる予定？  
（入れるなら `TEE_RA` で追加できるようにしておくよ）

### assistant  

なるほど、目的は「規格継手を iCAD SX (V8L4) の社内標準部品ライブラリとして登録 → 社員全員が共通で使えるようにする」ことだね。配管継手（ローネックチーズ・ローアームチーズ）の径別15種類を標準化する流れを整理した。  

---

## 推奨する標準部品登録の流れ（汎用継手・バルブ向け）

### ① 部品モデルの準備
- **3Dモデル**を1種類ずつ作る。  
  - 例：ローネックチーズ 15A、20A、25A …  
  - 参照規格（JIS B2312, B2313 など）に基づいた寸法で作成。  
- 部品属性に以下を必ず設定する：
  - 部品名（例：ローネックチーズ）  
  - 呼び径（例：15A, 20A）  
  - 型式 or 規格（例：JIS B2313）  
  - 図面番号や管理番号（社内標準コード）

---

### ② 基準点の設定
- 挿入基準点は **管路中心線の交点** にするのが鉄則。  
- 3方向（主管＋分岐）で位置ずれが出ないように中心点を原点に設定。

---

### ③ 標準部品登録
1. [ツール] → [標準部品] → **標準部品登録**  
2. 登録する部品（例：ローネックチーズ15A）を選択  
3. 分類フォルダを作成：
   ```
   配管継手
      ├─ ローネックチーズ
      └─ ローアームチーズ
   ```
4. 部品名を「ローネックチーズ-15A」「ローアームチーズ-25A」などに統一。

---

### ④ 属性とBOM連携
- **部品属性を必ず入力** → BOMや数量表に自動反映できる。  
  - 部品名、サイズ、規格、メーカー、備考  
- Excel連携を考えるなら、列名を社内標準に合わせて整理。

---

### ⑤ 保存先・共有方法
- ライブラリを **ネットワーク共有フォルダ** に保存  
  （例：`\\Server\iCAD\StandardParts\Fittings`）  
- 各社員の iCAD SX 設定で「標準部品フォルダ」をその共有パスに指定。  
  → 全員が同じ標準部品を呼び出せるようになる。

---

## 登録時のコツ
- **15種類一気に登録するより、まず1種類で試験** → 呼び出し・配置・BOM連携が正しく動作するか確認。  
- **呼称ルールを最初に決める**  
  例：「継手種別-呼び径-規格」＝ `ローネックT-20A-JISB2313`  
- 将来的にサイズ追加しても混乱しないよう、フォルダ・命名規則を統一。  

---

👉 確認なんだけど、登録する15種類は **3Dモデルだけ**（2Dは自動展開）でいい？  
それとも **2Dシンボルも標準化しておきたい**？  

（もし2Dも標準化するなら「三面図を固定化して部品登録 → 2D図面で共通利用」って流れを追加する必要がある）

### assistant  

いい方向性 👍  
既存の iCAD SX 標準Excelを流用しながら新しい継手部品を登録するなら、次の流れで進めるのがベスト。  

---

## 1. 既存Excelテンプレートの確認
- iCADインストール時に標準で入っている Excel 出力用ファイルがあるはず。  
  （多くは `...\iCADSX\Excel\BOM` のようなフォルダに格納）  
- そのフォーマットに合わせて **属性名と列名の対応関係** をチェック。  
  例：  
  - `PART_NAME` → 「部品名」列  
  - `SIZE` → 「呼び径」列  
  - `STD` → 「規格」列  

👉 この「マッピング表」を作っておくと後から混乱しない。  

---

## 2. 新規部品の属性設定
- iCADで継手モデルを作ったら、[属性設定] で既存Excelに対応するキーを付与。  
- 例えばローネックチーズ20Aなら：  
  - PART_NAME = ローネックチーズ  
  - SIZE = 20A  
  - STD = JIS B2313  
  - MATERIAL = SUS304  
  - PART_NO = RN-T20A  

👉 **既存Excelの列を潰さず、空欄でもいいから同じ列構成で入力**するのがコツ。  

---

## 3. 標準部品として登録
- [標準部品登録] → 分類を「継手」→ 「ローネックチーズ」  
- 名前は `ローネックチーズ-20A` のように、Excelの「部品名＋呼び径」と揃える  
- 登録時に属性を必ず保存  

---

## 4. Excel出力で検証
- 配置した部品を [BOM出力] → 既存Excelテンプレートを選んで吐き出す  
- ちゃんと「ローネックチーズ 20A」がExcelに反映されるか確認  
- もし列がズレるなら、属性名のマッピングを修正  

---

## 5. 社内展開
- Excelテンプレートは「社内共通BOMテンプレート」としてサーバーに置く  
- 標準部品ライブラリもサーバーに置き、全員が同じ参照パスを指定  
- こうすれば全員が **共通Excelフォーマットで継手・バルブを自動出力**できる  

---

## 6. 登録の順番（おすすめ）
まずは小さく試す：
1. ローネックチーズ 15A を登録  
2. Excel出力で反映確認  
3. 問題なければ残り14種類をまとめて登録  

---

👉 確認したい：  
既存のExcelは「JIS部品リスト」みたいな汎用フォーマット？  
それとも「自社BOMシステムと連携する専用フォーマット」になってる？  

（どちらかでやり方が少し変わる。前者ならそのまま流用、後者なら属性名を厳密に合わせる必要がある）

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # === USR1\チーズ\チーズ.csv を安全更新：SS_RN→SS_LN / DS_RN→DS_LN、LowNeck化＆必要なら追記 ===
PS C:\Users\h.futada> $enc = [Text.Encoding]::GetEncoding(932)
PS C:\Users\h.futada> $idx = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> if(!(Test-Path $idx)){ throw "インデックスが見つかりません：$idx" }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 1) 全行読み込み（SJIS）
PS C:\Users\h.futada> $lines = [IO.File]::ReadAllLines($idx, $enc)
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 2) ヘッダ行を検出（10行目以降でカンマ3個以上の行を最初に採用）
PS C:\Users\h.futada> $hdrLine = -1
PS C:\Users\h.futada> for($i=9; $i -lt $lines.Count; $i++){
>>   if((($lines[$i] -split ',').Count) -ge 3){ $hdrLine = $i; break }
>> }
PS C:\Users\h.futada> if($hdrLine -lt 0){ throw "ヘッダ行が見つかりません。" }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3) 列位置を決定（規格番号 / 部品名称 / 材質 / CSVファイル名）
PS C:\Users\h.futada> $hdr = $lines[$hdrLine].Split(',')
PS C:\Users\h.futada> function Find-Col($names){
>>   foreach($n in $names){
>>     $pos = [Array]::IndexOf($hdr,$n)
>>     if($pos -ge 0){ return $pos }
>>   }
>>   return -1
>> }
PS C:\Users\h.futada> $colCode = Find-Col @('規格番号','規格No','Code')
PS C:\Users\h.futada> $colName = Find-Col @('部品名称','部品名','名称')
PS C:\Users\h.futada> $colMat  = Find-Col @('材質','Material')
PS C:\Users\h.futada> $colCsv  = Find-Col @('CSVファイル名','仕様ファイル名','寸法表CSV','CSV','ファイル名')
PS C:\Users\h.futada>
PS C:\Users\h.futada> if(($colCode,$colName,$colCsv) -contains -1){
>>   throw "必要列（規格番号/部品名称/CSVファイル名）の位置が特定できません。ヘッダ：$($hdr -join ',')"
>> }
必要列（規格番号/部品名称/CSVファイル名）の位置が特定できません。ヘッダ：仕様識別子,規格番号,呼び厚さ／呼び圧力,材質,部
品規格識別子,呼び径範囲,[@@DIA_FLG],[@@LINE_NUM],[@@COCK_NUM],[@@ANG],[@@CONCENTRIC_FLG],[@@ELBOW_BEND_FLG],[@@LONG_SHO
RT_FLG],[@@ANG_FLG],[@@TYPE],[@@CONNECT],[@@FACE],[@@SCHEDULE],[@@APPEND1],[@@APPEND2],[@@EXP_FLG],[@@DIM_FILE]
発生場所 行:2 文字:3
+   throw "必要列（規格番号/部品名称/CSVファイル名）の位置が特定できません。ヘッダ：$($hdr -join ',')"
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : OperationStopped: (必要列（規格番号/部品名称/C...G],[@@DIM_FILE]:String) [], RuntimeExcep
tion
    + FullyQualifiedErrorId : 必要列（規格番号/部品名称/CSVファイル名）の位置が特定できません。ヘッダ：仕様識別子,規格
番号,呼び厚さ／呼び圧力,材質,部品規格識別子,呼び径範囲,[@@DIA_FLG]    ,[@@LINE_NUM],[@@COCK_NUM],[@@ANG],[@@CONCENTRIC_
FLG],[@@ELBOW_BEND_FLG],[@@LONG_SHORT_FLG],[@@ANG_FLG],[@@TYPE],[    @@CONNECT],[@@FACE],[@@SCHEDULE],[@@APPEND1],[@@AP
PEND2],[@@EXP_FLG],[@@DIM_FILE]

PS C:\Users\h.futada>
PS C:\Users\h.futada> # 4) データ部をオブジェクト化
PS C:\Users\h.futada> $rows = @()
PS C:\Users\h.futada> for($i=$hdrLine+1; $i -lt $lines.Count; $i++){
>>   if([string]::IsNullOrWhiteSpace($lines[$i])){ continue }
>>   $cells = $lines[$i].Split(',')
>>   # 末尾の空列も保持
>>   if($cells.Count -lt $hdr.Count){ $cells = $cells + (',' * ($hdr.Count - $cells.Count)) }
>>   $rows += ,@($cells)
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 5) 変換ルール
PS C:\Users\h.futada> function SetOrAdd([string]$code, [string]$name, [string]$mat, [string]$csvName){
>>   $found = $false
>>   foreach($r in $rows){
>>     if($r[$colCode] -replace '"','' -eq $code){
>>       $r[$colName] = '"' + $name + '"'
>>       if($colMat -ge 0){ $r[$colMat] = '"' + $mat + '"' }
>>       $r[$colCsv]  = '"' + $csvName + '"'
>>       $found = $true
>>       break
>>     }
>>   }
>>   if(-not $found){
>>     $new = New-Object string[] ($hdr.Count)
>>     for($k=0;$k -lt $hdr.Count;$k++){ $new[$k] = '' }
>>     $new[$colCode] = '"' + $code + '"'
>>     $new[$colName] = '"' + $name + '"'
>>     if($colMat -ge 0){ $new[$colMat] = '"' + $mat + '"' }
>>     $new[$colCsv]  = '"' + $csvName + '"'
>>     $rows += ,$new
>>   }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 5-1) 旧コードがあれば置換（SS_RN→SS_LN、DS_RN→DS_LN、名称/CSV内のローネック→LowNeck）
PS C:\Users\h.futada> foreach($r in $rows){
>>   $r[$colName] = $r[$colName] -replace 'ローネック','LowNeck'
>>   $r[$colCsv]  = $r[$colCsv]  -replace 'ローネック','LowNeck'
>>   if($r[$colCode] -match 'SS_RN'){ $r[$colCode] = '"SS_LN"' }
>>   if($r[$colCode] -match 'DS_RN'){ $r[$colCode] = '"DS_LN"' }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 5-2) SS / SS_LN / DS_LN を“必ず”持つように整える（無ければ追加）
PS C:\Users\h.futada> SetOrAdd 'SS'    '一方ショートチーズ'           'SUS304' 'チーズ_一方ショートチーズ.csv'
PS C:\Users\h.futada> SetOrAdd 'SS_LN' '一方SLowNeckチーズ'           'SUS304' 'チーズ_一方ショート×LowNeckチーズ.csv'
PS C:\Users\h.futada> SetOrAdd 'DS_LN' '両方SLowNeckチーズ'           'SUS304' 'チーズ_両方ショート×LowNeckチーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 6) 保存（元ファイルをバックアップしてから SJIS+CRLF で書き出し）
PS C:\Users\h.futada> $bak = "$idx.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
PS C:\Users\h.futada> Copy-Item $idx $bak -Force
PS C:\Users\h.futada> $nl = "`r`n"
PS C:\Users\h.futada> $out = New-Object System.Collections.Generic.List[string]
PS C:\Users\h.futada> # 予約行＋ヘッダを復元
PS C:\Users\h.futada> for($i=0;$i -le $hdrLine;$i++){ $out.Add($lines[$i]) }
PS C:\Users\h.futada> # データ部を書き直し
PS C:\Users\h.futada> foreach($r in $rows){ $out.Add(($r -join ',')) }
PS C:\Users\h.futada> [IO.File]::WriteAllText($idx, ($out -join $nl) + $nl, $enc)
PS C:\Users\h.futada>
PS C:\Users\h.futada> "更新OK → $idx`nバックアップ → $bak"
更新OK → C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv
バックアップ → C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv.bak_20250828_173739
PS C:\Users\h.futada>

### assistant  

```
iCAD SX 標準部品 登録（ちょうどいい要約｜このチャットの絶対ルール準拠）

1) 置き場所
   …\PDS\SYS\PARTS_SPEC\(自社規格名)\チーズ\
   ※ JIS-SYS / JPI-SYS 直下には置かない

2) CSV（部品寸法表）を作る【最小必須】
   ・1〜5行目：システム予約（編集しない／D・E・F列は使わない）
   ・6〜9行目：ユーザ行（任意メモ）
   ・10行目：見出し「呼び径Ａ,呼び径Ｂ,利用者部品のモデル名」
   ・11行目以降：今回は各CSVに“5行だけ”（5形状）
       例）1S,1.5S,一方ショート×ローネックチーズ_1S-1.5S
     - 呼び径は基本「大→小」。複数は x 連結可（必要な場合）
     - 最後の列＝モデル名（図面名 or パラメ部品フォルダ名）
   ・保存形式：Shift-JIS（CP932）／改行：CRLF／カンマ区切り

3) CSVは3ファイルに分ける（各5行）
   ・チーズ_一方ショートチーズ.csv（同径）
   ・チーズ_一方ショート×ローネックチーズ.csv（異径）
   ・チーズ_両方ショート×ローネックチーズ.csv（異径）

4) インデックスCSV（同フォルダの「チーズ.csv」）に追記
   上の3CSVを指す行を追加（最低：規格番号〈14文字以内〉／部品名称／材質／CSVファイル名）

5) 反映・確認
   iCAD再起動 → 部品配置 → 規格参照で規格・部品・呼び径を選び、配置できるか確認

6) つまずいたら見るチェック
   ・A10セル＝「呼び径Ａ」になっているか（ヘッダ位置）
   ・CSVの文字コード/改行（SJIS＋CRLF）と置き場所が正しいか
   ・各CSVは“5行だけ”になっているか／モデル名の綴り一致
   ・JIS-SYS/JPI-SYS配下を編集していないか
```

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-LZwZki4ypiWqRFLUMnotNh; size_bytes=1986; width=217; height=26; fovea=; metadata=}

呼び径Ａ	呼び径Ｂ	利用者部品のモデル名の行がいなくなってる気がする 。また、データは5形状×3種類の15個だから。1つのCSVにはパーツデータが5行入ることになる。

### assistant  

なるほど 👍  
整理すると：

- **通常の部品名称**（iCAD の「部品名称」列やモデル名に出る名称）は  
  👉 日本語で「ローネック」と表記するのが一般的・分かりやすい  

- **規格番号や略称コード**（インデックスの「規格番号」列など）は  
  👉 英数字だけなので「RN」「LN」みたいな略称にした方がシンプル  

---

## つまりおすすめの運用

- インデックス `チーズ.csv`
  - 部品名称：  
    - `一方ショートチーズ`  
    - `一方ショート×ローネックチーズ`  
    - `両方ショート×ローネックチーズ`
  - 規格番号：  
    - `SS`  
    - `SS_RN`  
    - `DS_RN`

- 寸法表CSV 内のモデル名列も  
  👉 日本語の「ローネック」表記で統一

---

## 今の状況との差分
- さっき一括置換で「LowNeck」にしてしまった  
- でも本来は「部品名称・モデル名」は日本語「ローネック」に戻す方が自然  
- 一方、**規格番号は SS_RN / DS_RN** のままでOK  

---

👉 質問：  
最終的には「部品名称・モデル名は日本語『ローネック』」に戻して、  
**規格番号だけ RN (英略)** に統一する形に修正しましょうか？

### user  

右の元CSVと同じ構造（縦持ち・モデル名は最後） に修正し直してお願い

### user  

そうして

### assistant  

OK 👍  
**ダウンロードフォルダ**に直接 `チーズ標準部品ひな形.csv` を作る PowerShell ワンライナーを用意したよ。  

---

### PowerShellワンライナー（ダウンロード直行版）
```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
一方ショートチーズ,USR010,SUS304,15A,1S,38,0
一方ショートチーズ,USR010,SUS304,2S,2S,55,0
一方ショートチーズ,USR010,SUS304,2.5S,2.5S,62,0
一方ショートチーズ,USR010,SUS304,3S,3S,68,0
一方ショート×ローネックチーズ,USR011,SUS304,1S,1.5S,38,35
一方ショート×ローネックチーズ,USR011,SUS304,1.5S,2S,48,45
一方ショート×ローネックチーズ,USR011,SUS304,2S,2.5S,55,50
一方ショート×ローネックチーズ,USR011,SUS304,2.5S,3S,62,57
一方ショート×ローネックチーズ,USR011,SUS304,3S,3S,68,63
両方ショート×ローネックチーズ,USR012,SUS304,1S,1.5S,35,38
両方ショート×ローネックチーズ,USR012,SUS304,1.5S,2S,45,48
両方ショート×ローネックチーズ,USR012,SUS304,2S,2.5S,50,55
両方ショート×ローネックチーズ,USR012,SUS304,2.5S,3S,57,62
両方ショート×ローネックチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "$env:USERPROFILE\Downloads\チーズ標準部品ひな形.csv"
```

---

### 実行後
- 自動で **C:\Users\<ユーザー名>\Downloads\チーズ標準部品ひな形.csv** が作成される。  
- すぐにエクスプローラーから確認できる。  

---

👉 これを iCAD の `PARTS_SPEC\TOSTE\チーズ` にコピーして、インデックス `チーズ.csv` に追記すれば使えるようになるよ。  

次に、**外径・肉厚列を追加したパラメトリック完全版** も一緒に作っておく？

### assistant  

OK 👍  
インデックス `チーズ.csv` を **TOSTE から USR1 にコピー**する PowerShell を用意したよ。  
既に USR1\チーズ\ にファイルがあった場合は **バックアップ (.bak_日時付き)** を自動で取るようにしてあるから安心。

---

## PowerShell

```powershell
# ===== インデックス チーズ.csv を TOSTE → USR1 にコピー =====

$src = 'C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv'
$dstDir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$dst = Join-Path $dstDir 'チーズ.csv'

# USR1\チーズ フォルダがなければ作成
if (-not (Test-Path $dstDir)) {
    New-Item -ItemType Directory -Path $dstDir | Out-Null
}

# 既に USR1\チーズ\チーズ.csv がある場合はバックアップ
if (Test-Path $dst) {
    $bak = "$dst.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
    Copy-Item $dst $bak -Force
    Write-Host "既存のチーズ.csvをバックアップしました → $bak"
}

# コピー実行
Copy-Item $src $dst -Force
Write-Host "コピー完了: $src → $dst"
```

---

これを実行すれば、  
- `C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv` ができる  
- 中身は **TOSTEのインデックスそのまま**（編集用の雛形として流用可能）  

---

👉 次のステップは、この `USR1\チーズ\チーズ.csv` に **あなたの3つの新CSV（寸法表）を追記する行** を追加することになる。  
このまま「追記スクリプト」も一気に出そうか？

### assistant  

エラー再現ありがとう。原因は `-f` 演算子で整形した文字列を `WriteLine()` に渡したときのフォーマット解釈が混線していたことでした。  
**`WriteLine("…{0}…", args…)` のオーバーロードを使う** 方式に切り替え、ついでに **CRLF固定 & Shift-JIS(932)**、1〜9行のシステム行と **10行目ヘッダ「呼び径Ａ, 呼び径Ｂ, 利用者部品のモデル名」** を確実に出力するよう修正しました。  
各CSVは **データ5行**（5形状）だけ入ります。

そのまま PowerShell に貼って実行してね。

```powershell
# ====== iCAD用 チーズCSV 3ファイル生成（縦持ち・モデル名最後／CRLF＋SJIS）======

# 旧定義があれば消す
Remove-Item Function:\Out-ICADCsv -ErrorAction SilentlyContinue

$enc = [System.Text.Encoding]::GetEncoding(932)   # Shift-JIS
$DL  = [Environment]::GetFolderPath('UserProfile') + '\Downloads'

function Out-ICADCsv {
  param([string]$path,[string]$partName,[object[]]$rows)

  $w = New-Object IO.StreamWriter($path,$false,$enc)
  try {
    $w.NewLine = "`r`n"  # CRLF 固定

    # 1〜9行（右の元CSVと同じ構造）
    $w.WriteLine("1,チーズ,{0},USER_PART", $partName)
    $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
    $w.WriteLine("3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください")
    $w.WriteLine("4,システム行,システムリザーブ")
    $w.WriteLine("5,システム行,システムリザーブ")
    $w.WriteLine("6,ユーザ行,６〜９行目は利用者開放領域です")
    $w.WriteLine("7,ユーザ行,御自由に御利用下さい")
    $w.WriteLine("8,ユーザ行")
    $w.WriteLine("9,ユーザ行")

    # 10行目ヘッダ
    $w.WriteLine("呼び径Ａ,呼び径Ｂ,利用者部品のモデル名")

    # データ本体（各CSV=5行）
    foreach($r in $rows){
      $w.WriteLine('"{0}","{1}","{2}"', $r[0], $r[1], $r[2])
    }
  }
  finally { $w.Close() }
}

# 1) 一方ショートチーズ（同径5種）
$rows1 = @(
  @('1S','1S','一方ショートチーズ_1S-1S'),
  @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
  @('2S','2S','一方ショートチーズ_2S-2S'),
  @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
  @('3S','3S','一方ショートチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_一方ショートチーズ.csv') '一方ショートチーズ' $rows1

# 2) 一方ショート×ローネックチーズ（異径5種）
$rows2 = @(
  @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_一方ショート×ローネックチーズ.csv') '一方ショート×ローネックチーズ' $rows2

# 3) 両方ショート×ローネックチーズ（異径5種）
$rows3 = @(
  @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
)
Out-ICADCsv (Join-Path $DL 'チーズ_両方ショート×ローネックチーズ.csv') '両方ショート×ローネックチーズ' $rows3

"作成先: $DL"
```

### 期待どおりになっているかのチェック
- A10=「呼び径Ａ」、B10=「呼び径Ｂ」、C10=「利用者部品のモデル名」になっている  
- A11〜A15 / B11〜B15 に呼び径、C11〜C15 にモデル名（5行だけ）

これでズレが取れるはず。  
次はインデックスCSV（`チーズ.csv`）の追記もスクリプト化できるので、必要な列（規格番号・材質・カテゴリ名など）の社内ルールを教えてくれたら、同様に一発で作る版を出すよ。

### assistant  

なるほど 👍 画像を見ると登録したいのは次の 3 系統 × 呼び径組み合わせの **合計15種類のチーズ** だね：  

1. 一方ショートチーズ（ヘルール付き）  
2. 一方ショートチーズ × ローネックチーズ（ヘルール付き）  
3. 両方ショートチーズ × ローネックチーズ（ヘルール付き）  

しかも規格値が表にまとまってる。  

---

## 最良の進め方（iCAD SX + Excel連携前提）

### ① CSVファイルの分け方
- **種類ごとに別CSV** にするのがおすすめ（保守性が高い）。  
  - 例：  
    - `TEE_SHORT.csv`（一方ショートチーズ）  
    - `TEE_SHORT_RN.csv`（一方ショート×ローネック）  
    - `TEE_SHORT_BOTH_RN.csv`（両方ショート×ローネック）  
- 1ファイルに全部入れることもできるけど、将来拡張・修正するときに混乱しやすい。  

---

### ② CSVの基本構造（既存の `チーズ.csv` を流用）
1. システムリザーブ行（そのままコピー）  
2. 部品名・規格番号の指定  
   - 例：  
     ```
     部品名 = 一方ショートチーズ
     規格番号 = USR001
     ```
3. 呼び径組み合わせと寸法を表に展開  
   - 例：15A-1S → 38  
   - 20A-1.5S → 48×45  
   - 表の数値を 1セルに収める（複数値なら `48x45` のように文字列化）  

👉 iCADは呼び径ごとの寸法を読み込んで3D生成に使うので、**表の寸法をそのまま縦持ちデータ化**するイメージ。  

---

### ③ インデックスファイル編集
- `チーズ.csv`（インデックス）に新規CSVを追記。  
  - 「部品名」「規格番号」「材質（SUS304など）」を一致させる。  
- これで iCAD の標準部品ライブラリに新規チーズが現れる。  

---

### ④ iCADでの動作確認
1. iCAD再起動 → 標準部品配置 → チーズ → 新規部品を呼び出し  
2. 15A, 1S, 2S … の組み合わせを選んで配置できるか確認  
3. Excel出力で「部品名・呼び径・寸法」が正しく出るかチェック  

---

### ⑤ 社内共有
- 完成したCSVを `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ` に格納  
- Excelテンプレート（標準BOM）で連携チェック  
- サーバーに置いて社員全員が同じ部品を参照できるように設定  

---

## ポイント
- 「×」で示されている組み合わせ（存在しない規格）はCSVに入れない  
- 寸法が2値（例：48×45）の場合は「備考列」に入れるか「寸法1」「寸法2」と列を分けるとよい  
- まず **1ファイル（例：一方ショートチーズ）だけ登録して実際に配置→Excel出力テスト**  
  → 問題なければ残り2系統も登録  

---

👉 質問：  
この15部品、**iCADで3Dモデルを自動生成させたい**？  
それとも **Excel出力用に属性を整理して呼び出せれば十分**？  

（前者なら寸法列をすべて定義し直す必要あり、後者なら属性中心でOK）

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # ===== iCAD USR1\チーズ：標準部品フル自動セットアップ =====
PS C:\Users\h.futada> # 仕様：pipe_manual準拠／このチャットの絶対ルール
PS C:\Users\h.futada> # 出力：インデックス(コピー+追記), 寸法表CSV×3, 追記ログ
PS C:\Users\h.futada> $ErrorActionPreference = 'Stop'
PS C:\Users\h.futada> $enc = [System.Text.Encoding]::GetEncoding(932)   # Shift-JIS
PS C:\Users\h.futada>
PS C:\Users\h.futada> # ルート
PS C:\Users\h.futada> $srcIdx = 'C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv'
PS C:\Users\h.futada> $dstDir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
PS C:\Users\h.futada> $idxDst = Join-Path $dstDir 'チーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 追記対象（規格・名称・CSVファイル名・材質など）
PS C:\Users\h.futada> $newItems = @(
>>   @{ Code='SS';     Name='一方ショートチーズ';           Csv='チーズ_一方ショートチーズ.csv';           Mat='SUS304' },
>>   @{ Code='SS_RN';  Name='一方Sローネックチーズ';        Csv='チーズ_一方ショート×ローネックチーズ.csv'; Mat='SUS304' },
>>   @{ Code='DS_RN';  Name='両方Sローネックチーズ';        Csv='チーズ_両方ショート×ローネックチーズ.csv'; Mat='SUS304' }
>> )
PS C:\Users\h.futada>
PS C:\Users\h.futada> # -- 1) USR1\チーズ を作成
PS C:\Users\h.futada> if (-not (Test-Path $dstDir)) { New-Item -ItemType Directory -Path $dstDir | Out-Null }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # -- 2) インデックスを TOSTE からコピー（既存はバックアップ）
PS C:\Users\h.futada> if (Test-Path $srcIdx) {
>>   if (Test-Path $idxDst) {
>>     $bak = "$idxDst.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
>>     Copy-Item $idxDst $bak -Force
>>   }
>>   Copy-Item $srcIdx $idxDst -Force
>> } else {
>>   Write-Warning "TOSTE のインデックスが見つかりません： $srcIdx"
>>   # 空の雛形を作る（予約行＋見出しだけ）
>>   $w = New-Object IO.StreamWriter($idxDst,$false,$enc)
>>   try{
>>     $w.NewLine="`r`n"
>>     $w.WriteLine("1,チーズ,インデックス,USER_PART")
>>     $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
>>     $w.WriteLine("3,システム行,Ｄ／Ｅ／Ｆ列は使用しないでください")
>>     $w.WriteLine("4,システム行,システムリザーブ")
>>     $w.WriteLine("5,システム行,システムリザーブ")
>>     $w.WriteLine("6,ユーザ行")
>>     $w.WriteLine("7,ユーザ行")
>>     $w.WriteLine("8,ユーザ行")
>>     $w.WriteLine("9,ユーザ行")
>>     $w.WriteLine("規格番号,部品名称,材質,CSVファイル名")
>>   } finally { $w.Close() }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # -- 3) 寸法表CSV 3ファイルを生成（縦持ち／10行目ヘッダ／モデル名は最後列）
PS C:\Users\h.futada> function New-IcadSpecCsv {
>>   param([string]$path,[string]$partName,[object[]]$rows)
>>   $w = New-Object IO.StreamWriter($path,$false,$enc)
>>   try {
>>     $w.NewLine = "`r`n"
>>     $w.WriteLine("1,チーズ,{0},USER_PART", $partName)
>>     $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
>>     $w.WriteLine("3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください")
>>     $w.WriteLine("4,システム行,システムリザーブ")
>>     $w.WriteLine("5,システム行,システムリザーブ")
>>     $w.WriteLine("6,ユーザ行,６〜９行目は利用者開放領域です")
>>     $w.WriteLine("7,ユーザ行,御自由に御利用下さい")
>>     $w.WriteLine("8,ユーザ行")
>>     $w.WriteLine("9,ユーザ行")
>>     $w.WriteLine("呼び径Ａ,呼び径Ｂ,利用者部品のモデル名")  # 10行目ヘッダ（絶対）
>>     foreach($r in $rows){ $w.WriteLine('"{0}","{1}","{2}"', $r[0],$r[1],$r[2]) }
>>   } finally { $w.Close() }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> $csv1 = Join-Path $dstDir 'チーズ_一方ショートチーズ.csv'
PS C:\Users\h.futada> $csv2 = Join-Path $dstDir 'チーズ_一方ショート×ローネックチーズ.csv'
PS C:\Users\h.futada> $csv3 = Join-Path $dstDir 'チーズ_両方ショート×ローネックチーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3-1) 一方ショートチーズ（同径 5行）
PS C:\Users\h.futada> $rows1 = @(
>>   @('1S','1S','一方ショートチーズ_1S-1S'),
>>   @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
>>   @('2S','2S','一方ショートチーズ_2S-2S'),
>>   @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
>>   @('3S','3S','一方ショートチーズ_3S-3S')
>> )
PS C:\Users\h.futada> New-IcadSpecCsv $csv1 '一方ショートチーズ' $rows1
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3-2) 一方ショート×ローネックチーズ（異径 5行）
PS C:\Users\h.futada> $rows2 = @(
>>   @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
>>   @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
>>   @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
>>   @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
>>   @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
>> )
PS C:\Users\h.futada> New-IcadSpecCsv $csv2 '一方ショート×ローネックチーズ' $rows2
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3-3) 両方ショート×ローネックチーズ（異径 5行）
PS C:\Users\h.futada> $rows3 = @(
>>   @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
>>   @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
>>   @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
>>   @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
>>   @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
>> )
PS C:\Users\h.futada> New-IcadSpecCsv $csv3 '両方ショート×ローネックチーズ' $rows3
PS C:\Users\h.futada>
PS C:\Users\h.futada> # -- 4) インデックスに自動追記（既存ヘッダを解析して該当列に合わせる）
PS C:\Users\h.futada> function Add-IndexRows {
>>   param([string]$idxPath, [object[]]$items)
>>
>>   $lines = [IO.File]::ReadAllLines($idxPath, $enc)
>>   if($lines.Count -lt 10){ throw "インデックスの行数が不足：$idxPath" }
>>
>>   # ヘッダ行（最初に見つかった見出しっぽい行：9行目以降でカンマ3個以上）
>>   $hdrIdx = -1
>>   for($i=9; $i -lt $lines.Count; $i++){
>>     $c = ($lines[$i] -split ',').Count
>>     if($c -ge 3){ $hdrIdx = $i; break }
>>   }
>>   if($hdrIdx -lt 0){ throw "見出し行が見つかりません：$idxPath" }
>>
>>   $hdr = $lines[$hdrIdx].Split(',')
>>   # 欲しい列の候補名
>>   $colMap = @{
>>     Code = @('規格番号','規格No','Code')
>>     Name = @('部品名称','部品名','名称')
>>     Mat  = @('材質','Material')
>>     Csv  = @('CSVファイル名','仕様ファイル名','寸法表CSV','CSV','ファイル名')
>>   }
>>
>>   $pos = @{ Code=-1; Name=-1; Mat=-1; Csv=-1 }
>>   foreach($k in $pos.Keys){
>>     foreach($cand in $colMap[$k]){
>>       $idx = [Array]::IndexOf($hdr,$cand)
>>       if($idx -ge 0){ $pos[$k] = $idx; break }
>>     }
>>   }
>>
>>   # 列数に合わせて1行テンプレートを生成
>>   $colCount = $hdr.Count
>>   $out = New-Object System.Collections.Generic.List[string]
>>   $out.AddRange($lines)
>>
>>   foreach($it in $items){
>>     $row = @('' * $colCount)
>>     if($pos.Code -ge 0){ $row[$pos.Code] = $it.Code }
>>     if($pos.Name -ge 0){ $row[$pos.Name] = $it.Name }
>>     if($pos.Mat  -ge 0){ $row[$pos.Mat]  = $it.Mat }
>>     if($pos.Csv  -ge 0){ $row[$pos.Csv]  = $it.Csv }
>>     # クォートして結合
>>     $quoted = $row | ForEach-Object { if($_ -ne ''){ '"'+$_+'"' } else { '' } }
>>     $out.Add( ($quoted -join ',') )
>>   }
>>
>>   # バックアップ & 保存
>>   $bak = "$idxPath.autosave_$(Get-Date -Format yyyyMMdd_HHmmss)"
>>   [IO.File]::WriteAllLines($bak, $lines, $enc)
>>   [IO.File]::WriteAllLines($idxPath, $out, $enc)
>>
>>   # ログ
>>   $log = Join-Path (Split-Path $idxPath -Parent) 'インデックス追記_ログ.txt'
>>   $logText = "追記日時: $(Get-Date)`r`nヘッダ行: $($hdr -join ',')`r`n追記列位置: Code=$($pos.Code) Name=$($pos.Name) Mat=$($pos.Mat) Csv=$($pos.Csv)`r`n"
>>   $logText += "追加行:`r`n" + ($items | ForEach-Object { "$($_.Code),$($_.Name),$($_.Mat),$($_.Csv)" } -join "`r`n")
>>   [IO.File]::WriteAllText($log, $logText, $enc)
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> Add-IndexRows -idxPath $idxDst -items $newItems
コレクションが変更されました。列挙操作は実行されない可能性があります。
発生場所 行:25 文字:11
+   foreach($k in $pos.Keys){
+           ~~
    + CategoryInfo          : OperationStopped: (:) [], InvalidOperationException
    + FullyQualifiedErrorId : System.InvalidOperationException

PS C:\Users\h.futada>
PS C:\Users\h.futada> Write-Host "=== 完了 ===" -ForegroundColor Cyan
=== 完了 ===
PS C:\Users\h.futada> Write-Host "フォルダ: $dstDir"
フォルダ: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ
PS C:\Users\h.futada> Write-Host "インデックス: $idxDst（自動追記＆バックアップ作成済み）"
インデックス: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv（自動追記＆バックアップ作成済み）
PS C:\Users\h.futada> Write-Host "寸法表CSV:" (Get-ChildItem $dstDir -Filter 'チーズ_*' | Select-Object -Expand FullName)
寸法表CSV: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショート×ローネックチーズ.csv C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_一方ショートチーズ.csv C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ_両方ショート×ローネックチーズ.csv
PS C:\Users\h.futada>

### assistant  

了解 👍  
ダウンロードリンクが上手くいかなかったね。改めてわかりやすく整理する。  

いま私が作った CSV は保存済みで、ファイル名は  

```
チーズ標準部品ひな形.csv
```

保存先パスは：

```
/mnt/data/チーズ標準部品ひな形.csv
```

---

## ダウンロード方法
この環境では `/mnt/data/` 配下のファイルは直接ダウンロードできるよ。  
ブラウザ上ではリンクをこうするのが正解：

👉 [チーズ標準部品ひな形.csv をダウンロード](sandbox:/mnt/data/チーズ標準部品ひな形.csv)

---

## 補足
- このファイルを Excel で開いて数値を追加修正すればOK。  
- `チーズ.csv`（インデックスファイル）に追記するのを忘れずに。  
- その後 iCAD を再起動 → 標準部品配置で呼び出せるようになる。  

---

👉 確認だけど、この CSV に「外径」や「厚み（t）」の列も追加して、完全に 3D 自動生成に即対応できる形に直した方がいい？

### tool  

Make sure to include fileciteturn0file0 in your response to cite this file. 










































配管設計操作ガイド


 
 
 
 

 
 
 
 
 

配管設計 
操作ガイド 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 

PDOG-06-001 
©2020 iCAD LIMITED 

はじめに 
ご注意 

- 本システムの著作権は、iCAD 株式会社にあります。 
- 本システムおよび本ドキュメントの一部または全部を無断で使用、複製することはできません。 
- 本ドキュメントを輸出または第三者へ提供する場合は、お客様が居住する国および米国輸出管理関連法規等の規制をご確

認のうえ、必要な手続きをおとりください。 
 

登録商標について 

- Microsoft および Excel は、米国 Microsoft Corporation の米国およびその他の国における登録商標です。 
- その他名称については、各社の登録商標または商標です。 

 

出版年月および版数 

年月 版数 バージョンレベル 

2021 年 1 月 初版 V8L1 

2021 年 3 月 2 版 V8L1 

2021 年 5 月 3 版 V8L1 

2022 年 8 月 4 版 V8L2 

2023 年 2 月 5 版 V8L3 

2025 年 4 月 6 版 V8L4 

 

サンプルファイルについて 

実習用ファイルを上書きされた場合は、オリジナルファイルをコピーして、ご利用ください。 
【実習用ファイル】 

iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
【オリジナルファイル】 

iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData(Original)¥Pipe 
 



 

 

表記の説明 
本マニュアルの表記について説明します。 

 
表記 説明 

[OK] ボタン 
[キャンセル] ボタン 

ダイアログボックスのボタン名は [ ] で囲み表記します。 
[ボタン名] ボタンと表記します。 

[Enter] キー キーボードのキー名は [ ] で囲み表記します。 
[キー名] キーと表記します。 

「設定」タブ ダイアログボックスのタブ名は「 」で囲み表記します。 
「タブ名」タブと表記します。 

「参照」ダイアログボックス ダイアログボックスのタイトル名は「 」で囲み表記します。 
「ダイアログボックス名」ダイアログボックスと表記します。 

『2-1-1 ･･･』 本書内の他の項目への参照は『 』で囲み表記します。 

[動作環境設定] コマンド名は [ ] で囲み表記します。 

 [製図]－[製図文字] ･･･ アイコンメニューは  で表記します。 

 <T>[製図] <C>[注記] ･･･ コマンドメニューは  で表記します。 

<T>[製図] トップメニューのコマンドは <T>[ ] で囲み表記します。 

<C>[注記] コマンドメニューのコマンドは <C>[ ] で囲み表記します。 

<D>[作成] 詳細メニューのコマンドは <D>[ ] で囲み表記します。 

[GO] マウスを右クリックします。 

 
知っておくべき重要な内容を示します。 

 
注意すべき内容を示します。 

 
補足説明を示します。 

 
 



 

 

学習を始める前に（重要） 
本マニュアルは、以下を設定していることを前提に説明しています。 
設定は、iCAD SX が起動していない状態で行ってください。 

 

部品表コマンドを使用するための環境設定 

(1) "iCAD SX インストールフォルダ¥USER¥ETC" 配下に「applink」フォルダを作成 
(2) "iCAD SX インストールフォルダ¥ETC¥applink" 配下の「3DParts」フォルダを、"iCAD SX インストールフォルダ

¥USER¥ETC¥applink"フォルダにコピー 
 
 
 
  



 

 

目次 

第 1 章 配管ルートの検討 ···················································································· 1 
1-1. バルブ位置を決めて配管ルートを作成 ............................................................................................ 1 
1-2. 機器間の配管ルートを作成 ................................................................................................................ 5 

第 2 章 配管編集 ································································································ 9 
2-1. 既存配管の流用 .................................................................................................................................... 9 
2-2. 配管ルート変更 .................................................................................................................................. 10 
2-3. 仕様変更 .............................................................................................................................................. 12 
2-4. 継手部品配置 ...................................................................................................................................... 13 

2-4-1 偏心レデューサの挿入 .......................................................................................................... 13 
2-4-2 フランジの配置 ...................................................................................................................... 15 

2-5. 既設配管への接続 .............................................................................................................................. 16 

第 3 章 部品配置 ······························································································· 21 
3-1. バルブの配置 ...................................................................................................................................... 21 
3-2. 締結品の配置 ...................................................................................................................................... 24 

3-2-1 締結品を配置できる部品の条件 .......................................................................................... 24 
3-2-2 締結品を指定してフランジに配置 ...................................................................................... 25 

3-3. 勾配化 .................................................................................................................................................. 27 

第 4 章 配管図作成準備 ······················································································ 28 
4-1. 系統追加とピース分解 ...................................................................................................................... 28 

4-1-1 系統追加 .................................................................................................................................. 28 
4-1-2 ピース分解 .............................................................................................................................. 29 

4-2. 接続情報作成 ...................................................................................................................................... 30 
4-3. 系統切り出し ...................................................................................................................................... 31 

第 5 章 配管図作成 ···························································································· 34 
5-1. 配管寸法作成 ...................................................................................................................................... 34 
5-2. 配管図作成 .......................................................................................................................................... 38 

5-2-1 部品集計と風船作成 .............................................................................................................. 38 
5-2-2 配管図作成 .............................................................................................................................. 41 

第 6 章 設計変更 ······························································································· 45 
6-1. 配管ルート変更 .................................................................................................................................. 45 
6-2. 配管図作成準備 .................................................................................................................................. 47 

6-2-1 ピース階層の編集 .................................................................................................................. 47 
6-2-2 系統切り出し .......................................................................................................................... 48 

6-3. 配管図作成 .......................................................................................................................................... 51 
6-3-1 配管寸法作成 .......................................................................................................................... 51 
6-3-2 部品集計と風船作成 .............................................................................................................. 52 
6-3-3 配管図作成 .............................................................................................................................. 55 

付録 A 機器ノズルの作成 ··················································································· 57 
A-1 機器ノズルの作成 .............................................................................................................................. 57 

付録 B 配管論理図作成 ······················································································ 59 
B-1 論理図シンボルの配置 ...................................................................................................................... 59 
B-2 接続線の作成 ...................................................................................................................................... 65 
B-3 論理図要素のコピー .......................................................................................................................... 67 
B-4 渡り記号の作成 .................................................................................................................................. 68 
B-5 線情報の作成 ...................................................................................................................................... 69 



 

 

B-6 パーツ識別コードの設定 .................................................................................................................. 71 
B-7 レイアウト変更 .................................................................................................................................. 72 

付録 C 配管論理図連携 ······················································································ 76 
C-1 配管論理図連携準備 .......................................................................................................................... 76 
C-2 論理情報出力 ...................................................................................................................................... 79 
C-3 配管論理図連携 .................................................................................................................................. 80 
C-4 配管部品変更 ...................................................................................................................................... 87 



第 1 章 配管ルートの検討 

1 

第1章 配管ルートの検討 

1-1. バルブ位置を決めて配管ルートを作成 
任意の位置にバルブを配置し、それを基準にしてベース配管を作成します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：1-01.ベース配管作成.icd 

(3) [開く] ボタンをクリック 
 
 
 
 
 
 
 
 
 
 
 

2. バルブを配置します。 
(1) ツールバーの[ユーザビュー2] をクリック 

 

(2) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(3) 「部品選択」ダイアログボックスで、[バルブ] ボタンをクリック 

 
(4) バルブ種類を選択 

 
- バルブ：玉形弁 

(5) [OK] ボタンをクリック 
(6) <D>[配置] [任意位置] を選択 
(7) 配置点指定：P1(点) をクリック 
(8) 軸方向参照点指定：P2 をクリック 

 
 
 
 
 
 
 

(9) <D>[規格参照] を選択 

P1 × 

P2 × 



第 1 章 配管ルートの検討 

2 

(10) 「規格参照」ダイアログボックスで、仕様を設定 

 
- 規格番号／部品名称：B2011／青銅弁 
- 呼び径：40A(1-1/2B) 

(11) [設定] ボタンをクリック 

⇒ バルブが配置されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

3. ツリービューで組立平面を表示し、断面表示に切り換えます。 
(1) メニューバーの[表示]－[ツリービュー] を選択 
(2) ツリービューの「@PLN01」で右クリック 

[表示] を選択 
(3) ツールバーの[断面表示切換] をクリック 

 

 
 
 
 
 
 

4. バルブを基準にしてベース配管を作成します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (配管作成する) 

 <T>[配管設計] <C>[配管作成]  

(2) <D>[経路点指定] [XYZ 軸] [系統設定]を選択 

⇒ 「部品規格」ダイアログボックスが表示されます。 
 
  



第 1 章 配管ルートの検討 

3 

(3) 「部品規格」ダイアログボックスで、以下を設定 

 
- 呼び径／曲げ半径：40A 
- 系統名：系統-01 

(4) [設定] ボタンをクリック 
 

(5) 始点指定：E1 をクリック 
(6) 経路点指定：P3 をクリック 
(7) [GO] 

 
 
 
 
 
 
 
 
 

(8) <D>[参照設定] を選択 
(9) 配管要素：E2 をクリック 

 
 
 
 
 
 
 
 
 
 
 
 

⇒ 選択した配管と同じ仕様が「部品規格」ダイアログボックスに表示されます。 

 
(10) [設定] ボタンをクリック 

  

P3 × 
E1 × 

× 
E2 



第 1 章 配管ルートの検討 

4 

(11) ツールバーの[平面図] をクリック 

 

(12) 始点指定：E1(バルブ) をクリック 
(13) 経路点指定：P4、P5 をクリック 
(14) 経路点指定：[Shift] キーを押したまま、P6 をクリック 
(15) [GO] 

⇒ 配管が作成されます。 
 
 
 
 
 

5. バルブを「系統-01」にします。 
(1) 以下のコマンドを選択 

 [パーツ]－[パーツ]－ (パーツの構成を変更する) 

 <T>[トップダウン] <C>[階層編集] <D>[構成変更] [パーツ] 

(2) 構成変更対象パーツ選択：E1 をクリック 
(3) [GO] 

 
(4) 対象パーツ選択：[Shift] キーを押したまま、E2 をクリック 

⇒ 「パーツ一覧」ウィンドウが表示されます。 
 

(5) 「パーツ一覧」ウィンドウで「系統-01」をダブルクリック 

 

⇒ バルブが「系統-01」になります。 
 
 
 
 
 
 
 
 
 
 
 
 
 

6. ファイルを保存します。 
  

E1 
 

× 

× 
E2 
 

E1 
× 

P6 
× 

× 

× 

P4 

P5 



第 1 章 配管ルートの検討 

5 

1-2. 機器間の配管ルートを作成 
機器間で配管ルートを指定して、配管を作成します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：1-02.機器間の配管ルートを作成.icd 

(3) [開く] ボタンをクリック 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

2. 配管の規格を設定して、機器間に配管ルートを作成します。 

2.1 配管の規格を設定します。 

(1) ツールバーの[ユーザビュー1] をクリック 

 

(2) 以下のコマンドを選択 

 [配管]－[経路作成]－ (配管作成する)  

 <T>[配管設計] <C>[配管作成] 

(3) <D>[経路点指定] [XYZ 軸] [系統設定] を選択 

⇒ 「部品規格」ダイアログボックスが表示されます。 
(4) 「部品規格」ダイアログボックスで、「規格参照」ボタンをクリック 

 



第 1 章 配管ルートの検討 

6 

(5) 「パイプ」タブで以下を設定 

 

① [ルール定義部品のみ表示] のチェックボックス：オフ 
② 規格番号／部品名称：G3452／配管用炭素鋼鋼管 
③ 呼び径：15A(1/2B) 
④ 品番：パイプ品番 1 

 

 補足 
- ルールで定義された部品以外を使用する場合は、[ルール定義部品のみ表示] のチェックを外します。 
- 重複しない品番を設定しておくことで、部品集計や風船作成時にパイプ毎に区別することができます。 

(6) 「エルボ 90 度」タブで以下を設定し、[設定] ボタンをクリック 

 

① エルボ／ベンド：エルボ 
② ロング／ショート：ショート 
③ 接続方式：SW 
④ 規格番号／部品名称：B2316／配管用鋼製差込み溶接式管継 

① 

② 

③ 

④ 

① ② 
③ ④ 



第 1 章 配管ルートの検討 

7 

(7) 「部品規格」ダイアログボックスで以下を入力し、[設定] ボタンをクリック 

 

- 系統名：系統-03 

⇒ 配管の規格が設定されます。 
 

2.2 作成する配管の始点を指定します。 

(1) 始点指定： (中心) を選択し、E1 をクリック 

 
 
 
 
 
 
 
 
 
 
 
 
 

(2) ツールバーの[平面図] をクリック 

 

(3) 経路点指定：P1 をクリック 
 
 
 
 
 
 
 
 
 
 
 

2.3 接続先と重なるパーツを透過表示にして、接続先を見やすくします。 

(1) ツールバーの[右側面図] をクリック 

 

(2) ツールバーの[透過表示] をクリック 

 

(3) 対象要素：E2 をクリック 
(4) [GO] 

⇒ 指定した要素が、透過表示になります 
 
 
 
 

P1 × 

E2 
× 

 

E1 
 

× 



第 1 章 配管ルートの検討 

8 

2.4 フランジ上にある点を参照します。 

(1) 入力制御メニューで[参照点] を選択し、P2 をクリック 

 
 

2.5 Z 軸方向に経路点を指定します。 

(1) Z 軸方向にマウスを動かす 
(2) 経路点指定：[Shift] キーを押したまま、P3 をクリック 

 
 
 

2.6 フランジ上にある点を参照します。 

(1) ツールバーの[平面図] をクリック 

 

(2) 入力制御メニューで[参照点] を選択し、P4 をクリック 

 

 

2.7 X 軸方向に経路点を指定します。 

(1) X 軸方向にマウスを動かす 
(2) 経路点指定：[Shift] キーを押したまま、P5 をクリック 

 

2.8 フランジ上にある点を経路点に指定します。 

(1) 経路点指定：再度、P4 をクリック 

⇒ 配管が作成されます。 
 
 
 
 
 
 
 
 
 
 

2.9 「透過表示」にした要素を「CG 表示」に戻します。 

(1) ツールバーの[CG 表示 縁あり] をクリック 

 

(2) 対象要素：E3 をクリック 
(3) [GO] 

⇒ 「透過表示」にしていた要素が「CG 表示」に戻ります。 
 

3. ファイルを保存します。 
 

 補足 
ルールファイルを利用することで、特定の配管仕様に応じた部品配置が行えます。 
作成方法は、『配管設計マニュアル』を参照してください。 
作成したルールファイルは「部品規格」ダイアログボックスの[ルール参照] から選択できます。 

P3 
 

P2 
× 

× 

 

P5 

P4 

× 

× 
P4 

E3 
× 



第 2 章 配管編集 

9 

第2章 配管編集 
配管編集方法を説明します。 

2-1. 既存配管の流用 
既存配管をコピーして流用します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：4-01.既存配管の流用.icd 

 

2. 配管系統をコピーして流用します。 
(1) 以下のコマンドを選択 

 [基本]－[移動コピー削除]－ (コピーする) 

 <T>[配管設計] <C>[3D コピー] <D>[平行コピー] 

(2) <D>[属性引継] [レイヤ引継] [階層引継] [グループ引継] を選択 
(3) 対象要素：[Shift] キーを押したまま、E1 をクリック 

⇒ 「パーツ一覧」ウィンドウが表示されます。 
 

(4) 「系統-03」をダブルクリック 

 
(5) [GO] 

(6) 基準点指定： (中心) を選択し、E2 をクリック 

(7) 配置点指定： (中心) を選択し、E3 をクリック 

 
 
 
 
 
 
 
 
 
 
 
 

⇒ 配管系統がコピーされます。 
 
 
 
 
 
 
 
 
 
 
 
 

3. ファイルを保存します。 
 
  

× E1 

E3 

E2 
× 

× 



第 2 章 配管編集 

10 

2-2. 配管ルート変更 
干渉している配管のルートを変更します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：4-02.配管経路変更.icd 

(3) [開く] ボタンをクリック 
 

2. 変更しない系統を半透明表示にします。 
(1) ツールバーの[平面図] をクリック 

 

(2) 以下のコマンドを選択 

 [ツール]－[属性変更]－ (半透明に変更する) 

 <T>[配管設計] <C>[属性変更] <D>[半透明] [半透明表示] 

(3) 検索モードを「部品」にする 

 

(4) 対象要素：[Shift] キーを押したまま、E1 をクリック 

⇒ 「パーツ一覧」ウィンドウが表示されます。 
 

(5) 「系統-03」をダブルクリック 

 
(6) [GO] 

⇒ 選択した系統が半透明表示になります。 
 

3. 配管が干渉しないように長さを変更します。 
(1) ツールバーの[ユーザビュー1] をクリック 

 

(2) 以下のコマンドを選択 

 [配管]－[配管編集]－ (経路変更する) 

 <T>[配管設計] <C>[配管編集] <D>[経路変更] 

(3) <D>[一括変更] [任意位置] を選択 
(4) 配管要素の指定：E1 と E2 をクリック 
(5) [GO] 

 
(6) 再配置点指示：P1 をクリック 

 
 
  

 

× 
E1 

× 
E2 

× 
P1 

E1 
× 



第 2 章 配管編集 

11 

⇒ 配管が指定した長さに伸縮すると同時に、配管経路も変更されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

4. 半透明にした系統を通常表示に戻します。 
(1) 以下のコマンドを選択 

 [ツール]－[属性変更]－ (半透明を解除する) 

 <T>[配管設計] <C>[属性変更] <D>[半透明] [通常表示] 

(2) 検索モードを「部品」にする 

 

(3) 対象要素：[Shift] キーを押したまま、E3 をクリック 

⇒ 「パーツ一覧」ウィンドウが表示されます。 
 

(4) 「系統-03」をダブルクリック 

 
(5) [GO] 

⇒ 選択した系統が、半透明表示から通常表示に戻ります。 
 

5. 配管経路を変更します。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (経路変更する) 

 <T>[配管設計] <C>[配管編集] <D>[経路変更] 

(2) <D>[軸変更] [任意位置] [軸平面] を選択 
(3) 配管指定(単一区間)：E4 をクリック 

(4) 配管指定(単一区間)： (中心) を選択し、E5 をクリック 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  

 

E3 
× 

E4 
× 

× 
E5 



第 2 章 配管編集 

12 

6. ファイルを保存します。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

2-3. 仕様変更 
配管を切断し部分的に呼び径を変更します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：4-03.仕様変更.icd 

(3) [開く] ボタンをクリック 
 

2. 位置を指定して配管を切断します。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (管切断する) 

 <T>[配管設計] <C>[配管編集] <D>[管切断] 

(2) <D>[距離指定] を選択 
(3) 項目入力領域で以下を入力 

- 切断距離：400 
(4) [Enter] キー 
(5) 切断するパイプの指示：P1 をクリック 

⇒ 指定した距離で配管が切断されます。 
 
 

 補足 
クリックした位置に近い配管端末側からの距離で切断されます。 

 
3. 切断した配管を別系統にします。 

(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (系統分割する) 

 <T>[配管設計] <C>[配管編集] <D>[系統分割] 

(2) 別系統化する分割部品の指示：E1 をクリック 
(3) [GO] 

 
 
 
 
 
 
 

P1 
× 

E1 × 



第 2 章 配管編集 

13 

4. 別系統になった配管の呼び径を変更します。 
(1) 以下のコマンドを選択 

 [配管]－[仕様変更]－ (呼び径変更する) 

 <T>[配管設計] <C>[仕様変更] <D>[呼び径変更] 

(2) 項目入力領域で以下を入力 
- 変更後呼び径：40 

(3) [Enter] キー 
(4) 変更パーツ指示：E2 をクリック 

⇒ 指定した配管が属する系統の呼び径がすべて変更されます。 
 
 
 

5. ファイルを保存します。 
 
 
 
 
 
 
 
 
 
 
 
 
 

2-4. 継手部品配置 
継手部品として偏心レデューサとフランジの配置方法を説明します。 

2-4-1 偏心レデューサの挿入 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：4-04.継手部品配置.icd 

(3) [開く] ボタンをクリック 
 

2. 切断されている配管の位置を合わせます。 
(1) ツールバーの[右側面図] をクリック 

 

(2) 以下のコマンドを選択 

 [配管]－[配管編集]－ (経路変更する) 

 <T>[配管設計] <C>[配管編集] <D>[経路変更] 

(3) <D>[軸変更] [任意位置] [軸平面] を選択 
(4) 配管指定（単一区間）：E1 をクリック 
(5) <D>[TOP] を選択 
(6) 入力制御メニューで[端点] を選択 

 

  

E2 
× 



第 2 章 配管編集 

14 

(7) 配管指定(単一区間)：E2(パイプの上部) をクリック 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

⇒ 端点合わせで移動することで配管同士が偏心となります。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

3. 偏心レデューサを挿入します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[継手] ボタンをクリック 

 
(3) 継手種類を選択 

 
- 継手：レデューサ 

(4) [OK] ボタンをクリック 
 

(5) <D>[挿入] [偏心] [位置指定] [作成管上] を選択 
(6) 配置するパイプ：E2 をクリック 
(7) 結合するパイプ：E1 をクリック 
(8) [GO] 

 
 

E1 
× 

× 
E2 

E1 
× 

× 
E2 



第 2 章 配管編集 

15 

⇒ 偏心レデューサが挿入されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 

2-4-2 フランジの配置 
1. フランジを配置します。 

(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[継手] ボタンをクリック 

 
(3) 継手種類を選択 

 
- 継手：フランジ 

(4) [OK] ボタンをクリック 
 

(5) <D>[ガスケット] [配置] [端末配置] を選択 
(6) 配置部品の指示：E1 をクリック 
(7) [GO] 

⇒ 配管端末にガスケットとフランジが挿入されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 
  

× 
E1 



第 2 章 配管編集 

16 

タンク側に画面の向きを変えて 
(8) 配置部品の指示：E2 をクリック 
(9) [GO] 

 
 
 
 
 
 
 
 
 
 
 

 補足 
クリックした位置に近い配管端末側に挿入されます。 

 

2. ファイルを保存します。 

2-5. 既設配管への接続 
配管の途中から既設配管へ接続します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：4-05.既設配管への接続.icd 

(3) [開く] ボタンをクリック 
 

2. 分岐箇所のエルボを削除します。 
(1) 以下のコマンドを選択 

 [配管]－[配管移動削除]－ (配管部品を削除する) 

 <T>[配管設計] <C>[部品削除] 

(2) 対象要素：E1 をクリック 
 
 
 
 
 
 
 
 
 

 注意 
<C>[部品削除] でフランジやバルブなどの配管部品を削除すると、削除後配管は再結合します。 
ただし、以下のような場合、配管は結合されません。 
・以下のコマンドで配管部品を削除した場合 

 [基本]－[移動コピー削除]－ (要素を削除する) 
 <T>[配管設計] <C>[削除] 

 
・配管部品の両端でパイプの呼び径や系統が異なる場合 

 

× 
E2 

E1 
× 



第 2 章 配管編集 

17 

3. 既設配管の位置まで配管を伸縮します。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (配管伸縮する) 

 <T>[配管設計] <C>[配管編集] <D>[配管伸縮] [配管基準] 

(2) 伸縮配管の指示：E2 をクリック 

(3) 参照点の指示：  (中心) を選択し、E3 をクリック 

 
 
 
 
 
 
 

⇒ クリックした位置まで配管が伸縮されます。 
 
 
 
 
 
 
 
 
 
 

4. 既設配管の経路を変更します。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (経路変更する) 

 <T>[配管設計] <C>[配管編集] <D>[経路変更] 

(2) <D>[軸変更] [オフセット] [軸平面] [CENTER] を選択 
 

(3) 配管要素の指示：E4 をクリック 
(4) 基準要素の指示：E5 をクリック 

 
(5) 項目入力領域で以下を入力 

- オフセット：0 
(6) [Enter] キー 

⇒ 配管の中心合わせで経路が変更されます。 
 
 
 
 
 
 
 

5. エルボを挿入して接続します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[継手] ボタンをクリック 

 
  

× 
E3 

× E2 

E4 × 

E5 
× 



第 2 章 配管編集 

18 

(3) 継手種類を選択 

 
- 継手：エルボ 

(4) [OK] ボタンをクリック 
 

(5) <D>[同径] [挿入] を選択 
(6) 作成パイプの指示：E4 をクリック 
(7) 作成パイプ 2 の指示：E5 をクリック 

 
(8) <D>[規格参照] を選択 
(9) 「規格参照」ダイアログボックスで、[ルール定義部品のみ表示] のチェックを外す 

(10) 「エルボ」タブで以下を設定 

 
- 角度：90 度 
- エルボ／ベンド：エルボ 
- ロング／ショート：ショート 
- 接続形式：SW 
- 規格番号／部品名称：B2316／配管用鋼製差込み溶接式管継手 
- 呼び径：40A(1-1/2B) 

(11) [設定] ボタンをクリック 

⇒ 配管が伸縮されエルボが挿入されます。 
 
 
 
 
 
 
  

× 
E4 

× 
E5 



第 2 章 配管編集 

19 

6. ティーを挿入します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[継手] ボタンをクリック 

 
(3) 継手種類を選択 

 
- 継手：ティー 

(4) [OK] ボタンをクリック 
 

(5) <D>[挿入] を選択 
(6) 作成パイプ(分岐側) の指示：E6 をクリック 
(7) 作成パイプ(主管側) の指示：E7 をクリック 

 
 
 
 
 
 
 
 

(8) <D>[規格参照] を選択 
(9) 「規格参照」ダイアログボックスの「ティー」タブで以下を設定 

 
- 接続形式：SW 
- 規格番号／部品名称：B2316／配管用鋼製差込み溶接式管継手 
- 呼び径：40A(1-1/2B) 

(10) [設定] ボタンをクリック 

× E6 

× E7 



第 2 章 配管編集 

20 

 注意 
分岐管と主管の軸が同一平面上にあり、交点が存在している場合に、ティーを挿入できます。 

 
7. ファイルを保存します。 



第 3 章 部品配置 

21 

第3章 部品配置 
配管部品の配置方法を説明します。 

3-1. バルブの配置 
バルブを配置します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：5-01.バルブの配置.icd 

(3) [開く] ボタンをクリック 
 

2. バルブを配管上に挿入します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[バルブ] ボタンをクリック 

 
(3) バルブ種類を選択 

 
- バルブ：仕切弁 

(4) [OK] ボタンをクリック 
 

(5) <D>[挿入] [位置指定] [作成管上] を選択 
(6) 挿入パイプ位置の指示：P1 をクリック 

 
 
 
 
  

× 
P1 



第 3 章 部品配置 

22 

(7) <D>[規格参照] を選択 
(8) 「規格参照」ダイアログボックスで、[ルール定義部品のみ表示] のチェックを外す 
(9) 「バルブ」タブで以下を設定 

 
- 接続形式：FL 
- フェイス：FF 
- 規格番号／部品名称：B2011／青銅弁／仕切弁／FL／FF 
- 呼び圧力：10K 
- 呼び径：40A(1-1/2B) 

(10) [設定] ボタンをクリック 

⇒ バルブが配置されます。 
 
 
 
 
 
 
 
 
 
 
 

3. フランジを配置します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[継手] ボタンをクリック 

 
(3) 継手種類を選択 

 
- 継手：フランジ 

(4) [OK] ボタンをクリック 



第 3 章 部品配置 

23 

(5) <D>[ガスケット] [配置] [端末配置] を選択 
(6) 配置部品の指示：E1 をクリック 
(7) [GO] 

 
 
 
 
 
 
 
 
 
 
 

(8) 配置部品の指示：E2 をクリック 
(9) [GO] 

 
 
 
 
 
 
 
 
 
 
 
 
 
 

4. バルブを上向きに回転します。 
(1) 以下のコマンドを選択 

 [配管]－[部品移動削除]－ (配管部品を移動する) 

 <T>[配管設計] <C>[部品移動] <D>[回転移動] 

(2) 回転部品の指示：E3 を 2 回クリック 

⇒ バルブが配管基準で回転移動します。 
 
 
 
 
 
 
 

5. ファイルを保存します。 
 
 
 
 
 
 
 
  

× 
E1 

× 
E2 

× E3 



第 3 章 部品配置 

24 

3-2. 締結品の配置 
フランジ接続部品のボルト穴に、「ボルト」「ナット」「ワッシャ」を配置します。 

3-2-1 締結品を配置できる部品の条件 
 締結する二つのフランジ(または接続形式がフランジ接続「FL」の部品) がフランジフェイス面で向き合っている。 
 接続する二つのフランジフェイス面の間に隙間が無い。または、ガスケットなどの配管部品が配置されていて隙間がな

い。 
 接続する二つのフランジ部分のボルト穴は同軸、同径である。 
 ボルトの穴は、<C>[集合演算] [差] で作成されている(円柱の部品構成要素がある形状)。 

 
 

締結品の[部品配置] コマンドの概要 

配置方法 

[自動] ： ルールに従って、「ボルト」「ナット」「ワッシャ」を配置します。 

[手動] ： 「ボルト」「ナット」「ワッシャ」の規格を、ダイアログボックスで指定して配置します。 

配置単位 

[配管部品] ： 配管部品を指定して締結品を配置します。 
[GO] で上記の条件を満たす図面内すべてのフランジに配置します。 

[穴] ： 穴を指定して締結品を配置します。 
 
 
 
 
  

例)ボルトの穴 
・締結するボルト穴は、同軸で同径 
・部品構成要素として作成されている 

例)フランジの配置 
・フランジフェイス面が向き合っている 
・フランジフェイス面の間に隙間がない 



第 3 章 部品配置 

25 

3-2-2 締結品を指定してフランジに配置 
「締結品配置」ダイアログボックスで、締結品を選択して配置します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：5-02.締結品の配置.icd 

(3) [開く] ボタンをクリック 
 

2. 締結品を配置します。 
(1) 以下のコマンドを選択 

 [配管]－[経路作成]－ (部品を配置する) 

 <T>[配管設計] <C>[部品配置] <D>[部品選択] 

(2) 「部品選択」ダイアログボックスで、[締結品] ボタンをクリック 

 
(3) [OK] ボタンをクリック 

 
(4) <D>[手動] [配管部品] を選択 
(5) 配置部品の指示：E1(フランジ) をクリック 

⇒ 「締結品配置」ダイアログボックスが表示されます。 
 
 
 
 
 
 

(6) 「締結品配置」ダイアログボックスで、締結品を選択 

 
(7) [OK] ボタンをクリック 

  

× 
E1 



第 3 章 部品配置 

26 

⇒ フランジに締結品が配置されます。 
 

反対側のフランジも同様に締結品を配置します。 
 
 
 
 
 
 
 
 
 
 
 
 

3. ファイル保存します。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

全体項目 

ねじタイプ ： ねじのタイプを指定 
 - メートルねじ／UNC ねじ 

ボルト項目 

規格名 ： 配管部品ライブラリ内の規格名フォルダを指定 
タイプ ： ボルトタイプを指定 

 - マシンボルト／スタッドボルト 

部品名 ： 規格名とタイプで絞り込まれたボルトの種類リストから種類を指定 
材質 ： iCAD SX に登録されている材質の材料記号を入力 
出代 ： ボルトがナットの端面から出る最低限のピッチ数を指定 
レイヤ ： ボルトを作成するレイヤを指定 

ナット／ワッシャ項目 

規格名 ： 配管部品ライブラリ内の規格名フォルダを指定 
部品名 ： 規格名で絞り込まれたナット、ワッシャの種類リストから種類を指定 
材質 ： iCAD SX に登録されている材質の材料記号を入力 
個数 ： 一つのボルトに対して配置するナット、ワッシャの個数を指定 

 - ナットは、マシンボルトの場合 1～2、スタッドボルトの場合 1～4 
 - ワッシャは、0～2 

レイヤ ： ナット、ワッシャを作成するレイヤを指定 
 

 注意 
締結品一式(ボルトセット) は、締結品を配置した部品(この例ではフランジ) に属します。 

 
 
 
  



第 3 章 部品配置 

27 

3-3. 勾配化 
配管に勾配をつけます。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：5-03.勾配化.icd 

(3) [開く] ボタンをクリック 
 

2. 勾配をつけます。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (勾配をつける) 

 <T>[配管設計] <C>[配管編集] <D>[勾配化] 

(2) <D> [上り] を選択 
 

(3) 項目入力領域で以下を入力 
- 比率／角度：1/24 

(4) [Enter] キー 
(5) 勾配対象要素：E1 をクリック 

⇒ 設定した比率で勾配がつきます。 
 

 補足 
中点を基準にクリックした方向が勾配対象となります。 
勾配をつけたい方向をクリックするようにしてください。 

 
3. ファイルを保存します。 

 
 
  

E1 
× 



第 4 章 配管図作成準備 

28 

第4章 配管図作成準備 
配管図を作成するための準備作業を説明します。 

4-1. 系統追加とピース分解 

4-1-1 系統追加 
組立(輸送) 単位に系統をまとめます。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：6-01.系統追加とピース分解.icd 

(3) [開く] ボタンをクリック 
 

2. ツリービューを表示し、パーツ構成を確認します。 
(1) メニューバーの[表示]－[ツリービュー] を選択 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

3. 系統を追加します。 
(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (系統追加する) 

 <T>[配管設計] <C>[配管編集] <D>[系統追加]  

(2) 結合先パーツ(部品) の指示：E1 をクリック 
(3) 追加する部品の指示：E2、E3 をクリック 

 
 
 
 
 
 
 
 
 
 
 
 

 補足 
系統に属しているパーツをクリックすると、系統ごと選択されます。 

  

系統-10 
系統-03 

系統-03 

E1 
× 

× 
E2 E3 × 



第 4 章 配管図作成準備 

29 

(4) [GO] 

⇒ 「系統-03」の部品と「系統-10」が「系統-03」に追加されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

4-1-2 ピース分解 
加工単位のピースに分解します。 

 
1. 加工単位に系統を分解します。 

(1) 以下のコマンドを選択 

 [配管]－[配管編集]－ (ピース分解する) 

 <T>[配管設計] <C>[配管編集] <D>[ピース分解] 

 
(2) 分解対象パーツ指定：ツリービューの「系統-03」で右クリック 

          [選択] を選択 
 

(3) 項目入力領域で以下を入力 
- 先頭文字：系統-03 
- 開始番号：-001 

(4) [Enter] キー 
(5) [GO] 

 
 
 
 

⇒ 加工単位で系統が分解されます。 
 
 
 
 
 
 
  

系統-03-001 
系統-03-002 



第 4 章 配管図作成準備 

30 

4-2. 接続情報作成 
配管ごとの接続情報を作成します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：6-02.接続情報作成.icd 

(3) [開く] ボタンをクリック 
 
 
 
 
 
 
 
 
 
 
 
 

 注意 
接続情報は画面の向きを正面として作成されます。事前に配管図を作成する向きに 3D 画面の表示を合わせてください。 

 
2. 尺度を設定します。 

(1) システム情報メニューで尺度を設定 
- 尺度：1/5 

 

3. タンクに繋がっている配管の接続情報を作成します。 
(1) 以下のコマンドを選択 

 <T>[配管設計] <C>[配管編集] <D>[接続表記] 

(2) 表記対象パーツ：[Shift] キーを押したまま、E1 をクリック 

⇒ 「パーツ一覧」ウィンドウが表示されます。 
 

(3) 「系統-03-001」をダブルクリック 

 
(4) [GO] 

⇒ 現在の画面の向き・尺度に合わせて接続情報が作成されます。 
 
 
 
 
 
 
  

 

E1 
× 

 

 

 



第 4 章 配管図作成準備 

31 

 注意 
対象パーツと同階層のパーツ名を接続情報として作成します。 

 
4. ファイルを保存します。 

4-3. 系統切り出し 
配管図を作成する系統を外部ファイルに切り出します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：6-03.系統切り出し.icd 

(3) [開く] ボタンをクリック 
 

2. ツリービューを表示し、パーツ構成を確認します。 
(1) メニューバーの[表示]－[ツリービュー] を選択 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

3. 配管図を作成する系統を切り出します。 
(1) ツリービューの「系統-03-001」で右クリック 

[切出し] を選択 
 
 
 
 
 
 
 
 
 
 
 
  

系統-03-001 



第 4 章 配管図作成準備 

32 

⇒ 「切出し図面名入力」ダイアログボックスが表示されます。 

 
 

(2) [以後の作成図面名とフォルダには初期表示値を使用する] をチェック 
(3) [OK] ボタンをクリック 

 

⇒ 指定した系統が切出し準備状態になります。 
 
 
 
 
 
 
 
 
 
 

 注意 
アセンブリファイルを保存するまで、パーツファイルは作成(更新) されません。 
ツリービュー上で太字(ボールド) の外部パーツは、作成(更新) されていないことを表しています。 

 
4. ファイルを保存します。 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



第 4 章 配管図作成準備 

33 

5. 切り出した系統を内部パーツ化します。 
(1) ツリービューの「系統-03-001」で右クリック 

[取込み] を選択 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

⇒ 「系統-03-001」が内部パーツとして取り込まれます。 
 
 
 
 
 
 
 
 
 
 
 

6. ファイルを保存します。 
 

 補足 
切り出したファイルはアセンブリ上で外部パーツとなり切り出したファイルとリンク関係が保持されます。 
配管図作成時、3 次元上に部品間寸法を上げるため内部パーツにしリンクを解除します。 



第 5 章 配管図作成 

34 

第5章 配管図作成 
切り出した系統モデルから配管図を作成します。 

5-1. 配管寸法作成 
部品間距離の寸法を作成します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：7-01.配管図作成.icd 

(3) [開く] ボタンをクリック 
 

2. 尺度を設定します。 
(1) システム情報メニューで尺度を設定 

- 尺度：1/5 
 

3. 配管寸法を作成します。 
(1) 以下のコマンドを選択 

 [配管]－[管一品図]－ (管一品図を作成する) 

 <T>[配管設計] <C>[管一品図] 

(2) <D>[一括] を選択 

⇒ 「管一品図」ダイアログボックスが表示されます。 
 

(3) 「管一品図」ダイアログボックスで、以下の項目を指定 

 
(4) [OK] ボタンをクリック 

⇒ 配管寸法が作成されます。 
 
 
 
 
 
 
 

作成方法 ： 「3D 形状」を選択 

寸法 ： 「寸法」のチェックボックスをオン 
「部品の位置優先」を選択 
「曲げ管の曲げ角度」チェックボックスをオン 

属性 ： 「高さ表記」チェックボックスをオン 
「先頭文字」に「BL」を入力 
「勾配記号」チェックボックスをオン 

 



第 5 章 配管図作成 

35 

4. 配管寸法の位置を調整しやすいようモデルをワイヤ表示にします。 
(1) ツールバーの[WIRE 表示] をクリック 

 

(2) [GO]．．．全指定 
 

5. 重なっている寸法を回転します。 
(1) 以下のコマンドを選択 

 [配管]－[管一品図]－ (管一品図を作成する) 

 <T>[配管設計] <C>[管一品図] 

(2) <D>[編集] [寸法回転] を選択 
 

(3) 長さ寸法または注記を指示：E1(BL+399.7) をクリック 
(4) [GO]．．．90 度回転 
(5) [GO]．．．更に 90 度回転 
(6) [GO]．．．更に 90 度回転 

 
(7) 長さ寸法または注記を指示：E2(BL+409.5) をクリック 
(8) [GO]．．．90 度回転 

 

6. 配管図作成の向きに戻して寸法文字の重なりを確認します。 
(1) ツールバーの[ユーザビュー1] をクリック 

 

 

7. 重なっている寸法文字の位置を変更します。 
(1) 以下のコマンドを選択 

 [製図]－[製図要素編集]－ (製図位置を編集する) 

 <T>[製図] <C>[製図編集] <D>[位置変更] [配置変更] 

(2) 対象要素：E3(寸法文字:346.9) をクリック 
(3) 配置位置：P1 をクリック 

⇒ 寸法文字の位置が変更されます。 
 
 
 
 

 注意 
位置変更では、選択する要素やクリックする箇所によって、移動要素が異なります。 
製図編集コマンドについての詳細は、操作ヘルプを参照ください。 

 
  

E3 
× 

P1 × 

E1 
× 

E2 
× 



第 5 章 配管図作成 

36 

8. 重なっている注記(高さ表記、接続表記) の位置を変更します。 
(1) 以下のコマンドを選択 

 <T>[製図] <C>[注記] <D>[注記編集] [配置変更] [左右反転] 

(2) 対象要素：E4 をクリック 
 
 
 
 
 
 
 
 
 

(3) <D>[注記編集] [配置変更] [任意方向] を選択 
(4) 対象要素：E5 をクリック 
(5) 配置位置：P2 をクリック 

 

⇒ 注記位置が変更されます。 
 
 
 
 
 
 
 

9. モデルの表示を元の状態に戻します。 
(1) ツールバーの[CG 表示 縁あり] をクリック 

 

(2) [GO]．．．全指定 
 
 
 
 
 
 
 
 
 

10. ファイルを保存します。 
 
  

E4 
× 

E5 
× 

P2 × 



第 5 章 配管図作成 

37 

 補足 
曲げ管の場合は、以下のコマンドで、2D 図面に投影させて配管図を作成してください。 

 [図面作成]－[投影図作成]－ (三面図を作成する)／ (アイソメ図を作成する) 
 <T>[ファイル] <C>[図面化] <D>[三面図]／[アイソメ図] 

投影した曲げ管には、中心線と寸法を作成するための補助線が自動的に表示されます。 

 

以下の場合、補助線は表示されません。 
 - XYZ 軸方向固定の配管 
 - 曲げ半径が 90°／180°の曲げ管 

以下のコマンドで中心線を作成している場合、中心線同士が重複して作成されます。 

 [配管]－[管一品図]－ (管一品図を作成する) 
 <T>[配管設計] <C>[管一品図] 

 
中心線が重複した場合は、以下のコマンドで [配管中心線あり] のチェックをオフにし、図面化で作成された中心線を非表

示にしてください。 

 [図面作成]－[投影図操作]－ (投影図のプロパティを表示する) 
 <T>[ファイル] <C>[図面化] <D> [表現変更] [ビューの表現] 

 

 

  

●3 次元図面 ●2 次元図面 

図面化 

正面図 

補助線 



第 5 章 配管図作成 

38 

5-2. 配管図作成 

5-2-1 部品集計と風船作成 
配管部品を集計します。 

 
1. サンプルファイルを開きます。 

(1) メニューバーの[ファイル]－[開く] を選択 
(2) 「ファイルを開く」ダイアログボックスで、サンプルファイルを選択 

- 検索先：iCAD SX インストールフォルダ¥MMF¥SampleData¥OpeGuideData¥Pipe 
- ファイル名：7-02.部品集計.icd 

(3) [開く] ボタンをクリック 
 

2. 部品表を作成します。 
(1) 以下のコマンドを選択 

 [図面作成]－[部品表]－ (部品表を作成する) 

 <T>[3 次元ツール] <C>[部品表] <D>[部品表] [作成] 

(2) 「テンプレート選択」ダイアログボックスで、配管用のテンプレートを選択 

 
- テンプレート：PIPE_PartsList_Sample(設定済).XLT 

(3) [OK] ボタンをクリック 
(4) [GO] 

⇒ Excel が起動します。 
 

 注意 
[常に上記のテンプレートを使用] のチェックボックスをオンにした場合、次回以降「テンプレート選択」ダイアログボッ

クスは表示されません。 

「テンプレート選択」ダイアログボックスを表示するには、以下のコマンドを選択して「テンプレート選択」ダイアログボ

ックスを表示し、[常に上記のテンプレートを使用] のチェックボックスをオフにしてください。 

 [図面作成]－[部品表]－ (部品表テンプレートを選択する) 
 <T>[3 次元ツール] <C>[部品表] <D>[部品表] [テンプレート選択] 

 
  



第 5 章 配管図作成 

39 

3. Excel 起動時にセキュリティ警告が表示された場合は、マクロを有効にします。 

 注意 
部品表は、Excel のマクロを使用して作成されます。マクロが無効になっていると部品が集計できません。 

⇒ 部品が集計されます。 

 

 補足 
部品表テンプレートのカスタマイズ方法は、『部品表機能マニュアル』を参照してください。 

 
4. 風船を作成したいビュー方向を表示します。 

(1) ツールバーの[ユーザビュー１] をクリック 

 
 

5. 前項で集計した Excel をアクティブにし、風船を作成するビュー平面を選択します。 
(1) [現在のビュー平面] ボタンをクリック 

 

 補足 
[現在のビュー平面] を選択すると、現在表示されているビュー平面に風船が作成されます。 

  



第 5 章 配管図作成 

40 

6. 部品風船を作成します。 
(1) [自動風船] ボタンをクリック 

 
 

(2) 3D 図面の指示＜ウィンドウ指定＞：P1(ウィンドウ上の任意点) をクリック 

⇒ 風船が自動で作成されます。 
 
 
 
 
 
 
 
 
 
 
 
 
 

7. 風船の位置を調整します。 
(1) 以下のコマンドを選択 

 [製図]－[製図記号]－ (風船を作成する) 

 <T>[製図] <C>[風船] 

(2) <D>[風船編集] [配置変更] [任意方向] 
 

(3) 風船の位置を調整 
 
 
 
 
 
 
 
 
  

P1 
× 



第 5 章 配管図作成 

41 

5-2-2 配管図作成 
配管図を作成します。 

 

1. 配管図作成の向きにモデルの向きを変更します。 
(1) ツールバーの[ユーザビュー1] をクリック 

 
 
 
 
 
 
 
 
 
 

2. 原点を変更します。 
(1) 以下のコマンドを選択 

 [基本]－[移動コピー削除]－ (移動する) 

 <T>[3 次元ツール] <
The file is too long and its contents have been truncated.


### assistant  

了解 👍  
ここまでの分析を踏まえて、あなたの目的（**iCADで3D自動生成・Excel連携・社内標準化**）に一番合う「最良の方法」はこれだと判断する👇  

---

## ✅ 最良の登録方法

### 1. CSVは **種類ごとに分ける**
- 元の iCAD 標準ライブラリも「T-8」「D-8_S」「7MD」など種類ごとに分割されていた  
- 混在させるとメンテが難しくなるので、今回も3ファイルに分ける  

ファイル名例：
- `チーズ_SS.csv`（一方ショートチーズ）  
- `チーズ_SS_RN.csv`（一方ショート×ローネックチーズ）  
- `チーズ_DS_RN.csv`（両方ショート×ローネックチーズ）  

---

### 2. 各CSVのパラメータ構造
- **一方ショートチーズ（SS）** → 単寸法：L1 のみ  
- **一方ショート×ローネックチーズ（SS_RN）** → 2寸法：L1, L2  
- **両方ショート×ローネックチーズ（DS_RN）** → 3寸法：L1, L2, L3  

👉 これで iCAD が自動生成できる  

---

### 3. 行の持ち方
- マトリクス表は **縦持ちの行データに変換**  
- 例）「48×45」 → L1=48, L2=45  
- 「38」 → L1=38, L2=0  
- 「45×48×45」 → L1=45, L2=48, L3=45  
- 「×」 → 行を作らない  

---

### 4. インデックス登録
- `チーズ.csv`（インデックス）に以下を追記：  
  ```
  SS,SS,,SUS304,SS,*,0,2,3,90度,,,,,,W,,,,,1
  SS_RN,SS_RN,,SUS304,SS_RN,*,0,2,3,90度,,,,,,W,,,,,1
  DS_RN,DS_RN,,SUS304,DS_RN,*,0,2,3,90度,,,,,,W,,,,,1
  ```
- これで標準部品配置から呼び出せるようになる  

---

### 5. ファイル命名（14文字制限対応）
- 部品名称は以下で確定（元の名前に近く、14文字以内）：  
  - 一方ショートチーズ → **一方ショートチーズ**  
  - 一方ショート×ローネックチーズ → **一方Sローネックチーズ**  
  - 両方ショート×ローネックチーズ → **両方Sローネックチーズ**  

---

## ✅ 実装の流れ
1. 今回の表を整理して **3種類 × 呼び径組合せ の行データ化**  
2. それぞれ `チーズ_SS.csv`, `チーズ_SS_RN.csv`, `チーズ_DS_RN.csv` を生成  
3. インデックス `チーズ.csv` に追記  
4. iCAD再起動して配置テスト  

---

👉 次のステップとして、こちらで **実際の3つのCSVをPowerShellワンライナーで生成できる形** にまとめて渡すよ。  
その中身は「あなたの貼った表に忠実（×を除外し、数値はL1〜L3に展開）」にする。  

これ、すぐ欲しい？

### tool  

Model set context updated.

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-QsSBp84A47UHKqruv34qZS; size_bytes=74443; width=867; height=1019; fovea=; metadata=}

またCSVずれてるよ。あと参考マニュアルから標準部品の登録手順読み取れる？

### user  

既存のシステムで標準で入っていたエクセルファイルを流用して使いつつ、新しく部品を登録していきたい。

### assistant  

OK。**右の元CSVと同じ「縦持ち＋ヘッダは `呼び径Ａ, 呼び径Ｂ, 利用者部品のモデル名`」**に揃えた生成スクリプトに修正した。  
各CSVは **データ行=5行**（5形状）になる。

### PowerShell（ダウンロード直行・3ファイル作成）
```powershell
# === iCAD 標準CSV：縦持ちヘッダ「呼び径Ａ, 呼び径Ｂ, 利用者部品のモデル名」版 ===
$DL = "$env:USERPROFILE\Downloads"

function New-Head([string]$title){
@"
1,チーズ,$title,USER_PART
2,システム行,１〜５行目はシステムリザーブです
3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください
4,システム行,システムリザーブ
5,システム行,システムリザーブ
6,ユーザ行,６〜９行目は利用者開放領域です
7,ユーザ行,御自由に御利用下さい
8,ユーザ行
9,ユーザ行
呼び径Ａ,呼び径Ｂ,利用者部品のモデル名
"@
}

# 1) 一方ショートチーズ（5行）
$rows1 = @(
  @{A='1S'  ; B='1S'  ; M='一方ショートチーズ_1S-1S'  }
  @{A='1.5S'; B='1.5S'; M='一方ショートチーズ_1.5S-1.5S'}
  @{A='2S'  ; B='2S'  ; M='一方ショートチーズ_2S-2S'  }
  @{A='2.5S'; B='2.5S'; M='一方ショートチーズ_2.5S-2.5S'}
  @{A='3S'  ; B='3S'  ; M='一方ショートチーズ_3S-3S'  }
)
$csv1 = New-Head '一方ショートチーズ'
foreach($r in $rows1){ $csv1 += "{0},{1},{2}`n" -f $r.A,$r.B,$r.M }
$csv1 | Out-File -Encoding UTF8 "$DL\チーズ_一方ショートチーズ.csv"

# 2) 一方ショート×ローネックチーズ（5行）
$rows2 = @(
  @{A='1S'  ; B='1.5S'; M='一方Sローネックチーズ_1S-1.5S' }
  @{A='1.5S'; B='2S'  ; M='一方Sローネックチーズ_1.5S-2S' }
  @{A='2S'  ; B='2.5S'; M='一方Sローネックチーズ_2S-2.5S' }
  @{A='2.5S'; B='3S'  ; M='一方Sローネックチーズ_2.5S-3S' }
  @{A='3S'  ; B='3S'  ; M='一方Sローネックチーズ_3S-3S'   }
)
$csv2 = New-Head '一方ショート×ローネックチーズ'
foreach($r in $rows2){ $csv2 += "{0},{1},{2}`n" -f $r.A,$r.B,$r.M }
$csv2 | Out-File -Encoding UTF8 "$DL\チーズ_一方ショート×ローネックチーズ.csv"

# 3) 両方ショート×ローネックチーズ（5行）
$rows3 = @(
  @{A='1S'  ; B='1.5S'; M='両方Sローネックチーズ_1S-1.5S' }
  @{A='1.5S'; B='2S'  ; M='両方Sローネックチーズ_1.5S-2S' }
  @{A='2S'  ; B='2.5S'; M='両方Sローネックチーズ_2S-2.5S' }
  @{A='2.5S'; B='3S'  ; M='両方Sローネックチーズ_2.5S-3S' }
  @{A='3S'  ; B='3S'  ; M='両方Sローネックチーズ_3S-3S'   }
)
$csv3 = New-Head '両方ショート×ローネックチーズ'
foreach($r in $rows3){ $csv3 += "{0},{1},{2}`n" -f $r.A,$r.B,$r.M }
$csv3 | Out-File -Encoding UTF8 "$DL\チーズ_両方ショート×ローネックチーズ.csv"

"作成: $DL\チーズ_一方ショートチーズ.csv"
"作成: $DL\チーズ_一方ショート×ローネックチーズ.csv"
"作成: $DL\チーズ_両方ショート×ローネックチーズ.csv"
```

これで各CSVの**10行目が必ず**  
`呼び径Ａ,呼び径Ｂ,利用者部品のモデル名` になり、その下に**5行**ずつデータが入る。  
iCADの他列（外径やL寸法など）は別CSVやモデルトッピングで持つ想定。もし**外径(O.D.)列やL寸法列を追加**した完全版が必要なら、その列名・表記（例：「O.D.(mm)」の全角半角など）を教えて。すぐ同じ構造で増やす。

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # --- ここから貼り付け ---
PS C:\Users\h.futada> $enc = [System.Text.Encoding]::GetEncoding(932)
PS C:\Users\h.futada> $DL = [Environment]::GetFolderPath('UserProfile') + '\Downloads'
PS C:\Users\h.futada>
PS C:\Users\h.futada> function Out-ICADCsv($path, $partName, $rows){
>>   $w = New-Object System.IO.StreamWriter($path,$false,$enc)
>>   try{
>>     # 1～9行（マニュアル準拠）
>>     $w.WriteLine('チーズ,"{0} USER_PART"',$partName)  # 1行目: 部品種類, 部品名称 規格名称 規格番号
>>     $w.WriteLine('システム行1～5行目はシステムリザーブです')
>>     $w.WriteLine('システム行: 既定システムが使用していますので、D / E / F列を使用しないでください')
>>     $w.WriteLine('システム行: システムリザーブ')
>>     $w.WriteLine('システム行: システムリザーブ')
>>     $w.WriteLine('ユーザ行 6～9行目は利用者開放領域です')
>>     $w.WriteLine('ユーザ行: 自由に御利用下さい')
>>     $w.WriteLine('ユーザ行')
>>     $w.WriteLine('ユーザ行')
>>     # 見出し
>>     $w.WriteLine('"呼び径Ａ","呼び径Ｂ","利用者部品のモデル名"')
>>     # データ本体（全フィールドをクォート）
>>     foreach($r in $rows){ $w.WriteLine('"{0}","{1}","{2}"' -f $r[0],$r[1],$r[2]) }
>>   } finally { $w.Close() }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 1) 一方ショートチーズ（同径5種）
PS C:\Users\h.futada> $rows1 = @(
>>   @('1S','1S','一方ショートチーズ_1S-1S'),
>>   @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
>>   @('2S','2S','一方ショートチーズ_2S-2S'),
>>   @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
>>   @('3S','3S','一方ショートチーズ_3S-3S')
>> )
PS C:\Users\h.futada> Out-ICADCsv (Join-Path $DL 'チーズ_SS.csv') '一方ショートチーズ' $rows1
文字列 インデックス (0 ベース) は 0 以上で、引数リストのサイズよりも小さくなければなりません。 の書式設定のエラーです。
発生場所 行:17 文字:27
+ ... r in $rows){ $w.WriteLine('"{0}","{1}","{2}"' -f $r[0],$r[1],$r[2]) }
+                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: ("{0}","{1}","{2}":String) []、RuntimeException
    + FullyQualifiedErrorId : FormatError

PS C:\Users\h.futada>
PS C:\Users\h.futada> # 2) 一方ショート×ローネック（異径5種）
PS C:\Users\h.futada> $rows2 = @(
>>   @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
>>   @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
>>   @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
>>   @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
>>   @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
>> )
PS C:\Users\h.futada> Out-ICADCsv (Join-Path $DL 'チーズ_SS_RN.csv') '一方ショート×ローネックチーズ' $rows2
文字列 インデックス (0 ベース) は 0 以上で、引数リストのサイズよりも小さくなければなりません。 の書式設定のエラーです。
発生場所 行:17 文字:27
+ ... r in $rows){ $w.WriteLine('"{0}","{1}","{2}"' -f $r[0],$r[1],$r[2]) }
+                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: ("{0}","{1}","{2}":String) []、RuntimeException
    + FullyQualifiedErrorId : FormatError

PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3) 両方ショート×ローネック（異径5種）
PS C:\Users\h.futada> $rows3 = @(
>>   @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
>>   @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
>>   @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
>>   @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
>>   @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
>> )
PS C:\Users\h.futada> Out-ICADCsv (Join-Path $DL 'チーズ_DS_RN.csv') '両方ショート×ローネックチーズ' $rows3
文字列 インデックス (0 ベース) は 0 以上で、引数リストのサイズよりも小さくなければなりません。 の書式設定のエラーです。
発生場所 行:17 文字:27
+ ... r in $rows){ $w.WriteLine('"{0}","{1}","{2}"' -f $r[0],$r[1],$r[2]) }
+                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: ("{0}","{1}","{2}":String) []、RuntimeException
    + FullyQualifiedErrorId : FormatError

PS C:\Users\h.futada> # --- ここまで ---
PS C:\Users\h.futada>

### assistant  

いいね、**一気にPowerShell**で進めよう。  
下のスクリプトは、このチャットの絶対ルール（`C:\ICADSX\PDS\sys\PARTS_SPEC\USR1` を使用）に沿って、

- USR1\チーズ フォルダを作成  
- **寸法表CSV（3ファイル×各5行）**を Shift-JIS＋CRLF で生成（10行目ヘッダ＝「呼び径Ａ,呼び径Ｂ,利用者部品のモデル名」/ モデル名は最後列）  
- **TOSTE のインデックス `チーズ.csv` を USR1 にコピーしバックアップ**（存在すれば上書き前に *.bak を作成）  
- インデックスに貼り付ける用の**追記サンプル行ファイル**も作成（安全のため自動追記はせず、貼り付け確認で事故防止）

そのまま PowerShell に貼って実行してね。

```powershell
# ===== iCAD USR1\チーズ 一括セットアップ（寸法表CSV生成＋インデックス雛形コピー） =====
# 文字コード：Shift-JIS（CP932）／ 改行：CRLF
$enc = [System.Text.Encoding]::GetEncoding(932)
$srcIdx = 'C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv'
$dstDir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$idxDst = Join-Path $dstDir 'チーズ.csv'

# 1) USR1\チーズ を作成（なければ）
if (-not (Test-Path $dstDir)) { New-Item -ItemType Directory -Path $dstDir | Out-Null }

# 2) インデックスを TOSTE からコピー（安全のためバックアップ）
if (Test-Path $srcIdx) {
  if (Test-Path $idxDst) {
    $bak = "$idxDst.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
    Copy-Item $idxDst $bak -Force
  }
  Copy-Item $srcIdx $idxDst -Force
} else {
  Write-Warning "TOSTE のインデックスが見つかりませんでした： $srcIdx"
}

# 3) 寸法表CSVを生成（各5行／縦持ち／モデル名は最後列）
function New-IcadSpecCsv {
  param([string]$path,[string]$partName,[object[]]$rows)

  $w = New-Object IO.StreamWriter($path,$false,$enc)
  try {
    $w.NewLine = "`r`n"
    # 1〜9行：予約＋ユーザ行（このまま）
    $w.WriteLine("1,チーズ,{0},USER_PART", $partName)
    $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
    $w.WriteLine("3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください")
    $w.WriteLine("4,システム行,システムリザーブ")
    $w.WriteLine("5,システム行,システムリザーブ")
    $w.WriteLine("6,ユーザ行,６〜９行目は利用者開放領域です")
    $w.WriteLine("7,ユーザ行,御自由に御利用下さい")
    $w.WriteLine("8,ユーザ行")
    $w.WriteLine("9,ユーザ行")
    # 10行目ヘッダ（絶対）
    $w.WriteLine("呼び径Ａ,呼び径Ｂ,利用者部品のモデル名")
    # 本体（各CSV＝5行）
    foreach($r in $rows){
      # r = @('呼び径A','呼び径B','モデル名')
      $w.WriteLine('"{0}","{1}","{2}"', $r[0],$r[1],$r[2])
    }
  } finally { $w.Close() }
}

# ファイル名（日本語・わかりやすい）
$csv1 = Join-Path $dstDir 'チーズ_一方ショートチーズ.csv'
$csv2 = Join-Path $dstDir 'チーズ_一方ショート×ローネックチーズ.csv'
$csv3 = Join-Path $dstDir 'チーズ_両方ショート×ローネックチーズ.csv'

# 3-1) 一方ショートチーズ（同径 5行）
$rows1 = @(
  @('1S','1S','一方ショートチーズ_1S-1S'),
  @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
  @('2S','2S','一方ショートチーズ_2S-2S'),
  @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
  @('3S','3S','一方ショートチーズ_3S-3S')
)
New-IcadSpecCsv -path $csv1 -partName '一方ショートチーズ' -rows $rows1

# 3-2) 一方ショート×ローネックチーズ（異径 5行）
$rows2 = @(
  @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
)
New-IcadSpecCsv -path $csv2 -partName '一方ショート×ローネックチーズ' -rows $rows2

# 3-3) 両方ショート×ローネックチーズ（異径 5行）
$rows3 = @(
  @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
)
New-IcadSpecCsv -path $csv3 -partName '両方ショート×ローネックチーズ' -rows $rows3

# 4) インデックス追記のサンプル行を作成（貼り付け用）
$sample = @"
# インデックス(チーズ.csv)に追記するサンプル（先頭の # 行はコメント）
# 規格番号(<=14) , 部品名称(<=14)       , 材質 , 寸法表CSVファイル名
SS           , 一方ショートチーズ         , SUS304 , チーズ_一方ショートチーズ.csv
SS_RN        , 一方Sローネックチーズ      , SUS304 , チーズ_一方ショート×ローネックチーズ.csv
DS_RN        , 両方Sローネックチーズ      , SUS304 , チーズ_両方ショート×ローネックチーズ.csv
"@
$samplePath = Join-Path $dstDir 'インデックス追記_サンプル.txt'
[IO.File]::WriteAllText($samplePath, $sample, $enc)

Write-Host "生成完了：" -ForegroundColor Cyan
$dstDir
$csv1
$csv2
$csv3
if (Test-Path $idxDst) { Write-Host "インデックス雛形: $idxDst（必要なら編集）" -ForegroundColor Yellow }
Write-Host "追記サンプル: $samplePath を開いて、チーズ.csv に必要行を貼り付け" -ForegroundColor Yellow
# ===== end =====
```

### 次にやること
1) スクリプトを実行 → `USR1\チーズ` に **3つの寸法表CSV** と **インデックス雛形**、**追記サンプル**ができます。  
2) `チーズ.csv` を開いて、**追記サンプルの3行**を該当フォーマットに合わせて貼り付けて保存。  
3) iCAD再起動 → 部品配置 → **規格参照で USR1** を選び、呼び径が5行ぶん見えるか確認。

---

必要なら、「インデックス `チーズ.csv` の実際の列並び」をスクショかファイルで見せてくれれば、**自動追記する安全版スクリプト**（列に完全一致させて追記）もすぐ出すよ。

### user  

貼った画像はどうなってた？

### user  

PS C:\Users\h.futada> | Export-Csv "$env:USERPROFILE\Downloads\icad_manifest.csv" -NoTypeInformation -Encoding UTF8
発生場所 行:1 文字:1
+ | Export-Csv "$env:USERPROFILE\Downloads\icad_manifest.csv" -NoTypeIn ...
+ ~
空のパイプ要素は許可されていません。
    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : EmptyPipeElement

PS C:\Users\h.futada>

### assistant  

了解。じゃあ **Excel連携を前提にした標準部品登録フロー** をまとめる。  
iCAD SX (V8L4) は標準部品の「属性」をExcelに吐き出せるから、最初に項目設計をきっちりやっておくのが肝。  

---

## Excel連携を前提にした標準部品登録手順

### ① Excel側の項目設計
まず社内標準BOMの列を決める。  
例（よく使う推奨列）：
- 部品コード（社内管理番号）
- 部品名（例：ローネックチーズ）
- 呼び径（例：20A）
- 規格（例：JIS B2313）
- 材質（例：SUS304）
- メーカー／仕入先
- 図面番号
- 備考  

👉 これを「社内標準BOMフォーマット」としてExcelに固定しておく。  

---

### ② iCADでの属性設定
1. 部品モデルを作る（15種類のチーズ）。  
2. [属性設定] でExcel列と1対1対応するように入力欄を作る。  
   - 属性名はExcel列名と一致させると後で楽。  
   - 例：  
     - `PART_CODE` → Excel「部品コード」  
     - `SIZE` → Excel「呼び径」  
     - `STD` → Excel「規格」  

---

### ③ 標準部品登録
- 登録時に「属性」も一緒に保存される。  
- 名前はExcelの「部品名＋呼び径」で統一しておく。  
  例：`ローネックチーズ-20A`  

---

### ④ Excelへの出力
- [BOM出力] or [属性一覧出力] コマンドを使うと、  
  配置した部品の属性情報がそのままExcelに吐き出される。  
- 出力時に「Excel連携用テンプレート」を選ぶ → 社内標準BOMフォーマットに合わせて自動整形できる。  

---

### ⑤ 社内展開
- ライブラリをサーバー共有フォルダに置く  
- Excelテンプレート（標準BOM.xlsx）も同じ場所に置く  
- 全員が共通の「呼び出し→配置→Excel出力」フローを使えるようにする  

---

## ポイント（失敗しやすい所）
- **属性名とExcel列名の不一致** → 出力時に列がズレる  
- **部品名の命名ルールがバラバラ** → Excelで集計が面倒になる  
- **2D展開後の属性が消える設定** → 登録時に「2D連携あり」で保存すること  

---

👉 確認したい：  
Excel連携は **既存の「社内標準BOMフォーマット」に合わせたい**のか、  
それとも **これから新しくフォーマットを決めて標準化したい**のか、どっち？  

（既存フォーマットがあるならそれに合わせた属性名マッピング表を作るのが最初の仕事になる）

### user  

そのうえでさっきのちょうどいい要約作って。

### assistant  

了解。「ローネック → LowNeck」へ**一括自動修正**します。  
下の PowerShell を実行すると、**USR1\チーズ**配下で次をまとめて行います。

- 寸法表CSV内の表記を **ローネック → LowNeck** に置換（SJIS/CRLF維持・バックアップ作成）
- ファイル名を **`…ローネック…` → `…LowNeck…`** にリネーム
- インデックス `チーズ.csv` 内の表記を置換  
  - **ローネック → LowNeck**  
  - **規格番号**：`SS_RN` → `SS_LN`、`DS_RN` → `DS_LN`  
  - **参照CSVファイル名**：`…ローネック…csv` → `…LowNeck…csv`
- 変更ログを `インデックス追記_ログ.txt` に追記

そのまま貼り付けてOKです。

```powershell
# ===== USR1\チーズ ローネック→LowNeck 一括自動修正（このチャットの絶対ルール準拠）=====
$ErrorActionPreference = 'Stop'
$enc   = [System.Text.Encoding]::GetEncoding(932)   # Shift-JIS
$dir   = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$idx   = Join-Path $dir 'チーズ.csv'

# 1) ユーティリティ
function Backup-File([string]$path){
  if(Test-Path $path){
    $bak = "$path.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
    Copy-Item $path $bak -Force
    return $bak
  }
  return $null
}
function Replace-TextFile([string]$path, [hashtable]$map){
  if(-not (Test-Path $path)){ return $false }
  $bak = Backup-File $path
  $lines = [IO.File]::ReadAllLines($path, $enc)
  for($i=0;$i -lt $lines.Count;$i++){
    foreach($k in $map.Keys){
      $re = [regex]::Escape($k)
      $lines[$i] = [regex]::Replace($lines[$i], $re, $map[$k])
    }
  }
  [IO.File]::WriteAllLines($path, $lines, $enc)
  # CRLF固定
  $content = [IO.File]::ReadAllText($path, $enc) -replace "`n","" -replace "`r",""
  $content = ($lines -join "`r`n") + "`r`n"
  [IO.File]::WriteAllText($path, $content, $enc)
  return $true
}
function Rename-IfExists([string]$old,[string]$new){
  $oldP = Join-Path $dir $old
  $newP = Join-Path $dir $new
  if(Test-Path $oldP){
    if(Test-Path $newP){ Remove-Item $newP -Force }
    Rename-Item $oldP $new -Force
    return $true
  }
  return $false
}

# 2) ファイル名のリネーム（ローネック→LowNeck）
$renamed = @()
$renamed += @{ Old='チーズ_一方ショート×ローネックチーズ.csv'; New='チーズ_一方ショート×LowNeckチーズ.csv';  Done=(Rename-IfExists 'チーズ_一方ショート×ローネックチーズ.csv' 'チーズ_一方ショート×LowNeckチーズ.csv') }
$renamed += @{ Old='チーズ_両方ショート×ローネックチーズ.csv'; New='チーズ_両方ショート×LowNeckチーズ.csv';    Done=(Rename-IfExists 'チーズ_両方ショート×ローネックチーズ.csv' 'チーズ_両方ショート×LowNeckチーズ.csv') }

# 3) 寸法表CSV 内文言置換（ローネック→LowNeck）
$specFiles = @(
  'チーズ_一方ショートチーズ.csv',
  'チーズ_一方ショート×LowNeckチーズ.csv',
  'チーズ_両方ショート×LowNeckチーズ.csv'
)
$mapSpec = @{ 'ローネック'='LowNeck' }  # 必要十分：モデル名・タイトルの置換
$specResults = @()
foreach($f in $specFiles){
  $p = Join-Path $dir $f
  if(Test-Path $p){
    $ok = Replace-TextFile $p $mapSpec
    $specResults += @{ File=$f; Replaced=$ok }
  } else {
    $specResults += @{ File=$f; Replaced=$false }
  }
}

# 4) インデックス（チーズ.csv）置換：表記＆規格番号＆CSV名
$idxMap = @{
  'ローネック'='LowNeck'
  'SS_RN'     ='SS_LN'
  'DS_RN'     ='DS_LN'
  'チーズ_一方ショート×ローネックチーズ.csv'='チーズ_一方ショート×LowNeckチーズ.csv'
  'チーズ_両方ショート×ローネックチーズ.csv'='チーズ_両方ショート×LowNeckチーズ.csv'
}
$idxReplaced = $false
if(Test-Path $idx){
  $idxReplaced = Replace-TextFile $idx $idxMap
} else {
  Write-Warning "インデックスが見つかりません: $idx"
}

# 5) ログ出力
$log = Join-Path $dir 'インデックス追記_ログ.txt'
$sb = New-Object System.Text.StringBuilder
$null = $sb.AppendLine("=== LowNeck 一括置換ログ ===")
$null = $sb.AppendLine("日時: $(Get-Date)")
$null = $sb.AppendLine("対象フォルダ: $dir")
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[ファイル名のリネーム]")
foreach($r in $renamed){
  $null = $sb.AppendLine(" - {0} -> {1} : {2}" -f $r.Old,$r.New,($(if($r.Done){'OK'}else{'無し'})))
}
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[寸法表CSV 置換結果（ローネック→LowNeck）]")
foreach($r in $specResults){
  $null = $sb.AppendLine(" - {0} : {1}" -f $r.File,($(if($r.Replaced){'OK'}else{'未処理／未発見'})))
}
$null = $sb.AppendLine("")
$null = $sb.AppendLine("[インデックス置換]")
$null = $sb.AppendLine(" - チーズ.csv : " + ($(if($idxReplaced){'OK'}else{'未処理／未発見'})))
[IO.File]::WriteAllText($log, $sb.ToString(), $enc)

Write-Host "=== 完了 ===" -ForegroundColor Cyan
Write-Host "フォルダ: $dir"
Write-Host "ログ: $log"
```

### 実行後チェック
- `USR1\チーズ\` に  
  - `チーズ_一方ショート×**LowNeck**チーズ.csv`  
  - `チーズ_両方ショート×**LowNeck**チーズ.csv`  
  が存在（元のローネック名は `.bak_日時` バックアップと差し替え）
- それぞれの CSV を開くと、**10行目ヘッダそのまま／モデル名などの本文が LowNeck 表記**  
- `チーズ.csv` を開くと、**名称・規格番号・参照CSV名** が LowNeck / **SS_LN / DS_LN** に更新

---

### もし社内規格番号の命名を変更したい場合
- 例：`SS_LN` を `TEE_S_LN` に、`DS_LN` を `TEE_D_LN` に変更…など  
  → 上の `$idxMap` に行を足して再実行すれば、一括で置換できます。  
  必要なら具体案を言ってくれれば僕がマップを組みます。

### assistant  

了解 👍  
このチャットルーム内に限って、  

**「`C:\ICADSX\PDS\sys\PARTS_SPEC\USR1` を社内専用フォルダとして使う」**  

というルールを **絶対ルール** として覚えました。  
他のチャットや新規スレッドには影響しません。  

以後この部屋では、部品登録やCSV生成の案内は必ず **USR1 フォルダ基準** で進めます。

### user  

iCAD SX(V8L4)で標準部品を登録したい。

### assistant  

確認ありがとう！  
状況を整理すると：

### ✅ 良い点
- **寸法表CSV** はちゃんと `LowNeck` に置換されてる（`…LowNeckチーズ.csv` の行で確認できている）  
- **インデックスCSV (`チーズ.csv`)** にも `LowNeck` 表記が入っている  

### ⚠️ 懸念点
- `Select-String` の出力で「�`�[�Y」みたいな文字化けが出ている  
  → これは **PowerShell コンソールが SJIS を正しく表示できていないだけ**  
  → 実際のCSVファイルは SJIS で書かれているので、**iCAD側で読み込む分には問題なし**

---

## どう確認すれば安心か
文字化けしない方法で “ASCII 部分だけ”をチェックするのが確実です。  
例えば：

```powershell
# LowNeck を含む行を SJISのまま出力（ASCII部分だけ表示される）
Get-Content 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Encoding Default | Select-String 'LowNeck'

# 規格コード（SS / SS_LN / DS_LN）が含まれる行
Get-Content 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Encoding Default | Select-String 'SS'
```

> `-Encoding Default` は Windows の日本語環境だと **CP932 (SJIS)** になるので正しく読めます。  

---

## 次のステップ
1. 上のコマンドで **「SS」「SS_LN」「DS_LN」＋LowNeck が入っている行** が確認できたら成功  
2. iCAD を再起動 → 部品配置 → **規格参照 → USR1 → チーズ** を開いて  
   - `一方ショートチーズ (SS)`  
   - `一方SLowNeckチーズ (SS_LN)`  
   - `両方SLowNeckチーズ (DS_LN)`  
   が表示されるかを確認  

---

👉 もし iCAD での名称を「一方ショート×LowNeckチーズ」に統一したいなら、インデックスの `部品名称` 列をもう一度置換すればOK。  
今の「S付け」表記（`一方SLowNeckチーズ`）を直した方が良い？

### assistant  

了解 👍  
では **ギリギリ14文字** まで使って「元の名称の雰囲気を最大限残す」バージョンを設計する。  

---

## 命名案（14文字ぎりぎり）

| 元の名称                      | 推奨名称（14文字以内） | 文字数 |
|-------------------------------|------------------------|--------|
| 一方ショートチーズ             | 一方ショートチーズ     | 9      |
| 一方ショート×ローネックチーズ | 一方Sローネックチーズ  | 14     |
| 両方ショート×ローネックチーズ | 両方Sローネックチーズ  | 14     |
| ローアームチーズ               | ローアームチーズ       | 8      |

👉 「ショート」はそのまま残し、  
👉 「一方」「両方」は漢字で残す、  
👉 「ローネックチーズ」で14文字いっぱいに収めた。  

これなら見た瞬間に「元の名称」とほぼ同じ印象になる。  

---

## PowerShell生成版（14文字MAX版）

```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
一方ショートチーズ,USR010,SUS304,15A,1S,38,0
一方ショートチーズ,USR010,SUS304,2S,2S,55,0
一方ショートチーズ,USR010,SUS304,2.5S,2.5S,62,0
一方ショートチーズ,USR010,SUS304,3S,3S,68,0
一方Sローネックチーズ,USR011,SUS304,1S,1.5S,38,35
一方Sローネックチーズ,USR011,SUS304,1.5S,2S,48,45
一方Sローネックチーズ,USR011,SUS304,2S,2.5S,55,50
一方Sローネックチーズ,USR011,SUS304,2.5S,3S,62,57
一方Sローネックチーズ,USR011,SUS304,3S,3S,68,63
両方Sローネックチーズ,USR012,SUS304,1S,1.5S,35,38
両方Sローネックチーズ,USR012,SUS304,1.5S,2S,45,48
両方Sローネックチーズ,USR012,SUS304,2S,2.5S,50,55
両方Sローネックチーズ,USR012,SUS304,2.5S,3S,57,62
両方Sローネックチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "$env:USERPROFILE\Downloads\チーズ標準部品ひな形.csv"
```

---

👉 これを実行すれば、ダウンロードフォルダに **呼び出しやすくて元の名前に近いCSV** が生成される。  

質問：この名前付けを **全社標準** として確定しちゃって良い？ それとも「ローアーム」系も一緒に今のうちに入れる？

### user  

元々の張ったデータはどんな傾向？それに沿いたい。

### user  

@{content_type=image_asset_pointer; asset_pointer=file-service://file-MBgCE4gMMqpNZwRCQp37PY; size_bytes=51693; width=630; height=770; fovea=; metadata=}

この15部品を登録したいんだけど、どうすれば最良？

### user  

またファイルが見つかりませんってなる

### user  

今回の部品登録に必要なこと考えられる範囲で全部自動でやって。こっちで必要な事あればデータとか提供するから言って。

### assistant  

よし、**インデックスの更新は完了**しています ✅  
（ログ出力どおり `…\USR1\チーズ\チーズ.csv` を **SJIS+CRLF** で上書き・バックアップ付きで保存できています）

### いま起きていたこと（原因の整理）
- USR1 の **インデックスCSVのヘッダ構成**は TOSTE系と少し違い、  
  `規格番号/部品名称/CSVファイル名` ではなく  
  `… , [@@DIM_FILE]`（= 寸法表CSV）などの**別名カラム**でした。  
- そこでスクリプトを「ヘッダ自動検出」に切り替え、**SS/SS_LN/DS_LN の3行**を追加・置換する形に修正 → 今回の実行で反映済みです。

---

## クイック確認（表示はASCIIだけにして化けない版）
```powershell
# 置換後の3コードが入っているか
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Pattern 'SS_LN','DS_LN','SS'

# LowNeck が各CSVに入っているか
Select-String -Path 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\*.csv' -Pattern 'LowNeck' | Select-Object -First 10
```

（コンソールで日本語が文字化けするのは表示の問題だけ。必要なら `chcp 65001` か  
`$OutputEncoding = [Console]::OutputEncoding = [Text.Encoding]::GetEncoding(932)` で改善できます）

---

## 念のための復元（ロールバック）
```powershell
# 直近バックアップに戻す例
Copy-Item 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv.bak_20250828_173739' `
         'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv' -Force
```

---

## 次のアクション
1) **iCADを再起動**  
2) 部品配置 → **規格参照 → USR1 → チーズ** で  
   - `一方ショートチーズ`（SS）  
   - `一方SLowNeckチーズ`（SS_LN）  
   - `両方SLowNeckチーズ`（DS_LN）  
   が選べて、呼び径5種が出るか確認

もし表示名を「一方S**LowNeck**チーズ」→「一方ショート×LowNeckチーズ」に**統一**したい等があれば、言ってくれれば**名称だけ差し替えるワンショット**を用意します。  
また、**材質（今は SUS304）**や**規格番号（SS/SS_LN/DS_LN）**の最終確定があれば、それに合わせて自動再整形します！

### user  

iCADで3Dモデルを自動生成させたい

### assistant  

了解 👍  
じゃあこの **「一方ショートチーズ」「一方Sローネックチーズ」「両方Sローネックチーズ」** 命名（14文字制限対応版）でいったん仮決めにするね。  

---

## 今後の流れ（確認用）
1. PowerShellワンライナーを実行 → ダウンロードフォルダに `チーズ標準部品ひな形.csv` が生成される。  
2. このCSVを `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ` に配置。  
3. インデックス `チーズ.csv` に以下を追記：  
   ```
   USR010,一方ショートチーズ,SUS304,チーズ標準部品ひな形.csv
   USR011,一方Sローネックチーズ,SUS304,チーズ標準部品ひな形.csv
   USR012,両方Sローネックチーズ,SUS304,チーズ標準部品ひな形.csv
   ```
4. iCAD再起動 → [標準部品配置] → 「チーズ」で呼び出しテスト。  

---

👉 もし呼び出し時に「基準点がズレる」「3Dが生成されない」「Excel出力が列ズレする」など問題が出たら、そのとき修正すればOK。  
👉 名前変更やローアーム追加の必要が出たらまた教えて。  

次のステップとして、**外径・肉厚の寸法列も追加したフルパラメトリック版** を作っておこうか？

### assistant  

なるほど 👍  
「できるだけ元の iCAD 標準 CSV（チーズ_T-8.csv など）のフォーマットに合わせた形で欲しい」ということね。  

つまり  

- 私が簡易的にまとめた **部品名称, 規格番号, 材質, 主管径, 分岐径, L1, L2** だけじゃなくて  
- 元CSVに本来入っている **呼び径、外径、肉厚、中心間距離、分岐径側長さ、備考** などの列構造  
- 先頭数行のシステムリザーブ行  

これらを残した **正規のCSV雛形** にしておく方が後でトラブルにならない。  

---

## 提案する進め方

1. **元CSV（例：チーズ_T-8.csv）を雛形に流用**  
   - 先頭のシステム行（削除禁止）をそのまま残す。  
   - 列構造（呼び径, 外径, 厚さ, L1, L2 …）もそのまま踏襲する。  

2. **今回の15種類の行を追加する**  
   - 「一方ショートチーズ」「一方Sローネックチーズ」「両方Sローネックチーズ」ごとに **USR規格番号を割り振り**。  
   - 各行の「呼び径」「分岐径」「外径」「厚み」「寸法（L1,L2）」を埋める。  
   - もし表に「×」があった組み合わせはCSVには行を作らない。  

3. **インデックスCSV（チーズ.csv）に登録**  
   - 元CSVに追加した `チーズ_XX.csv` をインデックスから呼べるようにする。  

---

## 次のステップでやること
あなたがアップロードしてくれた  

- `チーズ_T-8.csv`  
- `チーズ_7MD.csv`  
- `チーズ_D-8_S.csv`  

などの「元CSVフォーマット」をこちらで解析して、  
その列構造に完全に合わせた **チーズ標準部品（15種類対応版）CSV** を生成する。  

---

👉 確認したい：  
この15種類は **全部「同じCSVファイル」にまとめる**（規格番号を変えて一括管理）方が良い？  
それとも **種類ごとに別CSVファイル**（一方ショート、片Sローネック、両Sローネック）で分ける方が運用しやすい？  

（元CSVの管理方法に合わせるのが最良なので、どちらで作るか決めてもらえるとスムーズに進められる）

### user  

お願い

### assistant  

了解 👍  
では、そのまま **PowerShellにコピペするだけでCSVが生成されるワンライナー** を渡すね。  

---

### PowerShellワンライナー
```powershell
@'
部品名称,規格番号,材質,主管径,分岐径,L1,L2
一方ショートチーズ,USR010,SUS304,15A,1S,38,0
一方ショートチーズ,USR010,SUS304,2S,2S,55,0
一方ショートチーズ,USR010,SUS304,2.5S,2.5S,62,0
一方ショートチーズ,USR010,SUS304,3S,3S,68,0
一方ショート×ローネックチーズ,USR011,SUS304,1S,1.5S,38,35
一方ショート×ローネックチーズ,USR011,SUS304,1.5S,2S,48,45
一方ショート×ローネックチーズ,USR011,SUS304,2S,2.5S,55,50
一方ショート×ローネックチーズ,USR011,SUS304,2.5S,3S,62,57
一方ショート×ローネックチーズ,USR011,SUS304,3S,3S,68,63
両方ショート×ローネックチーズ,USR012,SUS304,1S,1.5S,35,38
両方ショート×ローネックチーズ,USR012,SUS304,1.5S,2S,45,48
両方ショート×ローネックチーズ,USR012,SUS304,2S,2.5S,50,55
両方ショート×ローネックチーズ,USR012,SUS304,2.5S,3S,57,62
両方ショート×ローネックチーズ,USR012,SUS304,3S,3S,63,68
'@ | Out-File -Encoding UTF8 "チーズ標準部品ひな形.csv"
```

---

## 実行方法
1. PowerShellを開く  
2. 上のコードを **そのまま貼り付けて実行**  
3. 実行したディレクトリに `チーズ標準部品ひな形.csv` が生成される  

---

👉 これで iCAD に組み込めるCSVの雛形が完成する。  
次のステップは、これを `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ` に置いて、インデックス `チーズ.csv` に追記するだけ。  

必要なら、このCSVに **外径や肉厚の列** も追加した「完全3Dパラメトリック版」も出すよ。どうする？

### assistant  

ごめん！ズレの原因わかった。  
前のワンライナーは**改行が `\n`（LF）**で、Excel が**10行目のヘッダと1行目のデータを同じ行に連結**してしまってた。  
**CRLF**で書き出し、かつ**Shift-JIS**（既存CSVと同じ）で保存するように直したよ。  
さらに、各CSVは**「呼び径Ａ, 呼び径Ｂ, 利用者部品のモデル名」だけ（3列）**で、**データは5行**になる。

---

# 修正版 PowerShell（Downloads に3ファイル生成／ズレ対策済み）
```powershell
# ダウンロード直行
$DL = "$env:USERPROFILE\Downloads"

function New-HeadLines([string]$title){
  @(
    "1,チーズ,$title,USER_PART",
    "2,システム行,１〜５行目はシステムリザーブです",
    "3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください",
    "4,システム行,システムリザーブ",
    "5,システム行,システムリザーブ",
    "6,ユーザ行,６〜９行目は利用者開放領域です",
    "7,ユーザ行,御自由に御利用下さい",
    "8,ユーザ行",
    "9,ユーザ行",
    "呼び径Ａ,呼び径Ｂ,利用者部品のモデル名"   # ←ヘッダ
  )
}

# 1) 一方ショートチーズ（5行）
$rows1 = @(
  @{A='1S'  ; B='1S'  ; M='一方ショートチーズ_1S-1S'  },
  @{A='1.5S'; B='1.5S'; M='一方ショートチーズ_1.5S-1.5S'},
  @{A='2S'  ; B='2S'  ; M='一方ショートチーズ_2S-2S'  },
  @{A='2.5S'; B='2.5S'; M='一方ショートチーズ_2.5S-2.5S'},
  @{A='3S'  ; B='3S'  ; M='一方ショートチーズ_3S-3S'  }
)
$lines1 = New-HeadLines "一方ショートチーズ"
foreach($r in $rows1){ $lines1 += "$($r.A),$($r.B),$($r.M)" }
$lines1 | Set-Content -Encoding Default -Path (Join-Path $DL 'チーズ_一方ショートチーズ.csv')

# 2) 一方ショート×ローネックチーズ（5行）
$rows2 = @(
  @{A='1S'  ; B='1.5S'; M='一方Sローネックチーズ_1S-1.5S' },
  @{A='1.5S'; B='2S'  ; M='一方Sローネックチーズ_1.5S-2S' },
  @{A='2S'  ; B='2.5S'; M='一方Sローネックチーズ_2S-2.5S' },
  @{A='2.5S'; B='3S'  ; M='一方Sローネックチーズ_2.5S-3S' },
  @{A='3S'  ; B='3S'  ; M='一方Sローネックチーズ_3S-3S'   }
)
$lines2 = New-HeadLines "一方ショート×ローネックチーズ"
foreach($r in $rows2){ $lines2 += "$($r.A),$($r.B),$($r.M)" }
$lines2 | Set-Content -Encoding Default -Path (Join-Path $DL 'チーズ_一方ショート×ローネックチーズ.csv')

# 3) 両方ショート×ローネックチーズ（5行）
$rows3 = @(
  @{A='1S'  ; B='1.5S'; M='両方Sローネックチーズ_1S-1.5S' },
  @{A='1.5S'; B='2S'  ; M='両方Sローネックチーズ_1.5S-2S' },
  @{A='2S'  ; B='2.5S'; M='両方Sローネックチーズ_2S-2.5S' },
  @{A='2.5S'; B='3S'  ; M='両方Sローネックチーズ_2.5S-3S' },
  @{A='3S'  ; B='3S'  ; M='両方Sローネックチーズ_3S-3S'   }
)
$lines3 = New-HeadLines "両方ショート×ローネックチーズ"
foreach($r in $rows3){ $lines3 += "$($r.A),$($r.B),$($r.M)" }
$lines3 | Set-Content -Encoding Default -Path (Join-Path $DL 'チーズ_両方ショート×ローネックチーズ.csv')

Write-Host "3つ作成: $DL"
```
**ポイント**
- 1行ごと配列→`Set-Content`で書き出し＝**CRLFで保存**（Excelでズレません）
- **Encoding Default（CP932/Shift-JIS）**で、元CSVと同じ文字コード
- 各CSVとも**10行目がヘッダ**、その下に**5行だけ**のパーツデータ

---

# 参考マニュアルから読める「登録～呼び出し」の要点
このPDFはライブラリ作成手順そのものは載っていません（操作ガイド中心）が、**標準部品の呼び出し方**は載っています。  
iCAD上では次の流れで呼び出します：

- [配管]→[経路作成]→**(部品を配置する)**→「部品選択」で**継手/ティー**を選ぶ → **[規格参照]**から仕様を設定して挿入。fileciteturn1file3  
- 「配管部品ライブラリ内の**規格名フォルダ**を指定して部品を選ぶ」という前提の説明もあり、ライブラリからの選択で配置する運用であることが読み取れます。fileciteturn1file0

**つまり：**
1) `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\` に今回のCSVを置く  
2) インデックス（例：`チーズ.csv`）に追記  
3) iCAD再起動  
4) 「部品選択→継手→ティー→規格参照」で選択して配置、という手順で使えます。  
（操作ガイドは“配置側”の手順のみ詳述。登録そのものは別冊の「配管部品ライブラリ」系マニュアルに記載の領域です）

---

うまく開けば、**10行目ヘッダ＋5行**のきれいな縦持ちになります。  
もしまだズレるようなら、開いたCSVの**A10セルが「呼び径Ａ」**になっているかだけ教えて。そこから即修正するよ。

### assistant  

確認したけど、アップロードされた CSV は iCAD 標準部品ライブラリ用の特殊フォーマットで、普通の Excel 形式ではなかった。なので pandas では区切り文字を自動認識できずにエラーになってる。  

この形式はマニュアルにある **「部品寸法表CSV」** で、以下の特徴がある：  
- 先頭数行は「システムリザーブ行」になっている（削除禁止）。  
- その後に部品仕様（部品名・規格番号）が記載されている。  
- 呼び径・外径・厚さ・曲げ半径などの数値が列で並んでいる。  
- `USRXXX` みたいな **ユーザ規格識別子** が入っている。  

---

## どう流用するか
今回の「チーズ.csv」群をベースに **新しい継手仕様** を追加登録すればOK。流れはこう：

### ① 元のCSVをコピー
- 例：`チーズ.csv` → `チーズ_RN.csv`（ローネックチーズ用）  
- 編集は必ずコピーしたユーザ側ファイルで行う。  

### ② 規格番号と部品名を設定
- 例：  
  - 部品名称 = `ローネックチーズ`  
  - 規格番号 = `USR001`（新規の場合は未使用の番号を割当）  

### ③ 配管仕様を追加
- Excel上で呼び径別の寸法表を追加  
  ```
  呼び径 | 外径 | 厚さ | 曲げ半径 | その他寸法 …
  15A   | xx.x | x.x | xx.x
  20A   | xx.x | x.x | xx.x
  … （15種類ぶん追加）
  ```

### ④ インデックスファイルに追記
- ルートにある `チーズ.csv`（部品寸法インデックス）に、  
  新規作った `チーズ_RN.csv` を指す行を1行追加。  
- ここで「部品名」「規格番号」を一致させるのがポイント。  

### ⑤ iCADに認識させる
- 編集したファイルを `...\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ` に保存。  
- iCAD再起動後、[標準部品配置] → チーズフォルダ から呼び出せるようになる。  

---

👉 つまり今回のケースでは「新規の継手15種類を、既存のチーズ寸法CSVに追加登録してExcel出力にも反映させる」流れになる。  

質問だけど、今回登録したいのは **「ローネックチーズ」「ローアームチーズ」両方**をまとめて1つのCSVに追加する？  
それとも **種類ごとに別CSV（チーズ_RN.csv と チーズ_RA.csv）** に分けたい？

### assistant  

任せて。  
**このチャット内の絶対ルール（pipe_manual準拠／`USR1`使用）に沿って、必要作業を“全部 自動”でやる PowerShell** を用意したよ。  
これ1本で次をやります：

- `USR1\チーズ` を作成  
- **TOSTE→USR1 にインデックス `チーズ.csv` をコピー**（既存は自動バックアップ）  
- **寸法表CSV 3ファイル（各5行）**を **Shift-JIS＋CRLF**／**縦持ち**／**10行目ヘッダ** で生成  
- **インデックスに3行を自動追記**（ヘッダ列名を自動解析し、該当列以外は空欄で合わせる）
- 追記内容のプレビュー `USR1\チーズ\インデックス追記_ログ.txt` を作成

> そのまま PowerShell に貼り付けて実行してください。

```powershell
# ===== iCAD USR1\チーズ：標準部品フル自動セットアップ =====
# 仕様：pipe_manual準拠／このチャットの絶対ルール
# 出力：インデックス(コピー+追記), 寸法表CSV×3, 追記ログ
$ErrorActionPreference = 'Stop'
$enc = [System.Text.Encoding]::GetEncoding(932)   # Shift-JIS

# ルート
$srcIdx = 'C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv'
$dstDir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
$idxDst = Join-Path $dstDir 'チーズ.csv'

# 追記対象（規格・名称・CSVファイル名・材質など）
$newItems = @(
  @{ Code='SS';     Name='一方ショートチーズ';           Csv='チーズ_一方ショートチーズ.csv';           Mat='SUS304' },
  @{ Code='SS_RN';  Name='一方Sローネックチーズ';        Csv='チーズ_一方ショート×ローネックチーズ.csv'; Mat='SUS304' },
  @{ Code='DS_RN';  Name='両方Sローネックチーズ';        Csv='チーズ_両方ショート×ローネックチーズ.csv'; Mat='SUS304' }
)

# -- 1) USR1\チーズ を作成
if (-not (Test-Path $dstDir)) { New-Item -ItemType Directory -Path $dstDir | Out-Null }

# -- 2) インデックスを TOSTE からコピー（既存はバックアップ）
if (Test-Path $srcIdx) {
  if (Test-Path $idxDst) {
    $bak = "$idxDst.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
    Copy-Item $idxDst $bak -Force
  }
  Copy-Item $srcIdx $idxDst -Force
} else {
  Write-Warning "TOSTE のインデックスが見つかりません： $srcIdx"
  # 空の雛形を作る（予約行＋見出しだけ）
  $w = New-Object IO.StreamWriter($idxDst,$false,$enc)
  try{
    $w.NewLine="`r`n"
    $w.WriteLine("1,チーズ,インデックス,USER_PART")
    $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
    $w.WriteLine("3,システム行,Ｄ／Ｅ／Ｆ列は使用しないでください")
    $w.WriteLine("4,システム行,システムリザーブ")
    $w.WriteLine("5,システム行,システムリザーブ")
    $w.WriteLine("6,ユーザ行")
    $w.WriteLine("7,ユーザ行")
    $w.WriteLine("8,ユーザ行")
    $w.WriteLine("9,ユーザ行")
    $w.WriteLine("規格番号,部品名称,材質,CSVファイル名")
  } finally { $w.Close() }
}

# -- 3) 寸法表CSV 3ファイルを生成（縦持ち／10行目ヘッダ／モデル名は最後列）
function New-IcadSpecCsv {
  param([string]$path,[string]$partName,[object[]]$rows)
  $w = New-Object IO.StreamWriter($path,$false,$enc)
  try {
    $w.NewLine = "`r`n"
    $w.WriteLine("1,チーズ,{0},USER_PART", $partName)
    $w.WriteLine("2,システム行,１〜５行目はシステムリザーブです")
    $w.WriteLine("3,システム行,■注意 システムが使用していますので、Ｄ／Ｅ／Ｆ列を使用しないでください")
    $w.WriteLine("4,システム行,システムリザーブ")
    $w.WriteLine("5,システム行,システムリザーブ")
    $w.WriteLine("6,ユーザ行,６〜９行目は利用者開放領域です")
    $w.WriteLine("7,ユーザ行,御自由に御利用下さい")
    $w.WriteLine("8,ユーザ行")
    $w.WriteLine("9,ユーザ行")
    $w.WriteLine("呼び径Ａ,呼び径Ｂ,利用者部品のモデル名")  # 10行目ヘッダ（絶対）
    foreach($r in $rows){ $w.WriteLine('"{0}","{1}","{2}"', $r[0],$r[1],$r[2]) }
  } finally { $w.Close() }
}

$csv1 = Join-Path $dstDir 'チーズ_一方ショートチーズ.csv'
$csv2 = Join-Path $dstDir 'チーズ_一方ショート×ローネックチーズ.csv'
$csv3 = Join-Path $dstDir 'チーズ_両方ショート×ローネックチーズ.csv'

# 3-1) 一方ショートチーズ（同径 5行）
$rows1 = @(
  @('1S','1S','一方ショートチーズ_1S-1S'),
  @('1.5S','1.5S','一方ショートチーズ_1.5S-1.5S'),
  @('2S','2S','一方ショートチーズ_2S-2S'),
  @('2.5S','2.5S','一方ショートチーズ_2.5S-2.5S'),
  @('3S','3S','一方ショートチーズ_3S-3S')
)
New-IcadSpecCsv $csv1 '一方ショートチーズ' $rows1

# 3-2) 一方ショート×ローネックチーズ（異径 5行）
$rows2 = @(
  @('1S','1.5S','一方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','一方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','一方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','一方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','一方ショート×ローネックチーズ_3S-3S')
)
New-IcadSpecCsv $csv2 '一方ショート×ローネックチーズ' $rows2

# 3-3) 両方ショート×ローネックチーズ（異径 5行）
$rows3 = @(
  @('1S','1.5S','両方ショート×ローネックチーズ_1S-1.5S'),
  @('1.5S','2S','両方ショート×ローネックチーズ_1.5S-2S'),
  @('2S','2.5S','両方ショート×ローネックチーズ_2S-2.5S'),
  @('2.5S','3S','両方ショート×ローネックチーズ_2.5S-3S'),
  @('3S','3S','両方ショート×ローネックチーズ_3S-3S')
)
New-IcadSpecCsv $csv3 '両方ショート×ローネックチーズ' $rows3

# -- 4) インデックスに自動追記（既存ヘッダを解析して該当列に合わせる）
function Add-IndexRows {
  param([string]$idxPath, [object[]]$items)

  $lines = [IO.File]::ReadAllLines($idxPath, $enc)
  if($lines.Count -lt 10){ throw "インデックスの行数が不足：$idxPath" }

  # ヘッダ行（最初に見つかった見出しっぽい行：9行目以降でカンマ3個以上）
  $hdrIdx = -1
  for($i=9; $i -lt $lines.Count; $i++){
    $c = ($lines[$i] -split ',').Count
    if($c -ge 3){ $hdrIdx = $i; break }
  }
  if($hdrIdx -lt 0){ throw "見出し行が見つかりません：$idxPath" }

  $hdr = $lines[$hdrIdx].Split(',')
  # 欲しい列の候補名
  $colMap = @{
    Code = @('規格番号','規格No','Code')
    Name = @('部品名称','部品名','名称')
    Mat  = @('材質','Material')
    Csv  = @('CSVファイル名','仕様ファイル名','寸法表CSV','CSV','ファイル名')
  }

  $pos = @{ Code=-1; Name=-1; Mat=-1; Csv=-1 }
  foreach($k in $pos.Keys){
    foreach($cand in $colMap[$k]){
      $idx = [Array]::IndexOf($hdr,$cand)
      if($idx -ge 0){ $pos[$k] = $idx; break }
    }
  }

  # 列数に合わせて1行テンプレートを生成
  $colCount = $hdr.Count
  $out = New-Object System.Collections.Generic.List[string]
  $out.AddRange($lines)

  foreach($it in $items){
    $row = @('' * $colCount)
    if($pos.Code -ge 0){ $row[$pos.Code] = $it.Code }
    if($pos.Name -ge 0){ $row[$pos.Name] = $it.Name }
    if($pos.Mat  -ge 0){ $row[$pos.Mat]  = $it.Mat }
    if($pos.Csv  -ge 0){ $row[$pos.Csv]  = $it.Csv }
    # クォートして結合
    $quoted = $row | ForEach-Object { if($_ -ne ''){ '"'+$_+'"' } else { '' } }
    $out.Add( ($quoted -join ',') )
  }

  # バックアップ & 保存
  $bak = "$idxPath.autosave_$(Get-Date -Format yyyyMMdd_HHmmss)"
  [IO.File]::WriteAllLines($bak, $lines, $enc)
  [IO.File]::WriteAllLines($idxPath, $out, $enc)

  # ログ
  $log = Join-Path (Split-Path $idxPath -Parent) 'インデックス追記_ログ.txt'
  $logText = "追記日時: $(Get-Date)`r`nヘッダ行: $($hdr -join ',')`r`n追記列位置: Code=$($pos.Code) Name=$($pos.Name) Mat=$($pos.Mat) Csv=$($pos.Csv)`r`n"
  $logText += "追加行:`r`n" + ($items | ForEach-Object { "$($_.Code),$($_.Name),$($_.Mat),$($_.Csv)" } -join "`r`n")
  [IO.File]::WriteAllText($log, $logText, $enc)
}

Add-IndexRows -idxPath $idxDst -items $newItems

Write-Host "=== 完了 ===" -ForegroundColor Cyan
Write-Host "フォルダ: $dstDir"
Write-Host "インデックス: $idxDst（自動追記＆バックアップ作成済み）"
Write-Host "寸法表CSV:" (Get-ChildItem $dstDir -Filter 'チーズ_*' | Select-Object -Expand FullName)
```

---

## ここまでで自動化したこと
- USR1\チーズ の作成
- 寸法表CSV（3ファイル×5行）生成（**縦持ち／10行目ヘッダ／SJIS＋CRLF**）
- インデックス `チーズ.csv` を TOSTE からコピー → **列名を自動解析して3行追記**
- 事故防止のバックアップ＆追記ログ

## もし追加で必要になりそうなデータ（あなたから頂けると精度UP）
- **材質**がSUS304以外なら指定（例：SUS316L など）
- **モデル名**が社内標準と異なる場合は、命名ルール or 実ファイル名リスト
- **呼び径のバリエーション**を増やす場合（5行→増やす）その一覧

（今のスクリプトは、これらを上の `$newItems` と `$rows1..3` を書き換えるだけで再生成できます）

実行してみて、iCADの「部品配置→規格参照」に **USR1/チーズ** が出ればOK。  
出ない or 表示はされるが選択でエラー、などがあれば、その場でログを見てすぐ手当てします。

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # ===== USR1\チーズ ローネック→LowNeck 一括自動修正（このチャットの絶対ルール準拠）=====
PS C:\Users\h.futada> $ErrorActionPreference = 'Stop'
PS C:\Users\h.futada> $enc   = [System.Text.Encoding]::GetEncoding(932)   # Shift-JIS
PS C:\Users\h.futada> $dir   = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
PS C:\Users\h.futada> $idx   = Join-Path $dir 'チーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 1) ユーティリティ
PS C:\Users\h.futada> function Backup-File([string]$path){
>>   if(Test-Path $path){
>>     $bak = "$path.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
>>     Copy-Item $path $bak -Force
>>     return $bak
>>   }
>>   return $null
>> }
PS C:\Users\h.futada> function Replace-TextFile([string]$path, [hashtable]$map){
>>   if(-not (Test-Path $path)){ return $false }
>>   $bak = Backup-File $path
>>   $lines = [IO.File]::ReadAllLines($path, $enc)
>>   for($i=0;$i -lt $lines.Count;$i++){
>>     foreach($k in $map.Keys){
>>       $re = [regex]::Escape($k)
>>       $lines[$i] = [regex]::Replace($lines[$i], $re, $map[$k])
>>     }
>>   }
>>   [IO.File]::WriteAllLines($path, $lines, $enc)
>>   # CRLF固定
>>   $content = [IO.File]::ReadAllText($path, $enc) -replace "`n","" -replace "`r",""
>>   $content = ($lines -join "`r`n") + "`r`n"
>>   [IO.File]::WriteAllText($path, $content, $enc)
>>   return $true
>> }
PS C:\Users\h.futada> function Rename-IfExists([string]$old,[string]$new){
>>   $oldP = Join-Path $dir $old
>>   $newP = Join-Path $dir $new
>>   if(Test-Path $oldP){
>>     if(Test-Path $newP){ Remove-Item $newP -Force }
>>     Rename-Item $oldP $new -Force
>>     return $true
>>   }
>>   return $false
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 2) ファイル名のリネーム（ローネック→LowNeck）
PS C:\Users\h.futada> $renamed = @()
PS C:\Users\h.futada> $renamed += @{ Old='チーズ_一方ショート×ローネックチーズ.csv'; New='チーズ_一方ショート×LowNeckチーズ.csv';  Done=(Rename-IfExists 'チーズ_一方ショート×ローネックチーズ.csv' 'チーズ_一方ショート×LowNeckチーズ.csv') }
PS C:\Users\h.futada> $renamed += @{ Old='チーズ_両方ショート×ローネックチーズ.csv'; New='チーズ_両方ショート×LowNeckチーズ.csv';    Done=(Rename-IfExists 'チーズ_両方ショート×ローネックチーズ.csv' 'チーズ_両方ショート×LowNeckチーズ.csv') }

PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3) 寸法表CSV 内文言置換（ローネック→LowNeck）
PS C:\Users\h.futada> $specFiles = @(
>>   'チーズ_一方ショートチーズ.csv',
>>   'チーズ_一方ショート×LowNeckチーズ.csv',
>>   'チーズ_両方ショート×LowNeckチーズ.csv'
>> )
PS C:\Users\h.futada> $mapSpec = @{ 'ローネック'='LowNeck' }  # 必要十分：モデル名・タイトルの置換
PS C:\Users\h.futada> $specResults = @()
PS C:\Users\h.futada> foreach($f in $specFiles){
>>   $p = Join-Path $dir $f
>>   if(Test-Path $p){
>>     $ok = Replace-TextFile $p $mapSpec
>>     $specResults += @{ File=$f; Replaced=$ok }
>>   } else {
>>     $specResults += @{ File=$f; Replaced=$false }
>>   }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 4) インデックス（チーズ.csv）置換：表記＆規格番号＆CSV名
PS C:\Users\h.futada> $idxMap = @{
>>   'ローネック'='LowNeck'
>>   'SS_RN'     ='SS_LN'
>>   'DS_RN'     ='DS_LN'
>>   'チーズ_一方ショート×ローネックチーズ.csv'='チーズ_一方ショート×LowNeckチーズ.csv'
>>   'チーズ_両方ショート×ローネックチーズ.csv'='チーズ_両方ショート×LowNeckチーズ.csv'
>> }
PS C:\Users\h.futada> $idxReplaced = $false
PS C:\Users\h.futada> if(Test-Path $idx){
>>   $idxReplaced = Replace-TextFile $idx $idxMap
>> } else {
>>   Write-Warning "インデックスが見つかりません: $idx"
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 5) ログ出力
PS C:\Users\h.futada> $log = Join-Path $dir 'インデックス追記_ログ.txt'
PS C:\Users\h.futada> $sb = New-Object System.Text.StringBuilder
PS C:\Users\h.futada> $null = $sb.AppendLine("=== LowNeck 一括置換ログ ===")
PS C:\Users\h.futada> $null = $sb.AppendLine("日時: $(Get-Date)")
PS C:\Users\h.futada> $null = $sb.AppendLine("対象フォルダ: $dir")
PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[ファイル名のリネーム]")
PS C:\Users\h.futada> foreach($r in $renamed){
>>   $null = $sb.AppendLine(" - {0} -> {1} : {2}" -f $r.Old,$r.New,($(if($r.Done){'OK'}else{'無し'})))
>> }
文字列 インデックス (0 ベース) は 0 以上で、引数リストのサイズよりも小さくなければなりません。 の書式設定のエラーです。
発生場所 行:2 文字:3
+   $null = $sb.AppendLine(" - {0} -> {1} : {2}" -f $r.Old,$r.New,($(if ...
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: ( - {0} -> {1} : {2}:String) []、ParentContainsErrorRecordException
    + FullyQualifiedErrorId : FormatError

PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[寸法表CSV 置換結果（ローネック→LowNeck）]")
PS C:\Users\h.futada> foreach($r in $specResults){
>>   $null = $sb.AppendLine(" - {0} : {1}" -f $r.File,($(if($r.Replaced){'OK'}else{'未処理／未発見'})))
>> }
文字列 インデックス (0 ベース) は 0 以上で、引数リストのサイズよりも小さくなければなりません。 の書式設定のエラーです。
発生場所 行:2 文字:3
+   $null = $sb.AppendLine(" - {0} : {1}" -f $r.File,($(if($r.Replaced) ...
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: ( - {0} : {1}:String) []、ParentContainsErrorRecordException
    + FullyQualifiedErrorId : FormatError

PS C:\Users\h.futada> $null = $sb.AppendLine("")
PS C:\Users\h.futada> $null = $sb.AppendLine("[インデックス置換]")
PS C:\Users\h.futada> $null = $sb.AppendLine(" - チーズ.csv : " + ($(if($idxReplaced){'OK'}else{'未処理／未発見'})))
PS C:\Users\h.futada> [IO.File]::WriteAllText($log, $sb.ToString(), $enc)
PS C:\Users\h.futada>
PS C:\Users\h.futada> Write-Host "=== 完了 ===" -ForegroundColor Cyan
=== 完了 ===
PS C:\Users\h.futada> Write-Host "フォルダ: $dir"
フォルダ: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ
PS C:\Users\h.futada> Write-Host "ログ: $log"
ログ: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\インデックス追記_ログ.txt
PS C:\Users\h.futada>

### user  

超ざっくり要約をテキストでコピペできるようにして

### assistant  

いい選択です 👍  
マニュアルでも「**JIS-SYS / JPI-SYS 直下は禁止 → 自社専用は USR1 や任意フォルダを作って使え**」と書かれてます。fileciteturn5file4L6-L12  

---

## USR1 を社内標準フォルダにする手順

1. **対象フォルダ**
   ```
   C:\ICADSX\PDS\sys\PARTS_SPEC\USR1
   ```
   → ここが自社用の規格フォルダ（親フォルダ）になる。

2. **部品種類ごとのサブフォルダを作る**
   例：  
   ```
   USR1\チーズ\
   USR1\エルボ\
   USR1\バルブ\
   ```
   → iCAD 標準の「TOSTE\チーズ」などと同じ階層構造を再現。

3. **部品寸法表 CSV を配置**
   - `チーズ_一方ショートチーズ.csv`  
   - `チーズ_一方ショート×ローネックチーズ.csv`  
   - `チーズ_両方ショート×ローネックチーズ.csv`  
   などを **USR1\チーズ\** に入れる。

4. **インデックス CSV を用意**
   - `USR1\チーズ\チーズ.csv` を新規作成（TOSTE のものを流用可）
   - ここに「規格番号／部品名称／材質／参照する寸法表 CSV」を追記。

5. **登録確認**
   - iCAD 再起動  
   - 部品配置 → 規格参照  
   - 「USR1」配下の部品が選択肢に出れば成功。

---

## ポイント
- **フォルダ名 = 規格名** なので、USR1 は「自社規格：USR1」という扱いになる。  
- インデックス `チーズ.csv` で使う規格番号は **14文字以内** に抑える。fileciteturn5file2L55-L61  
- SYS 系フォルダは編集禁止。USR1 内だけ運用すれば安全。  

---

👉 ここから進める場合、`USR1\チーズ\チーズ.csv` の雛形をこちらで生成して渡す？

### user  

RNじゃなくてLN

### assistant  

まさにそれが「最良」だと思う ✅  

理由はシンプルで：  

- **TOSTE のチーズ.csv は iCAD が確実に読める形式**  
  → 余計な列や改行のズレがなく、マニュアル準拠済み  
- その構造をそのままコピーして **USR1 に配置**すれば、  
  CSV の体裁チェックに悩まずに済む  
- 変えるのは「規格番号」「部品名称」「参照する寸法表CSV名」だけでOK  
- 既存の `チーズ_T-8.csv` / `チーズ_D-8_S.csv` などを**雛形**にすれば、  
  3つの新しいCSV（5行入り×3）をすぐ作ってインデックスに登録できる  

---

## 具体的な流れ（おすすめ）

1. **コピー雛形を作る**  
   - `C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv` をコピー  
   - → `C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv` に置く  

2. **中の行を編集する**  
   - 既存の TOSTE 用行は消す  
   - 新規3行を追記：  
     - 規格番号：`SS` / `SS_RN` / `DS_RN`（14文字以内ならOK）  
     - 部品名称：一方ショートチーズ, 一方ショート×ローネックチーズ, 両方ショート×ローネックチーズ  
     - 材質：SUS304 など  
     - 寸法表ファイル名：  
       - `チーズ_一方ショートチーズ.csv`  
       - `チーズ_一方ショート×ローネックチーズ.csv`  
       - `チーズ_両方ショート×ローネックチーズ.csv`

3. **寸法表CSVをコピーして編集**  
   - `TOSTE\チーズ\チーズ_T-8.csv` などをコピー → 名前を付け替える  
   - 中の呼び径行を **5行だけ残す**＆モデル名を変更  
   - `USR1\チーズ\チーズ_一方ショートチーズ.csv` などに保存  

4. **iCAD 再起動 → 部品配置テスト**

---

👉 ここで確認したい：  
僕が **「インデックスCSVに追記する3行」＋「寸法表CSVの雛形」** を一気にPowerShellで自動生成する形にする？  
それとも、まず **TOSTEのチーズ.csvの中身をアップ**してもらって、実際の列の並びを見てから編集指示を出した方が安心？

### user  

マニュアルから標準部品の登録方法を超簡単に要約して

### user  

このチャットルーム内だけの絶対ルールでお願い。他のチャットルームには影響しないようにして。

### user  

通常は「ローネック」で略称のときは[

### user  

コピーして

### assistant  

良い確認！  
インデックスの **チーズ.csv** は、必ず **その部品種類フォルダ直下**に置かれています。  

つまり：  

- 標準のTOSTEなら  
  ```
  C:\ICADSX\PDS\sys\PARTS_SPEC\TOSTE\チーズ\チーズ.csv
  ```
- 今回あなたが使う社内規格 **USR1** なら  
  ```
  C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv
  ```

この **インデックスCSV** が「このフォルダにどんな寸法表CSVがあるか」をまとめて、iCADに教える役目をします。  
（なので、ここに **規格番号／部品名称／材質／寸法表CSV名** の行を追記すると、iCADの規格参照で呼べるようになる）  

---

👉 今の段階だと USR1\チーズ\チーズ.csv は存在しないと思うので、まず **TOSTE のチーズ.csv をコピーして USR1\チーズ\ に置く**のが安全な手順です。  

コピーしましょうか？それとも中身を一度確認したい？

### user  

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

新機能と改善のために最新の PowerShell をインストールしてください!https://aka.ms/PSWindows

PS C:\Users\h.futada> # === USR1\チーズ：部品名称→ローネック / 規格番号→LN に統一 ===
PS C:\Users\h.futada> $enc = [Text.Encoding]::GetEncoding(932)
PS C:\Users\h.futada> $dir = 'C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ'
PS C:\Users\h.futada> $idx = Join-Path $dir 'チーズ.csv'
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 1) 寸法表ファイル名を LowNeck → ローネック に戻す
PS C:\Users\h.futada> $renames = @(
>>   @{ Old='チーズ_一方ショート×LowNeckチーズ.csv'; New='チーズ_一方ショート×ローネックチーズ.csv' },
>>   @{ Old='チーズ_両方ショート×LowNeckチーズ.csv'; New='チーズ_両方ショート×ローネックチーズ.csv' }
>> )
PS C:\Users\h.futada> foreach($r in $renames){
>>   $oldP = Join-Path $dir $r.Old
>>   $newP = Join-Path $dir $r.New
>>   if(Test-Path $oldP){
>>     if(Test-Path $newP){ Remove-Item $newP -Force }
>>     Rename-Item $oldP $r.New -Force
>>     Write-Host "リネーム: $($r.Old) → $($r.New)"
>>   }
>> }
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 2) 寸法表CSV内の表記置換（LowNeck → ローネック）
PS C:\Users\h.futada> $specFiles = Get-ChildItem $dir -Filter 'チーズ_*.csv' | Where-Object { $_.Name -match 'ローネック|LowNeck' }
PS C:\Users\h.futada> foreach($f in $specFiles){
>>   $bak = "$($f.FullName).bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
>>   Copy-Item $f.FullName $bak
>>   $lines = [IO.File]::ReadAllLines($f.FullName,$enc) -replace 'LowNeck','ローネック'
>>   [IO.File]::WriteAllLines($f.FullName,$lines,$enc)
>>   Write-Host "寸法表修正: $($f.Name)"
>> }
寸法表修正: チーズ_一方ショート×ローネックチーズ.csv
寸法表修正: チーズ_両方ショート×ローネックチーズ.csv
PS C:\Users\h.futada>
PS C:\Users\h.futada> # 3) インデックスCSV修正
PS C:\Users\h.futada> if(Test-Path $idx){
>>   $bak = "$idx.bak_$(Get-Date -Format yyyyMMdd_HHmmss)"
>>   Copy-Item $idx $bak
>>   $lines = [IO.File]::ReadAllLines($idx,$enc)
>>
>>   for($i=0;$i -lt $lines.Count;$i++){
>>     # 部品名称はローネック
>>     $lines[$i] = $lines[$i] -replace 'LowNeck','ローネック'
>>     # 規格番号は LN に統一
>>     $lines[$i] = $lines[$i] -replace 'SS_RN','SS_LN'
>>     $lines[$i] = $lines[$i] -replace 'DS_RN','DS_LN'
>>   }
>>
>>   [IO.File]::WriteAllLines($idx,$lines,$enc)
>>   Write-Host "インデックス修正完了: $idx"
>> }
インデックス修正完了: C:\ICADSX\PDS\sys\PARTS_SPEC\USR1\チーズ\チーズ.csv
PS C:\Users\h.futada>

### assistant  

超ざっくり要約（これだけやれば登録できます）

1) 置き場所を作る  
`…\PDS\SYS\PARTS_SPEC\(自社規格名)\(部品種類)` に自社用フォルダを作成。**JIS-SYS/JPI-SYS直下に入れない**（アップデートで上書きされるため）。fileciteturn5file4L6-L12 fileciteturn5file4L21-L24

2) 「部品寸法表ファイル」を作る（縦持ちCSV）  
1行目=「部品種類, 部品名称, 規格名 規格番号」→ **1–5行はシステム予約** → **6–9行は自由欄** → 見出し行 → 以降にデータ。見出しは実質 **「呼び径A／呼び径B／利用者部品のモデル名」**（列順は入れ替えない）。モデル名は呼び出す**図面ファイル名**（形状登録）または**パラメ部品フォルダ名**（パラメ登録）のどちらか。fileciteturn5file2L33-L36 fileciteturn5file0L15-L23 fileciteturn5file0L34-L36

3) 呼び径の書き方ルール  
複数ある時は **「x」で連結し、大きい方を先**に書く（例：300Ax250A）。重複・空白は不可。fileciteturn5file2L56-L64

4) 「部品寸法表インデックス」を更新  
同じ規格フォルダ内の **インデックスCSV** に、今作った寸法表CSVの行を**追記**（部品名/規格番号などで参照させる）。fileciteturn5file4L45-L52

5) 置く場所の注意と上限  
`PARTS_SPEC`配下で運用し、**SYS_ から始まるテーブルは編集しない**。同一規格・同一部品種類に登録できる数は**最大640個**。fileciteturn5file1L25-L31 fileciteturn5file1L33-L37

6) 使い方（呼び出し）  
iCADを再起動 → 部品配置時に**「規格参照」**を開き、規格・部品名・呼び径を選んで配置。fileciteturn5file8L82-L98

—以上。  
必要なら、あなたの規格名で**インデックス追記まで自動化するスクリプト**も作るよ。

### user  

2) 部品寸法表CSVを作るもそこまで細かくなくていい。誰が読んでも超ざっくりでひとまずお願い。
